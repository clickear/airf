window.__require=function e(t,i,o){function n(c,s){if(!i[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+c+"'")}}var d=i[c]={exports:{}};t[c][0].call(d.exports,function(e){return n(t[c][1][e]||e)},d,d.exports,e,t,i,o)}return i[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<o.length;c++)n(o[c]);return n}({HttpUtils:[function(e,t,i){"use strict";cc._RF.push(t,"2048ajrOwJOjaxUeCo/FNmu","HttpUtils");var o={get:function(e,t,i){var o=this,n=cc.loader.getXMLHttpRequest();if(n.onreadystatechange=function(){if(4===n.readyState){if(n.status>=200&&n.status<300){var e=n.responseText;i(JSON.parse(e))}else i(-1);o.nextRequest()}},n.open("GET",e,!0),cc.sys.isNative&&n.setRequestHeader("Accept-Encoding","gzip,deflate"),n.setRequestHeader("Accept","application/json"),t)for(var a in t)n.setRequestHeader(a,t[a]);n.timeout=5e3,n.send()},post:function(e,t,i,o){var n=this,a=cc.loader.getXMLHttpRequest();if(a.onreadystatechange=function(){if(4===a.readyState){if(a.status>=200&&a.status<300){var e=a.responseText;o(JSON.parse(e))}else cc.log("xhr.readyState="+a.readyState+"  xhr.status="+a.status),o(-1);n.nextRequest()}},a.open("POST",e,!0),cc.sys.isNative&&a.setRequestHeader("Accept-Encoding","gzip,deflate"),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Accept","application/json"),t)for(var c in t)a.setRequestHeader(c,t[c]);a.timeout=5e3,a.send(JSON.stringify(i))},nextRequest:function(){e("StorageUtils").checkFriendHelp()}};t.exports=o,cc._RF.pop()},{StorageUtils:"StorageUtils"}],PlatformUtils:[function(e,t,i){"use strict";cc._RF.push(t,"f009e9Py4xKt67V/Znxi3VJ","PlatformUtils");var o=e("common"),n=e("HttpUtils"),a={init:function(e){console.log("cc.game.getFrameRate() = ",cc.game.getFrameRate()),cc.game.setFrameRate(60)},onHide:function(e){},login:function(e){if(this.getUserSkey()){var t=this.getItemByLocalStorage("openid"),i=this.getItemByLocalStorage("uid");D.commonState.userInfo={openid:t,uid:i},e(!0)}else{var n=o.guid();this.requestLogin(n,e)}},requestLogin:function(e,t){var i=this;n.post(D.UrlDomain+"/test/login",{Version:D.Versioin},{code:e,name:"",img:""},function(e){console.log("test\u767b\u5f55\u8fd4\u56de\uff1a",JSON.stringify(e)),-1!==e&&0==e.code&&(i.setItemByLocalStorage("skey",e.data.skey),i.setItemByLocalStorage("openid",e.data.openid),i.setItemByLocalStorage("uid",e.data.uid),D.commonState.skey=e.data.skey,D.commonState.userInfo=e.data,t(!0))})},getUserSkey:function(){return D.commonState.skey?D.commonState.skey:this.getItemByLocalStorage("skey")},getUserId:function(){return D.commonState&&D.commonState.userInfo?D.commonState.userInfo.uid:0},getUserInfo:function(e){if(D.commonState.platform_userinfo)e(D.commonState.platform_userinfo);else;},getItemByLocalStorage:function(e,t){try{var i=cc.sys.localStorage.getItem(e);return void 0===i||null===i||""===i?(void 0!=t&&null!==t&&""!==t&&cc.sys.localStorage.setItem(e,t),t):"boolean"==typeof t?"boolean"==typeof i?i:"true"==i:"number"==typeof t?Number(i):i}catch(e){return t}},setItemByLocalStorage:function(e,t){cc.sys.localStorage.setItem(e,t)},shareAppMessage:function(e,t,i,o,n){this.shareAppMessageCallback(e,t,i,o,n)},shareAppMessageCallback:function(e,t,i,o,n){o&&o(-1)},createRewardedVideoAd:function(e,t,i){t(-1)},hideWxLayer:function(){this.hideBannerAd()},showWxLayer:function(){this.createBannerAd()},hideBannerAd:function(){},createBannerAd:function(e){if(!(o.popLayerNum>0)||e);},gameClub:function(){},closeGameClub:function(){},requestGameInfo:function(e){D.commonState.userGameInfo?e(D.commonState.userGameInfo):n.get(D.UrlDomain+"/user/game-info",{Authorization:this.getUserSkey(),Version:D.Versioin},function(t){-1!==t&&0==t.code&&(D.commonState.userGameInfo=t.data,e(t.data),console.log("***************",t.data))})},getHigthScore:function(e){var t=this.getItemByLocalStorage("highestScore",0);!t||t<=0?this.requestGameInfo(function(t){console.log("getHigthScore userGameInfo",JSON.stringify(t)),t.higthScore||(t.higthScore=0),e(t.higthScore)}):(console.log("getHigthScore highestScore",t),e(t))},setAndGetHigthScore:function(e,t){var i=this,o=this.getItemByLocalStorage("highestScore",0);!o||o<=0?this.requestGameInfo(function(o){o.higthScore||(o.higthScore=0),e>o.higthScore?(i.requestUpdateHigthScore(e),t(e)):t(o.higthScore)}):e>o?(i.requestUpdateHigthScore(e),t(e)):t(o)},requestUpdateHigthScore:function(e){this.setItemByLocalStorage("highestScore",e),n.post(D.UrlDomain+"/user/update-best-score",{Authorization:this.getUserSkey(),Version:D.Versioin},{higthScore:e},function(e){})},requestAddCoin:function(e,t,i){n.post(D.UrlDomain+"/user/add-coin",{Authorization:this.getUserSkey(),Version:D.Versioin},{coin:e,reason:t},function(e){-1!==e&&0==e.code&&(D.commonState.userGameInfo.coin=e.data.currCoin,i&&i(e.data))})},requestHeroList:function(e){if(D.commonState.heroList)e(D.commonState.heroList);else{var t=this.getItemByLocalStorage("fightHeroKind",1);console.log("fightHeroKind",t),n.get(D.UrlDomain+"/hero/list",{Authorization:this.getUserSkey(),Version:D.Versioin},function(i){if(-1!==i&&0==i.code){D.commonState.heroList=i.data;for(var o=!1,n=0;n<D.commonState.heroList.length;n++){if(D.commonState.heroList[n].kind==t){o=!0;break}}o||(t=1);for(var a=0;a<D.commonState.heroList.length;a++){var c=D.commonState.heroList[a];if(console.log("hero list init---"+c.kind+"_"+c.subSeq),c.kind==t){D.currHero=c,c.status=2;break}}e(i.data)}})}},requestHeroUpgrade:function(e,t,i){var o=this;n.post(D.UrlDomain+"/hero/upgrade",{Authorization:this.getUserSkey(),Version:D.Versioin},{kind:e,type:t},function(e){if(-1!==e&&0==e.code){var t=e.data.hero;if(D.commonState.heroList)for(var n=0;n<D.commonState.heroList.length;n++){D.commonState.heroList[n].kind==t.kind&&(D.commonState.heroList[n]=t)}D.currHero&&D.currHero.kind>0&&D.currHero.kind==t.kind&&(D.currHero=t),o.requestGameInfo(function(t){t&&(t.coin=e.data.myCoin)}),i(e.data)}else 2010==e.code&&i(e.code)})},requestUpdateFightStatus:function(e,t){D.commonState.heroList&&D.commonState.heroList.forEach(function(t){t.kind==e?(t.status=2,console.log("requestUpdateFightStatus",e),D.currHero=t):2==t.status&&(t.status=1)}),this.setItemByLocalStorage("fightHeroKind",e)},requestUpdateHeroStatus:function(e,t,i,o){D.commonState.heroList&&D.commonState.heroList.forEach(function(t){t.kind==e&&(t.status=i)}),n.post(D.UrlDomain+"/hero/update-status",{Authorization:this.getUserSkey(),Version:D.Versioin},{kind:e,fromStatus:t,toStatus:i},function(e){-1!==e&&0==e.code&&o(e.data)})},requestNewHeroUseCoin:function(e,t){n.get(D.UrlDomain+"/hero/get-use-coin?kind="+e,{Authorization:this.getUserSkey(),Version:D.Versioin},function(e){if(-1!==e&&0==e.code){var i=e.data.hero;if(D.commonState.heroList){for(var o=!1,n=0;n<D.commonState.heroList.length;n++){if(D.commonState.heroList[n].kind==i.kind){D.commonState.heroList[n]=i,o=!1;break}o=!0}o&&D.commonState.heroList.push(i)}t(e.data)}})},requestonFromRewardShare:function(e){var t=this;this.getUserInfo(function(i){var o=i.nickName,a=i.avatarUrl;n.post(D.UrlDomain+"/share/award/be-opened",{Authorization:t.getUserSkey(),Version:D.Versioin},{fromUserId:e,name:o,headimg:a},function(e){-1!==e&&e.code})})},requestShareAwardList:function(e){n.get(D.UrlDomain+"/share/award/list-friends",{Authorization:this.getUserSkey(),Version:D.Versioin},function(t){-1!==t&&0==t.code&&e(t.data)})},requestShareAward:function(e,t){n.get(D.UrlDomain+"/share/award/"+e,{Authorization:this.getUserSkey(),Version:D.Versioin},function(e){-1!==e&&0==e.code?t(e.data):2020!=e.code&&2021!=e.code||t(e.code)})},requestHelp:function(e,t){n.post(D.UrlDomain+"/share/help",{Authorization:this.getUserSkey(),Version:D.Versioin},{fromKey:e},function(e){console.log("/share/help",e)})},requestHelpList:function(e){n.post(D.UrlDomain+"/share/help/list",{Authorization:this.getUserSkey(),Version:D.Versioin},{},function(t){-1!==t&&0==t.code&&e&&e(t.data)})},requestHelpReceive:function(e,t){n.get(D.UrlDomain+"/share/help/recv/"+e,{Authorization:this.getUserSkey(),Version:D.Versioin},function(e){-1!==e&&0==e.code?t(e.data):2020!=e.code&&2021!=e.code||t(e.code)})},requestCfg:function(e){!1===D.SvrCfgsReturn?n.get(D.UrlDomain+"/cfgs?ver="+D.Versioin,{Authorization:this.getUserSkey(),Version:D.Versioin},function(t){-1!==t&&0==t.code&&(D.SvrCfgs=t.data,console.log(D.SvrCfgs),D.SvrCfgs.ShareCfgs={},t.data.shares.forEach(function(e){D.SvrCfgs.ShareCfgs[e.func]=e.mode}),t.data.urls&&(D.wxMoreGameUrls=t.data.urls),D.SvrCfgsReturn=!0,e())}):e()},requestShareCfg:function(e,t){if(!1===D.SvrCfgsReturn){var i=this;this.requestCfg(function(){i.doCallbackShareCfg(e,t)})}else this.doCallbackShareCfg(e,t)},doCallbackShareCfg:function(e,t){var i=String(e).split(",");if(1==i.length)t(D.SvrCfgs.ShareCfgs[e]);else{var o={};i.forEach(function(e){o[e]=D.SvrCfgs.ShareCfgs[e]}),t(o)}},requestAddQzbFriend:function(e){n.post(D.UrlDomain+"/user/add-qzb-friend",{Authorization:this.getUserSkey(),Version:D.Versioin},{fromUserId:e},function(e){console.log("/user/add-qzb-friend",e)})},requestRecover:function(e,t){var i=this;n.post(D.UrlDomain+"/user/add-qzb",{Authorization:this.getUserSkey(),Version:D.Versioin},{qzb:e},function(e){-1!==e&&0==e.code?(i.requestGameInfo(function(t){t.qzb=e.data.currQzb,t.qzb<0&&(t.qzb=0)}),t(!0)):2011==e.code&&t(!1)})},requestFollowAward:function(e,t){n.post(D.UrlDomain+"/hero/award",{Authorization:this.getUserSkey(),Version:D.Versioin},{},function(i){if(-1!==i&&0==i.code){var o=i.data.hero;if(D.commonState.heroList){for(var n=!1,a=0;a<D.commonState.heroList.length;a++){D.commonState.heroList[a].kind==o.kind&&(D.commonState.heroList[a]=o,n=!0)}n&&(D.commonState.heroList.push(o),e&&e.apply(t))}}})},requestSignIn:function(e,t){n.post(D.UrlDomain+"/sign/sign-in/v2",{Authorization:this.getUserSkey(),Version:D.Versioin},{signNum:e},function(e){-1!==e&&0==e.code&&t(e.data)})},requestSignList:function(e){n.post(D.UrlDomain+"/sign/list",{Authorization:this.getUserSkey(),Version:D.Versioin},{},function(t){-1!==t&&0==t.code&&e(t.data)})},requestBill:function(e,t,i,o,a,c,s,r){n.post(D.UrlDomain+"bill/v2",{Authorization:this.getUserSkey(),Version:D.Versioin},{card:e,slot:t,act:i,ext1:o||0,ext2:a||0,ext3:c||0,ext4:s||0,ext5:r||0},function(e){})},isTodayWxVideoBeyond:function(){var e=a.getItemByLocalStorage("TodayWxVideo"),t=!1;if(e){var i=new Date(e);if(o.isSameDay(i))return a.getItemByLocalStorage("TodayWxVideoCnt",0)<D.wxVideoMaxNum;a.setItemByLocalStorage("TodayWxVideoCnt",0),t=!0}else t=!0;return t},setTodayWxVideo:function(){a.setItemByLocalStorage("TodayWxVideoCnt",a.getItemByLocalStorage("TodayWxVideoCnt",0)+1),a.setItemByLocalStorage("TodayWxVideo",new Date)},isTodayWxAwardShareBeyond:function(){var e=a.getItemByLocalStorage("TodayWxAwardShare"),t=!1;if(e){var i=new Date(e);if(o.isSameDay(i))return a.getItemByLocalStorage("TodayWxAwardShareCnt",0)<D.wxAwardShareMaxNum;a.setItemByLocalStorage("TodayWxAwardShareCnt",0),t=!0}else t=!0;return t},setTodayWxAwardShare:function(){a.setItemByLocalStorage("TodayWxAwardShareCnt",a.getItemByLocalStorage("TodayWxAwardShareCnt",0)+1),a.setItemByLocalStorage("TodayWxAwardShare",new Date)},requestItemList:function(e,t){!D.commonState.itemList||t?n.post(D.UrlDomain+"/item/list",{Authorization:this.getUserSkey(),Version:D.Versioin},{},function(t){-1!==t&&0==t.code&&(e(t.data),D.commonState.itemList=t.data)}):e(D.commonState.itemList)},lotteryVideoCount:function(){var e=a.getItemByLocalStorage("TodayLotteryVideoTime");if(e){var t=new Date(e);o.isSameDay(t)||a.setItemByLocalStorage("TodayLotteryVideoCnt",0)}var i=D.wxVideoMaxNum-a.getItemByLocalStorage("TodayWxVideoCnt",0),n=D.lotteryVideoDrawCount-a.getItemByLocalStorage("TodayLotteryVideoCnt",0);return i>n?n:i},requestInviteNewList:function(e){D.commonState.newgiftsList?e&&e(D.commonState.newgiftsList):n.get(D.UrlDomain+"/share/invite-new/list",{Authorization:this.getUserSkey(),Version:D.Versioin},function(t){-1!==t&&0==t.code&&(e&&e(t.data),D.commonState.newgiftsList=t.data)})},requestNewgiftsReceive:function(e){n.post(D.UrlDomain+"/share/invite-new/recv",{Authorization:this.getUserSkey(),Version:D.Versioin},{},function(t){-1!==t&&0==t.code&&e&&e(t.data)})},requestonFromHelpShare:function(e,t){console.log("\u52a9\u529b\u4e86\u597d\u53cb,111111111,fromUserId="+e),n.get(D.UrlDomain+"/user/base-info?fuserId="+e,{Authorization:this.getUserSkey(),Version:D.Versioin},function(e){console.log("\u52a9\u529b\u4e86\u597d\u53cb,res=",e),-1!==e&&0==e.code&&t&&t(e.data)})},requestBattleList:function(e,t){n.get(D.UrlDomain+"/match/list/"+e,{Authorization:this.getUserSkey(),Version:D.Versioin},function(e){-1!==e&&0==e.code&&t&&t(e.data)})},requestBattleAdd:function(e,t,i,o){n.post(D.UrlDomain+"/match/add",{Authorization:this.getUserSkey(),Version:D.Versioin},{heroKind:e,heroSeq:t,score:i},function(e){o&&o(e.data)})},requestBattleAddScore:function(e,t){n.post(D.UrlDomain+"/match/add-user",{Authorization:this.getUserSkey(),Version:D.Versioin},e,function(e){t&&t(e.data)})},requestBattleRecv:function(e){n.get(D.UrlDomain+"/match/recv",{Authorization:this.getUserSkey(),Version:D.Versioin},function(t){-1!==t&&0==t.code&&e&&e(t.data)})},requestRedpacketReady:function(e,t){n.get(D.UrlDomain+"/user/ready-money/"+e,{Authorization:this.getUserSkey(),Version:D.Versioin},function(e){-1!==e&&0==e.code&&t&&t(e.data)})},requestRedpacketAdd:function(e,t,i){n.post(D.UrlDomain+"/user/add-money",{Authorization:this.getUserSkey(),Version:D.Versioin},{reason:e,money:t},function(e){-1!==e&&0==e.code&&i&&i(e.data)})},requestNotice:function(e){D.commonState.notice?e(D.commonState.notice):n.get(D.UrlDomain+"/notice/list",{Authorization:this.getUserSkey(),Version:D.Versioin},function(t){-1!==t&&0==t.code&&(D.commonState.notice=t.data,e&&e(t.data))})}};t.exports=a,cc._RF.pop()},{HttpUtils:"HttpUtils",common:"common"}],Shake:[function(e,t,i){"use strict";cc._RF.push(t,"4872cJnKiBNuZ0sZFMnclBw","Shake"),cc.Shake=cc.ActionInterval.extend({_initial_x:0,_initial_y:0,_strength_x:0,_strength_y:0,ctor:function(){cc.ActionInterval.prototype.constructor.call(this)},initWithDuration:function(e,t,i){return cc.ActionInterval.prototype.initWithDuration.call(this,e),this._strength_x=t,this._strength_y=i,!0},update:function(e){var t=2*(Math.random()-.5)*this._strength_x,i=2*(Math.random()-.5)*this._strength_y;this.getTarget().setPosition(t+this._initial_x,i+this._initial_y)},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._initial_x=e.x,this._initial_y=e.y},stop:function(){this.getTarget().setPosition(new cc.Vec2(this._initial_x,this._initial_y)),cc.ActionInterval.prototype.stop.call(this)}}),cc.shake=function(e,t,i){var o=new cc.Shake;return o.initWithDuration(e,t,i),o},cc._RF.pop()},{}],StorageUtils:[function(e,t,i){"use strict";cc._RF.push(t,"84710D/ltxF4Ji66RAsLrDT","StorageUtils");var o=e("common"),n=e("PlatformUtils"),a={lotteryFreeDelay:14400,lotteryVideoDelay:30,upgradeVideo:3,upgradeShare:2,redpacketVideo:6,redpacketShare:10,lotteryFreeTime:function(){if(0==D.lotteryFreeDrawCount-this.lotteryFreeCount())return new Date((new Date).setHours(0,0,0,0))/1e3+86400-Math.floor(Date.now()/1e3);var e=n.getItemByLocalStorage("TodayLetteryFreeDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("TodayLetteryFreeCountDown",0)}var i=n.getItemByLocalStorage("TodayLetteryFreeCountDown",0);return i>0&&(i=(i=Math.floor(Date.now()/1e3)-i)>=this.lotteryFreeDelay?0:this.lotteryFreeDelay-i),i},lotteryFreeCount:function(){var e=n.getItemByLocalStorage("TodayLetteryFreeDraw");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("LetteryFreeCount",0)}return n.getItemByLocalStorage("LetteryFreeCount",0)},checkFriendHelp:function(){var e=this.preHelpCheckTime?this.preHelpCheckTime:0;if(!(Date.now()/1e3-e<3)){this.preHelpCheckTime=Date.now()/1e3;var t=D.commonState.friendHelpNum?D.commonState.friendHelpNum:n.getItemByLocalStorage("curFriendHelpNum",-1);console.log("preCheckVal=",t),t<0||n.requestShareAwardList(function(e){var i=0,a="";e.forEach(function(e,t){0==e.isRecv&&void 0!=e.name&&null!=e.name&&(i+=1,a=e.name)}),t>=0&&i>t?(o.sysMessage(a+"\u8fdb\u5165\u4e86\u6e38\u620f"),n.setItemByLocalStorage("curFriendHelpNum",-1)):i<t&&(n.setItemByLocalStorage("curFriendHelpNum",-1),D.commonState.friendHelpNum=0)})}},upgradeVideoCount:function(){var e=n.getItemByLocalStorage("TodayUpgradeVideoDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("UpgradeVideoCount",0)}return this.upgradeVideo-n.getItemByLocalStorage("UpgradeVideoCount",0)},upgradeShareCount:function(){var e=n.getItemByLocalStorage("TodayUpgradeShareDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("UpgradeShareCount",0)}return this.upgradeShare-n.getItemByLocalStorage("UpgradeShareCount",0)},dailySignIsVideoed:function(){var e=n.getItemByLocalStorage("TodaySignVideoDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("SignVideoSigned",!1)}return n.getItemByLocalStorage("SignVideoSigned",!1)},redpacketVideoCount:function(){var e=n.getItemByLocalStorage("TodayRedpacketVideoDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("RedpacketVideoCount",0)}return this.redpacketVideo-n.getItemByLocalStorage("RedpacketVideoCount",0)},redpacketShareCount:function(){var e=n.getItemByLocalStorage("TodayRedpacketShareDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("RedpacketShareCount",0)}return this.redpacketShare-n.getItemByLocalStorage("RedpacketShareCount",0)}};t.exports=a,cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],TimeUtils:[function(e,t,i){"use strict";cc._RF.push(t,"a2372nf8xFL3atcwtC5kN0j","TimeUtils");var o={secondsToHMS:function(e){if(!e)return"";var t=Math.floor(e/3600),i=Math.floor(e%3600/60),o=e%60;return(t=t<10?"0"+t:t)+":"+(i=i<10?"0"+i:i)+":"+(o=o<10?"0"+o:o)}};t.exports=o,cc._RF.pop()},{}],baseView:[function(e,t,i){"use strict";cc._RF.push(t,"e24343EZZ1H/JXupMDOMt3A","baseView"),cc.Class({extends:cc.Component,properties:{far_bg:[cc.Node],mapMovSpeed:.5,mapHeigeht:1280,mapInitX:0,rewardBg1:cc.Node,rewardBg2:cc.Node,needOffsetPixel:!1},onLoad:function(){this.mapMovSpeed=2;var e=this.far_bg[0].getBoundingBox();this.mapHeigeht=cc.winSize.height,this.mapInitHeight=e.height,this.mapInitX=1*-e.width,this.far_bg[2].active=!1,Device.needOffsetPixel()&&(this.needOffsetPixel=!0,this.far_bg[2].active=!0),this.fixBgPos(this.far_bg[0],this.far_bg[1],this.far_bg[2]),Notification.on("level_over_event",this.levelOverHandler,this),Notification.on("level_begin_event",this.levelBeginHandler,this)},levelOverHandler:function(){this.mapMovSpeed=5},levelBeginHandler:function(){this.mapMovSpeed=2},fixBgPos:function(e,t,i){e.setPosition(this.mapInitX,1*-this.mapHeigeht),t.setPosition(e.x,e.y+this.mapInitHeight),i.setPosition(t.x,t.y+this.mapInitHeight)},moveHandler:function(){},update:function(e){D.gameStatuePause||this.bgMove(this.far_bg,this.mapMovSpeed)},bgMove:function(e,t){var i=-1,o=2;this.needOffsetPixel&&(o=3);for(var n=0;n<o;n++){var a=e[n];a.y-=t,a.y<=0*-this.mapHeigeht-this.mapInitHeight&&(i=n)}if(i>=0){var c,s=e[i];c=e[(i+o-1)%o],s.setPosition(c.x,c.y+this.mapInitHeight)}},gameOver:function(){Notification.off("level_over_event",this.levelOverHandler),Notification.off("level_begin_event",this.levelBeginHandler)}}),cc._RF.pop()},{}],battleItem:[function(e,t,i){"use strict";cc._RF.push(t,"b8da6hlDn9ICYopnswCoqvp","battleItem");var o=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{spr_bg:cc.Sprite,spr_plane:cc.Sprite,spr_head:cc.Sprite,lab_name:cc.Label,lab_score:cc.Label,lab_state:cc.Label,lab_star:cc.Label},start:function(){},initWithData:function(e){var t=this,i="plane/plane_"+(e.heroKind?e.heroKind:1)+"_"+(e.heroSeq?e.heroSeq:1);cc.loader.loadRes(i,cc.SpriteFrame,function(e,i){t.spr_plane.spriteFrame=i});var n=e.headimg;n&&""!=n&&cc.loader.load({url:n,type:"png"},function(e,i){t.spr_head.spriteFrame=new cc.SpriteFrame(i)}),this.lab_name.string=e.name?e.name:"",this.lab_score.string=e.score?e.score:"",this.lab_star.string="x"+e.award;var a=1==e.success;this.lab_state.string=a?"\u6311\u6218\u6210\u529f":"\u6311\u6218\u5931\u8d25";var c=1==e.success?cc.color("#81f761"):cc.color("#f24747");this.lab_state.node.color=c,e.userId==o.getUserId()&&cc.loader.loadRes("battle/battle",cc.SpriteAtlas,function(e,i){var o=i.getSpriteFrame("battle_item_clicked");o&&(t.spr_bg.spriteFrame=o)})}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils"}],battleLayer:[function(e,t,i){"use strict";cc._RF.push(t,"bd648rClvVE8b3LGXf2EF6p","battleLayer");var o=e("PlatformUtils"),n=e("common"),a=e("TimeUtils"),c=e("sceneManager");cc.Class({extends:cc.Component,properties:{btnSound:{default:null,type:cc.AudioClip},node_result:cc.Node,spr_result_eff:cc.Sprite,lab_result_score:cc.Label,lab_score_ower:cc.Label,node_challenger:cc.Node,spr_plane_clg:cc.Sprite,spr_head_clg:cc.Sprite,lab_name_clg:cc.Label,lab_score_clg:cc.Label,spr_score_clg:cc.Sprite,node_sender:cc.Node,spr_plane:cc.Sprite,spr_head_snd:cc.Sprite,lab_name:cc.Label,lab_score:cc.Label,lab_star_desc:cc.Label,lab_star:cc.Label,lab_time:cc.Label,lab_no_battler:cc.Label,btn_battle:cc.Button,lab_battle:cc.Label,scrollview:cc.ScrollView,pfb_battle_item:cc.Prefab},onLoad:function(){this.node_result.active=!1,this.lab_no_battler.node.active=!1,this.spr_plane_clg.node.active=!1,this.spr_plane.node.active=!1,this.lab_score_clg.string="",this.lab_score.string="",this.lab_star.string="x0"},requestData:function(e,t){this.battleFromUserId=e,this.isResult=t;var i=this;o.requestBattleList(e,function(e){e&&(i.initData(e),i.initView(e))})},initData:function(e){var t=o.getUserId();if(this.ower=null,this.sender=null,this.isSender=e.userId==t,e.items&&0!=e.items.length)for(var i=e.master==t,a=0;a<e.items.length;a++){var c=e.items[a];c.userId==e.userId&&(this.sender=c),this.isResult&&i?(null==this.ower||this.ower.score<c.score)&&c.userId!=t&&(this.ower=c):(null==this.ower||this.ower.score<c.score)&&(this.ower=c),!this.isSender&&this.isResult&&t==c.userId&&D.commonState.gameScore==c.score&&n.sysMessage("\u606d\u559c\u60a8\u83b7\u5f97"+c.award+"\u91d1\u5e01")}},initView:function(e){console.log("------------ battleLayer initView, data=",e);var t=e.items&&e.items.length>0;if(t?(this.initRecordList(e.items),this.lab_no_battler.node.active=!1):this.lab_no_battler.node.active=!0,this.countTime=e.remainSec?e.remainSec:0,this.countTime>0){var i=cc.delayTime(1),o=cc.callFunc(this.countDown,this);this.lab_time.node.stopAllActions(),this.lab_time.node.runAction(cc.repeatForever(cc.sequence(i,o))),this.lab_time.string="\u6709\u6548\u6311\u6218\u65f6\u95f4\u5269\u4f59\uff1a"+a.secondsToHMS(this.countTime)}if(this.isSender)t&&this.countTime>0?(this.lab_battle.string="\u53d1\u8d77\u6311\u6218",this.battleType=1):0==this.sender.awardGot?(this.lab_battle.string="\u9886\u53d6\u5956\u52b1",this.battleType=3):(this.lab_battle.string="\u5f00\u59cb\u6e38\u620f",this.battleType=2);else{var n=this.isResult?"\u518d\u6b21\u6311\u6218":"\u7acb\u5373\u6311\u6218";this.lab_battle.string=n,this.battleType=2}var c=this;if(this.isResult)this.node_result.active=!0,this.node_challenger.active=!1,this.lab_result_score.string=D.commonState.gameScore,this.lab_score_ower.string=this.ower&&this.ower.score?this.ower.score:"",this.spr_result_eff.node.stopAllActions(),this.spr_result_eff.node.runAction(cc.repeatForever(cc.rotateBy(3,360)));else if(this.node_result.active=!1,this.node_challenger.active=!0,t){var s=this.ower.headimg;s&&""!=s.length&&cc.loader.load({url:s,type:"png"},function(e,t){c.spr_head_clg.spriteFrame=new cc.SpriteFrame(t)}),this.lab_name_clg.string=this.ower.name?this.ower.name:"",this.lab_score_clg.string=this.ower.score?this.ower.score:"";var r="plane/plane_"+(this.ower.heroKind?this.ower.heroKind:1)+"_"+(this.ower.heroSeq?this.ower.heroSeq:1);cc.loader.loadRes(r,cc.SpriteFrame,function(e,t){c.spr_plane_clg.node.active=!0,c.spr_plane_clg.spriteFrame=t})}else this.lab_name_clg.node.active=!1,this.lab_score_clg.node.active=!1,this.spr_head_clg.node.active=!1,this.spr_score_clg.node.active=!1,this.spr_plane_clg.node.active=!1;if(this.sender){var l="plane/plane_"+(this.sender.heroKind?this.sender.heroKind:1)+"_"+(this.sender.heroSeq?this.sender.heroSeq:1);cc.loader.loadRes(l,cc.SpriteFrame,function(e,t){c.spr_plane.node.active=!0,c.spr_plane.spriteFrame=t});var d=this.sender.headimg;d&&""!=d&&cc.loader.load({url:d,type:"png"},function(e,t){c.spr_head_snd.spriteFrame=new cc.SpriteFrame(t)}),this.lab_name.string=this.sender.name?this.sender.name:"",this.lab_score.string=this.sender.score?this.sender.score:"";var u=this.sender.award?this.sender.award:0;this.lab_star.string="x"+u}else this.spr_plane.node.active=!1,this.lab_name.string="",this.lab_score.string="\u6682\u65e0\u5206\u6570.",this.lab_star.string="x0"},countDown:function(){this.countTime-=1,this.lab_time.string="\u6709\u6548\u6311\u6218\u65f6\u95f4\u5269\u4f59\uff1a"+a.secondsToHMS(this.countTime),this.countTime<=0&&(this.lab_time.node.stopAllActions(),this.lab_time.string="\u6709\u6548\u6311\u6218\u65f6\u95f4\u5269\u4f59\uff1a00:00:00",this.isSender?(this.lab_battle.string="\u9886\u53d6\u5956\u52b1",this.battleType=3):this.btn_battle.interactable=!1,n.sysMessage("\u6311\u6218\u5df2\u8fc7\u671f"))},initRecordList:function(e){for(var t=this.scrollview.content,i=0;i<e.length;i++){var o=e[i];if(o.userId!=this.sender.userId){var n=cc.instantiate(this.pfb_battle_item),a=n.getComponent("battleItem");a&&a.initWithData(o),t.addChild(n)}}},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onBtnBackMain:function(){this.onBtnSound(),"Game"==c.curSceneName?(c.loadScene("Start"),D.commonState.isBattle=!1,D.commonState.battleFromUserId=0):n.removePopUpLayer(this)},onBtnBattle:function(){this.onBtnSound(),this.isResult&&this.countTime>0&!this.isSender?this.battleAgain():1==this.battleType?this.gotoShare():2==this.battleType?this.gotoBattle():3==this.battleType&&this.gotoReceive()},gotoReceive:function(){var e=this;o.requestBattleRecv(function(t){n.receiveAward(t),e.lab_battle.string="\u5f00\u59cb\u6e38\u620f",e.battleType=2})},gotoBattle:function(){var e=this,t=function(){o.requestBill(100002,2,200),D.isVoideClose||(cc.audioEngine.stop(D.commonState.hallAudioID),D.commonState.hallAudioID=0);var t=c.isLoadedGame?"Game":"Tmp";c.loadScene(t),D.commonState.isBattle=!0,D.commonState.battleFromUserId=e.battleFromUserId};cc.loader.loadRes("prefabs/beginFight",function(e,i){var o=n.showPopUpLayer(i).getComponent("beginFight");o&&o.setCallBack(t,D.currHero.kind)})},battleAgain:function(){var e=this,t=function(){n.removePopUpLayer(e),o.requestBill(100006,4,200),c.loadScene("Tmp"),D.commonState.isBattle=!0,D.commonState.battleFromUserId=e.battleFromUserId};cc.loader.loadRes("prefabs/beginFight",function(e,i){var o=n.showPopUpLayer(i).getComponent("beginFight");o&&o.setCallBack(t,D.currHero.kind)})},gotoShare:function(){var e=n.getShareCfgByType(D.ShareTypeBattle),t=e.title,i=e.imageUrl,a=(o.getUserSkey(),o.getUserId());o.shareAppMessage(t,i,"type=shareBattle&fromUserId="+a,function(e){e?(n.sysMessage("\u53d1\u8d77\u6311\u6218\u6210\u529f\uff01"),o.requestBill(100007,15,200,1)):o.requestBill(100007,15,200,0)})}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",TimeUtils:"TimeUtils",common:"common",sceneManager:"sceneManager"}],beHurtAni:[function(e,t,i){"use strict";cc._RF.push(t,"45c3b3SGd9JXYbSMKVgEMOg","beHurtAni"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.setScale(1,cc.winSize.height/1280)},onCollisionEnter:function(e,t){},update:function(e){}}),cc._RF.pop()},{}],beattackAni:[function(e,t,i){"use strict";cc._RF.push(t,"068a4/wR+pARY15Nq8yLLE9","beattackAni"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},playEff:function(){var e=this.getComponent(cc.Animation);e.play("beAttacked"),e.on("finished",this.removeBullet,this)},onCollisionEnter:function(e,t){},removeBullet:function(){this.bulletGroup.destroyBullet(this.node)},update:function(e){}}),cc._RF.pop()},{}],beginFightItem:[function(e,t,i){"use strict";cc._RF.push(t,"74409Jdj8ZFbbKb+0h34TYM","beginFightItem");var o=e("common"),n=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{bg_normal:cc.Sprite,bg_choose:cc.Sprite,img_icon:cc.Sprite,img_star:cc.Sprite,img_selected:cc.Sprite,txt_name:cc.Label,txt_desc:cc.Label,txt_cost:cc.Label,btn_charge:cc.Sprite,btn_share:cc.Sprite,upgradFialPrefab:cc.Prefab,choose:!1},onLoad:function(){this.bg_normal.node.active=!0,this.bg_choose.node.active=!1,this.img_selected.node.active=!1,this.txt_name.string="",this.txt_desc.string="",this.txt_cost.string=""},start:function(){},initData:function(e){console.log("---------------beginFightItem data : "),console.log(e),this.cfgData=e,this.txt_name.string=String(e.name),this.txt_desc.string=String(e.desc),1==e.chargeType?(this.txt_cost.string=String(e.cost),this.btn_charge.node.active=!0,this.btn_share.node.active=!1):2==e.chargeType&&(this.btn_charge.node.active=!1,this.btn_share.node.active=!0,this.img_star.node.active=!1);var t=this,i="items/item_"+e.id;cc.loader.loadRes(i,cc.SpriteFrame,function(e,i){t.img_icon.spriteFrame=i})},handleSelected:function(){1==this.cfgData.chargeType?this.chargeByStar():2==this.cfgData.chargeType&&this.chargeByShare()},chargeByStar:function(){var e=this;if(this.choose)this.mainScript.onRemoveCharge(this.cfgData.id,this.cfgData.cost),this.bg_normal.node.active=!0,this.bg_choose.node.active=!1,this.img_selected.node.active=!1,this.choose=!1,this.btn_charge.node.active=!0,this.img_star.node.active=!0;else if(this.mainScript.myStarNum-this.mainScript.costStarNum>=this.cfgData.cost)e.mainScript.onCharge(e.cfgData.id,e.cfgData.cost),e.choose=!0,e.bg_normal.node.active=!1,e.bg_choose.node.active=!0,e.img_selected.node.active=!0,e.btn_charge.node.active=!1,e.img_star.node.active=!1;else{var t=o.showPopUpLayer(this.upgradFialPrefab).getComponent("upgradeFail");t&&t.useLabDesc()}},chargeByShare:function(){var e=this;this.choose?(this.mainScript.onRemoveCharge(this.cfgData.id,0),this.bg_normal.node.active=!0,this.bg_choose.node.active=!1,this.img_selected.node.active=!1,this.choose=!1,this.btn_share.node.active=!0):this.shareItem(function(){e.mainScript.onCharge(e.cfgData.id,0),e.bg_normal.node.active=!1,e.bg_choose.node.active=!0,e.img_selected.node.active=!0,e.choose=!0,e.btn_share.node.active=!1})},shareCoin:function(e){var t=this,i=o.getShareCfgByType(D.ShareTypeFriend),a=i.title,c=i.imageUrl;n.shareAppMessageCallback(a,c,"",function(i){n.isTodayWxAwardShareBeyond()?1==i?(n.requestAddCoin(D.AwardCoinShare,D.ReasonAddCoinShare,function(e){t.mainScript.myStarNum=t.mainScript.myStarNum+e.currCoin}),o.sysMessage("\u5206\u4eab\u83b7\u5f97 "+D.AwardCoinShare+" \u661f\u661f\uff01"),e&&e(),n.requestBill(100007,11,200,1),n.setTodayWxAwardShare()):n.requestBill(100007,11,200,0):o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01")})},shareItem:function(e){var t=this,i=o.getShareCfgByType(D.ShareTypeFriend),a=i.title,c=i.imageUrl;this.shareTime=Date.now()/1e3,n.shareAppMessageCallback(a,c,"",function(i){(function(i){t.scheduleOnce(function(){Date.now()/1e3-t.shareTime<2.5?o.sysMessage("\u8bf7\u5206\u4eab\u5230\u4e0d\u540c\u7684\u7fa4\u5185"):1==i?(e&&e(),o.sysMessage("\u5206\u4eab\u83b7\u5f97 "+t.cfgData.name)):o.sysMessage("\u5206\u4eab\u5931\u8d25")},.01)})(i)})}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],beginFight:[function(e,t,i){"use strict";cc._RF.push(t,"9f6f0r84idJIIzOPmcFQjX+","beginFight");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils"));cc.Class({extends:cc.Component,properties:{txtStar:cc.Label,btn_close:cc.Button,btn_start:cc.Button,scroll_view:{type:cc.ScrollView,default:null},spr_plane:cc.Sprite,btn_left:cc.Button,btn_right:cc.Button,spr_eff:cc.Sprite,myStarNum:0,costStarNum:0,isCanShare:!1,chargedItems:[]},onLoad:function(){this.scroll_view.bounceDuration=.5;var e=this;n.requestGameInfo(function(t){e.myStarNum=t.coin,e.txtStar.string=String(t.coin)}),n.requestShareCfg("beginFightShare",function(t){"s"==t&&(e.isCanShare=!0)}),D.commonState.heroList.length<2&&(this.btn_left.node.active=!1,this.btn_right.node.active=!1),this.spr_eff.node.runAction(cc.repeatForever(cc.rotateBy(2,360))),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),Notification.on("upgradeCoin",this.onCoinChange,this)},start:function(){this.createItems()},createItems:function(){var e=o.getJsonCfgs("beginFight"),t=this,i=this.scroll_view.content;cc.loader.loadRes("prefabs/beginFightItem",function(o,n){(function(o){if(null!=e){for(var n=0,a=0;a<e.length;a++){var c=e[a],s=2==c.chargeType&&t.isCanShare;if(1==c.chargeType||s){var r=cc.instantiate(o);i.addChild(r),n+=17,r.position=cc.v2(0,-n),n+=r.height;var l=r.getComponent("beginFightItem");l&&e[a]&&(l.mainScript=t,l.initData(c))}}i.height=n>i.height?n:i.height}})(n)})},onCharge:function(e,t){this.costStarNum+=t,this.txtStar.string=String(this.myStarNum-this.costStarNum),this.chargedItems.some(function(t){return t==e})||this.chargedItems.push(e)},onRemoveCharge:function(e,t){this.costStarNum-=t,this.txtStar.string=String(this.myStarNum-this.costStarNum);var i=this.chargedItems.filter(function(t,i){return t!=e});this.chargedItems=i},handleBtnClose:function(e){o.removePopUpLayer(this)},handleBtnStart:function(){if(this.costStarNum>0&&n.requestAddCoin(-this.costStarNum,D.ReasonCostCoinFight,function(e){}),D.beginFightBuffs=this.chargedItems,this.callback){var e=D.commonState.heroList[this.currSHowHeroIdx];e&&(D.currHero=e),this.callback()}o.removePopUpLayer(this)},onDestroy:function(){this.callback=null,Notification.off("upgradeCoin",this.onCoinChange)},setCallBack:function(e,t,i){this.callback=e;if(D.commonState.heroList)for(var o=0;o<D.commonState.heroList.length;o++){if(D.commonState.heroList[o].kind==t){this.currSHowHeroIdx=o;break}}this.checkShowHero()},onBtnLeft:function(){this.currSHowHeroIdx++,this.checkShowHero()},onBtnRight:function(){this.currSHowHeroIdx--,this.checkShowHero()},onTouchEnd:function(e){e.touch.getDelta();var t=e.touch._startPoint,i=e.touch._point.x-t.x;if(i>0&&Math.abs(i)>100)this.currSHowHeroIdx--;else{if(!(i<0&&Math.abs(i)>100))return;this.currSHowHeroIdx++}this.checkShowHero()},checkShowHero:function(){this.currSHowHeroIdx>D.commonState.heroList.length-1?this.currSHowHeroIdx=0:this.currSHowHeroIdx<0&&(this.currSHowHeroIdx=D.commonState.heroList.length-1);var e=D.commonState.heroList[this.currSHowHeroIdx],t="plane/plane_"+e.kind+"_"+e.subSeq,i=this;cc.loader.loadRes(t,cc.SpriteFrame,function(e,t){i.spr_plane.spriteFrame=t})},onCoinChange:function(){var e=this;n.requestGameInfo(function(t){e.myStarNum=t.coin,e.txtStar.string=String(e.myStarNum-e.costStarNum)})}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],bulletGroup:[function(e,t,i){"use strict";cc._RF.push(t,"3807dSPT35G8ZA8afVANPPV","bulletGroup");var o=e("pool"),n=e("../Common/myeval"),a=e("common"),c=cc.Class({name:"bulletPosition",properties:{positionX:{default:"",tooltip:"\u5b50\u5f39\u76f8\u5bf9Hero\u7684\u4f4d\u7f6e"}}}),s=cc.Class({name:"infiniteBullet",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),r=cc.Class({extends:s,name:"finiteBullet",properties:{duration:0,ufoBulletName:""}}),l=cc.Class({name:"enemyInfiniteBullet",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),d=cc.Class({name:"jiguangBullet",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),u=cc.Class({name:"beAttackedEff",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),h=cc.Class({name:"enemyMissileBullet",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),m=cc.Class({name:"liaojiBullet",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),p=cc.Class({name:"enemyDaoDanBullet",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}}),f=cc.Class({name:"enemyBossBullet_1",properties:{name:"",rate:0,size:0,prefab:cc.Prefab,position:{default:[],type:c,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"}}});cc.Class({extends:cc.Component,properties:function(){return{mainScript:{default:null,type:e("main")},infiniteBullet:{default:null,type:s,tooltip:"\u65e0\u9650\u5b50\u5f39"},finiteBullet:{default:[],type:r,tooltip:"\u6709\u9650\u5b50\u5f39"},enemyInfiniteBullet:{default:null,type:l,tooltip:"\u654c\u4eba\u5b50\u5f39\u65e0\u9650\u5b50\u5f39"},jiguangBullet:{default:null,type:d,tooltip:"\u6fc0\u5149\u5b50\u5f39"},beAttackedEff:{default:null,type:u,tooltip:"\u53d7\u51fb\u52a8\u753b"},enemyMissileBullet:{default:null,type:h,tooltip:"\u53d7\u51fb\u52a8\u753b"},liaojiBullet:{default:null,type:m,tooltip:"\u50da\u673a\u8dd1\u5f39\u52a8\u753b"},enemyDaoDanBullet:{default:null,type:p,tooltip:"Boss\u70ae\u5f39\u52a8\u753b"},enemyBossBullet_1:{default:null,type:f,tooltip:"Boss\u70ae\u5f39\u52a8\u753b"},bulletSound:{default:null,type:cc.AudioClip},bulletSound2:{default:null,type:cc.AudioClip},tmpSpriteFrame:{default:null,type:cc.SpriteFrame},hero:cc.Node,heroAttackSpeedNum:0,isFireStatus:!1,isStopEnemyBullet:!1}},onLoad:function(){o.initPool(this,this.infiniteBullet),o.initPoolBatch(this,this.finiteBullet),o.initPool(this,this.enemyInfiniteBullet),o.initPool(this,this.jiguangBullet),o.initPool(this,this.enemyMissileBullet),o.initPool(this,this.beAttackedEff),o.initPool(this,this.liaojiBullet),o.initPool(this,this.enemyDaoDanBullet),o.initPool(this,this.enemyBossBullet_1)},startAction:function(){Notification.on("send_bullet_event_globle",this.enmySendBulletEvent,this),Notification.on("level_begin_event",this.levelBeginlHandler,this),Notification.on("level_over_event",this.levelOverHandler,this),Notification.on("stop_bullet_event",this.levelOverHandler,this);var e=a.getGameHeroCfg();this.heroAttackSpeedNum=e.initAttackSpeed+e.initAttackSpeed*e.attackSpeedRadix/100*D.currHero.attackSpeedLevel,this.startNormalShoot()},levelOverHandler:function(){this.stopShootHandler()},levelBeginlHandler:function(){this.isFireStatus||this.startNormalShoot()},startNormalShoot:function(e){this.stopShootHandler(),this.starShootHandler(),e&&(Notification.emit("change_bullet_buff",{item:"item_11"}),null!=this.node.finitAct&&(this.node.stopAction(this.node.finitAct),this.node.finitAct=null))},stopShootHandler:function(){this.isFireStatus=!1,this.node.stopAction(this.normalShootAction),this.node.stopAction(this.doubleShootAction)},starShootHandler:function(){if(!this.jiguangBulletNow){this.stopShootHandler();var e=this.heroAttackSpeedNum;e>20&&(e=20);var t=cc.delayTime(1/e),i=cc.callFunc(this.startShoot,this),o=cc.repeatForever(cc.sequence(t,i));this.normalShootAction=this.node.runAction(o),this.isFireStatus=!0}},startShoot:function(){1==D.currHero.kind?this.startShoot_1():2==D.currHero.kind?this.startShoot_2():4==D.currHero.kind?this.startShoot_4():this.startShoot_3()},startShoot_1:function(){this.makeNewBullet(this.infiniteBullet)},startShoot_2:function(e){var t=this.hero.getComponent("hero");this.shootCount||(this.shootCount=0),e||5==t._skinSubSeq?(this.shootCount%2==0?(this.makeNewBullet(this.infiniteBullet,1,-15,-50,-20,"bullet/bullet_new_2_1",5),this.makeNewBullet(this.infiniteBullet,1,0,-50,-20,"bullet/bullet_new_2_1",5),this.makeNewBullet(this.infiniteBullet,1,0,50,-20,"bullet/bullet_new_2_1",5),this.makeNewBullet(this.infiniteBullet,1,15,50,-20,"bullet/bullet_new_2_1",5)):(this.makeNewBullet(this.infiniteBullet,1,0,-50,-20,"bullet/bullet_new_2_2",5),this.makeNewBullet(this.infiniteBullet,1,0,50,-20,"bullet/bullet_new_2_2",5)),this.makeNewBullet(this.infiniteBullet,2,0,0,-20,"bullet/bullet_new_2_4",5)):1==t._skinSubSeq?(this.makeNewBullet(this.infiniteBullet,1,-5,0,-50,"bullet/bullet_new_2_1",2),this.makeNewBullet(this.infiniteBullet,1,5,0,-50,"bullet/bullet_new_2_1",2)):2==t._skinSubSeq?this.shootCount%2==0?(this.makeNewBullet(this.infiniteBullet,1,-10,-50,-20,"bullet/bullet_new_2_1",3),this.makeNewBullet(this.infiniteBullet,1,0,0,-20,"bullet/bullet_new_2_1",3),this.makeNewBullet(this.infiniteBullet,1,10,50,-20,"bullet/bullet_new_2_1",3)):this.makeNewBullet(this.infiniteBullet,1,0,0,-20,"bullet/bullet_new_2_2",3):3==t._skinSubSeq?this.shootCount%2==0?(this.makeNewBullet(this.infiniteBullet,1,-15,-50,-20,"bullet/bullet_new_2_1",4),this.makeNewBullet(this.infiniteBullet,1,0,-30,-20,"bullet/bullet_new_2_1",4),this.makeNewBullet(this.infiniteBullet,1,0,30,-20,"bullet/bullet_new_2_1",4),this.makeNewBullet(this.infiniteBullet,1,15,50,-20,"bullet/bullet_new_2_1",4)):(this.makeNewBullet(this.infiniteBullet,1,0,-30,-20,"bullet/bullet_new_2_2",4),this.makeNewBullet(this.infiniteBullet,1,0,30,-20,"bullet/bullet_new_2_2",4)):4==t._skinSubSeq&&(this.shootCount%2==0?(this.makeNewBullet(this.infiniteBullet,1,-15,-50,-20,"bullet/bullet_new_2_1",5),this.makeNewBullet(this.infiniteBullet,1,0,-50,-20,"bullet/bullet_new_2_1",5),this.makeNewBullet(this.infiniteBullet,1,0,50,-20,"bullet/bullet_new_2_1",5),this.makeNewBullet(this.infiniteBullet,1,15,50,-20,"bullet/bullet_new_2_1",5)):(this.makeNewBullet(this.infiniteBullet,1,0,-50,-20,"bullet/bullet_new_2_2",5),this.makeNewBullet(this.infiniteBullet,1,0,50,-20,"bullet/bullet_new_2_2",5)),this.makeNewBullet(this.infiniteBullet,1,0,0,-20,"bullet/bullet_new_2_3",5)),this.shootCount++},startShoot_3:function(e){var t=this.hero.getComponent("hero");this.shootCount||(this.shootCount=0);var i=this,o=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=0;n<8;n++){var a=360*n/8,c=65*Math.cos(2*Math.PI/360*a),s=65*Math.sin(2*Math.PI/360*a);i.makeNewBullet(i.infiniteBullet,1,o,c+e,s+t,"bullet/bullet_new_3_1",8,800)}},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=i.makeNewBullet(i.infiniteBullet,1,o,0,-30,"bullet/bullet_new_3_2",1,800);a.stopMove=!0;var c=cc.moveBy(n,cc.v2(e,t)),s=cc.callFunc(function(){a.stopMove=!1});a.node.runAction(cc.sequence(c,s))};e||5==t._skinSubSeq?(o(0,0,-10),o(0,0,10),n(-120,-80,2),n(120,-80,2),n(-80,-30,1),n(80,-30,1)):1==t._skinSubSeq?o(0,0,0):2==t._skinSubSeq?(o(0,0,0),n(-100,-80),n(100,-80)):3==t._skinSubSeq?(o(0,0,-10),o(0,0,10)):4==t._skinSubSeq&&(o(0,0,-10),o(0,0,10),n(-120,-80,2),n(120,-80,2)),this.shootCount++},startShoot_4:function(e){this.shootCount||(this.shootCount=0);this.ddddd||(this.ddddd=1,this.shootCount=0),this.shootCount+=this.ddddd,this.shootCount>=10?(this.ddddd=-1,this.shootCount=10):this.shootCount<0&&(this.ddddd=1,this.shootCount=0);var t=3*this.shootCount,i=this.makeNewBullet(this.infiniteBullet,1,0,-25-1*t,-50,"bullet/bullet_new_4_1",4,800);i.needPlaySound=!1,this.makeNewBullet(this.infiniteBullet,1,0,-1*t,-50,"bullet/bullet_new_4_2",4,800),this.makeNewBullet(this.infiniteBullet,1,0,25+t,-50,"bullet/bullet_new_4_1",4,800),(i=this.makeNewBullet(this.infiniteBullet,1,0,t,-50,"bullet/bullet_new_4_2",4,800)).needPlaySound=!1},changeBullet:function(e,t){if(!this.jiguangBulletNow){this.stopShootHandler();for(var i=0;i<this.finiteBullet.length;i++)this.finiteBullet[i].ufoBulletName===e&&(this.sendDoubleBullet(this.finiteBullet[i]),this.isFireStatus=!0,null!=this.node.finitAct&&(this.node.stopAction(this.node.finitAct),this.node.finitAct=null),this.node.finitAct=this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(this.startNormalShoot,this))))}},sendDoubleBullet:function(e){this.startDoubleShoot=function(){2==D.currHero.kind?this.startShoot_2(!0):3==D.currHero.kind?this.startShoot_3(!0):4==D.currHero.kind?this.startShoot_4(!0):this.makeNewBullet(e,2)};var t=this.heroAttackSpeedNum;4==D.currHero.kind&&(t=20),t>20&&(t=20);var i=cc.repeatForever(cc.sequence(cc.delayTime(1/t),cc.callFunc(this.startDoubleShoot,this)));this.doubleShootAction=this.node.runAction(i)},makeNewBullet:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1500,r=e.name+"Pool",l=this.hero.getPosition();l.y=l.y+50;var d=this.hero.getComponent("hero"),u=void 0;return(u=2==t&&2!=D.currHero.kind?this.creatreBullet2(r,e.prefab,l):this.creatreBullet(r,e.prefab,l,a)).node.x+=o,u.node.y+=n,u.setMoveRotation(i),u.speed=s,u.attackNum=d.attackNum/c*t,u},creatreBullet:function(e,t,i,n){var a=o.borrowNewNode(this[e],t,this.node);a.setPosition(i);var c=a.getComponent("bullet");c.bulletGroup=this,c.setIsPlayer(!0);var s=this.hero.getComponent("hero");if(c.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW,this.bulletObj||(this.bulletObj={}),n||(n=4==s._skinKind?"bullet/bullet_"+s._skinKind+"_1":"bullet/bullet_"+s._skinKind+"_"+s._skinSubSeq),this.bulletObj[n])c.getComponent(cc.Sprite).spriteFrame=this.bulletObj[n];else{var r=this;cc.loader.loadRes(n,cc.SpriteFrame,function(e,t){r.bulletObj[n]=t,c.getComponent(cc.Sprite).spriteFrame=r.bulletObj[n]})}return 2==s._skinKind&&c.node.setScale(1.2),(s._skinSubSeq>=3||3==s._skinKind)&&(c.getComponent(cc.BoxCollider).size.width=100,5==s._skinSubSeq&&(c.getComponent(cc.BoxCollider).size.width=130)),c},creatreBullet2:function(e,t,i){var n=o.borrowNewNode(this[e],t,this.node);n.setPosition(i);var a=n.getComponent("bullet");a.bulletGroup=this,a.setIsPlayer(!0);var c=this.hero.getComponent("hero");if(a.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW,!this.tmp2SpriteFrame){var s="bullet/bullet_"+c._skinKind+"_5",r=this;cc.loader.loadRes(s,cc.SpriteFrame,function(e,t){r.tmp2SpriteFrame=t,a.getComponent(cc.Sprite).spriteFrame=t})}return this.tmp2SpriteFrame&&(a.getComponent(cc.Sprite).spriteFrame=this.tmp2SpriteFrame),a.getComponent(cc.BoxCollider).size.width=130,a},creatreLiaojiBullet:function(e,t,i){var n=o.borrowNewNode(this[e],t,this.node);n.setPosition(i);var a=n.getComponent("bullet");return a.bulletGroup=this,a.speed=16,a.isLiaojiDaoDan=!0,a.setIsPlayer(!0),a.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW,a.hero=this.hero,a},getPositionOfBullet:function(e){var t=this.hero.getPosition(),i=t.x+this.hero.width*e,o=t.y;return cc.v2(i,o)},enmySendBulletEvent:function(e){if(!this.isStopEnemyBullet){var t=e;t.bossBulletType>0?2==t.bossBulletType?this.enemySendDaoDanBullet(t,this.enemyDaoDanBullet):1==t.bossBulletType&&this.enemySendDaoDanBullet(t,this.enemyBossBullet_1):this.enemySendBullet(t)}},enemySendBullet:function(e){for(var t=this,i=this.enemyInfiniteBullet,a=i.name+"Pool",c=function(c){var s=o.borrowNewNode(t[a],i.prefab,t.node),l=e.x+n.cal(i.position[c].positionX),d=e.y;s.setPosition(cc.v2(l,d));var u=s.getComponent("bullet");if(u.bulletGroup=t,u.setIsPlayer(!1),u.speed=1.2*e.speed+50,u.attackNum=e.attackNum,u.moveRotation=e.rotation,u.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW,e.defaultSkin){u.getComponent(cc.Animation).stop();var h=e.defaultSkin;t.bulletObj[h]?u.getComponent(cc.Sprite).spriteFrame=t.bulletObj[h]:(r=t,cc.loader.loadRes(h,cc.SpriteFrame,function(e,t){r.bulletObj[h]=t,u.getComponent(cc.Sprite).spriteFrame=r.bulletObj[h]}))}else u.getComponent(cc.Animation).play();2==e.enemyType||3==e.enemyType?u.node.scale=1.5:u.node.scale=1,e.stepMovePos&&(u.stopMove=!0,t.ctrlMoveBullet(u,e))},s=0;s<i.position.length;s++){var r;c(s)}},ctrlMoveBullet:function(e,t){var i=cc.moveTo(.5,t.stepMovePos),o=cc.callFunc(function(){e.stopMove=!1});e.node.runAction(cc.sequence(i,o))},enemySendDaoDanBullet:function(e,t){if(!this.isStopEnemyBullet){var i=t.name+"Pool",n=o.borrowNewNode(this[i],t.prefab,this.node),a=e.x,c=e.y;n.setPosition(cc.v2(a,c));var s=n.getComponent("bullet");s.bulletGroup=this,s.setIsPlayer(!1),s.speed=e.speed,s.attackNum=e.attackNum,s.moveRotation=e.rotation,s.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW}},missileBulletHandler:function(e,t){var i=this.enemyMissileBullet,n=i.name+"Pool",a=o.borrowNewNode(this[n],i.prefab,this.node);a.setPosition(cc.v2(e,t));var c=a.getComponent("bullet");c.bulletGroup=this,c.setMoveRotation(180),c.setIsPlayer(!1),c.speed=650,c.attackNum=1e8},sendJiGuangBullet:function(){var e=this;if(this.stopShootHandler(),this.node.stopAction(this.jiguangStopAct),!this.jiguangBulletNow){var t=this.jiguangBullet,i=t.name+"Pool",n=o.borrowNewNode(this[i],t.prefab,this.node).getComponent("bullet");n.bulletGroup=this,n.hero=this.hero,n.isJiGuamg=!0,n.setIsPlayer(!0),n.checkJiGuangSound(),this.jgBullet=n}this.jiguangBulletNow=!0;var c=a.getJsonCfgByID("Items",12);c&&(this.jiguangStopAct=this.node.runAction(cc.sequence(cc.delayTime(c.periodTime),cc.callFunc(function(){e.closeJiGuangBullet()}))))},closeJiGuangBullet:function(){this.jiguangBulletNow=!1,this.jgBullet&&this.jgBullet.getComponent("bullet").forceRemove(),this.startNormalShoot(),Notification.emit("change_bullet_buff",{item:"item_12"})},beattackedHandler:function(e,t,i){var n=this.beAttackedEff,a=n.name+"Pool",c=o.borrowNewNode(this[a],n.prefab,this.node);c.setPosition(cc.v2(e,t));var s=c.getComponent("beattackAni");s.bulletGroup=this,s.playEff(),i||(i=1)},liaojiHandler:function(e){this.liaojiStatus=e,this.callBackFunc=function(){this.startLiaojiShoot()},this.node.stopAction(this.liaojiAction),this.liaojiAction=-1;var t=cc.delayTime(1),i=cc.callFunc(this.callBackFunc,this),o=cc.repeatForever(cc.sequence(t,i));this.liaojiAction=this.node.runAction(o)},startLiaojiShoot:function(){if(this.liaojiStatus){var e=this.liaojiBullet,t=this.hero.getComponent("hero"),i=e.name+"Pool",o=this.mainScript.getLiaojiPoint(1);this.creatreLiaojiBullet(i,e.prefab,o).attackNum=t.attackNum/2;var n=this.mainScript.getLiaojiPoint(2);this.creatreLiaojiBullet(i,e.prefab,n).attackNum=t.attackNum/2}},getNearEnemyByPos:function(e){return this.mainScript.getNearEnemyByPos(e)},gameOver:function(){this.node.stopAllActions(),this.isFireStatus=!1,this.jiguangBulletNow=!1,Notification.off("send_bullet_event_globle",this.enmySendBulletEvent),Notification.off("level_begin_event",this.levelBeginlHandler),Notification.off("level_over_event",this.levelOverHandler),Notification.off("stop_bullet_event",this.levelOverHandler)},gamePause:function(){this.node.pauseAllActions()},gameResume:function(){this.node.resumeAllActions()},destroyBullet:function(e){o.returnNode(this,e)},stopEnemyBullet:function(){this.isStopEnemyBullet=!0},resumeEnemyBullet:function(){this.isStopEnemyBullet=!1}}),cc._RF.pop()},{"../Common/myeval":"myeval",common:"common",main:"main",pool:"pool"}],bullet:[function(e,t,i){"use strict";cc._RF.push(t,"a045eQGS9BIPK4Bgej4gBpi","bullet"),cc.Class({extends:cc.Component,properties:{speed:cc.Integer,rationNum:0,owner:1,attackNum:0,moveRotation:0,isJiGuamg:!1,isLiaojiDaoDan:!1,jiguangSound:{default:null,type:cc.AudioClip},stopMove:!1,needPlaySound:!0},setIsPlayer:function(e){this.owner=e?1:2},checkJiGuangSound:function(e){this.isJiGuamg&&(this.soundID=cc.audioEngine.play(this.jiguangSound,!0))},isPlayerBullet:function(){return 1==this.owner},onLoad:function(){},onCollisionEnter:function(e,t){if(!this.isJiGuamg)if("jiguang"===e.node.group&&(this.bulletGroup.destroyBullet(t.node),this.bulletGroup.beattackedHandler(this.node.x,this.node.y+30)),"hero"===e.node.group)2==this.owner&&this.bulletGroup.destroyBullet(t.node);else if("enemy"===e.node.group&&1==this.owner){this.bulletGroup.destroyBullet(t.node);var i=1;2==e.node.enemyType?i=.6:1==e.node.enemyType&&(i=.3),this.bulletGroup.beattackedHandler(this.node.x,this.node.y+30*i,i)}},forceRemove:function(){this.bulletGroup.destroyBullet(this.node),cc.audioEngine.stop(this.soundID)},setMoveRotation:function(e){this.moveRotation=e,this.node.rotation=this.moveRotation},daodanMove:function(){var e=this.node.getPosition();if(this.targetObj){var t=this.targetObj.getComponent("enemy");t&&(t.isLife()&&t.isInWinsize()||(this.targetObj=null))}if(this.targetObj||(this.targetObj=this.bulletGroup.getNearEnemyByPos(e)),this.targetObj){var i=this.targetObj.node.getPosition().subSelf(e),o=i.mag(),n=e.x+this.speed*i.x/o,a=e.y+this.speed*i.y/o,c=JsUnit.getVectorRadians(this.node.x,this.node.y,n,a);this.node.rotation=c,this.node.setPosition(cc.v2(n,a))}else this.normolMove(this.speed)},update:function(e){if(!D.gameStatuePause)if(this.isJiGuamg)1==this.owner&&this.hero&&(this.node.x=this.hero.getComponent("hero").node.x,this.node.y=this.hero.getComponent("hero").node.y);else if(1!=this.owner){var t=e*this.speed*this.bulletGroup.mainScript.gameSpeed;this.normolMove(t)}else{if(this.isLiaojiDaoDan)return void this.daodanMove();var i=e*this.speed*this.bulletGroup.mainScript.gameSpeed;this.normolMove(i)}},normolMove:function(e){if(!this.stopMove){var t=e*Math.cos(Math.PI/180*this.moveRotation),i=e*Math.sin(Math.PI/180*this.moveRotation);this.node.rotation=this.moveRotation,this.node.x+=i,this.node.y+=t,this.checkRemove()}},checkRemove:function(){(this.node.y<=-cc.winSize.height/2||this.node.y>=cc.winSize.height/2||this.node.x>=cc.winSize.width/2||this.node.x<=-cc.winSize.width/2)&&this.forceRemove()}}),cc._RF.pop()},{}],common:[function(e,t,i){"use strict";var o;function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}cc._RF.push(t,"3885cJjRVdDoZUt3qzsftJ3","common");var a=(n(o={baseZorder:1e3,popLayerNum:0,isLoading:cc.Boolean,PopUpBg:{None:0,Gray:1},PopUpAction:{None:0,Scale:1},writeObj:function(e){var t="";for(var i in e){t+=i+" = "+e[i]+"\n"}console.log(t)},loadJsonCfg:function(e){if(!D.commonConfigs[e]){var t=D.configsDir+e;cc.loader.loadRes(t,function(t,i){D.commonConfigs[e]=i.json,cc.log("load...load["+e+"], err["+t+"] result: "+JSON.stringify(i.json))})}},loadJsonAllCfgs:function(){var e=D.configsDir;cc.loader.loadResDir(e,function(e,t){t.forEach(function(e){var t=e._name,i=e.json;D.commonConfigs[t]=i,cc.log("loadAlll...load["+t+"], result: "+JSON.stringify(i))})})},getJsonCfgs:function(e){return D.commonConfigs[e]},getJsonCfgByID:function(e,t){var i=this.getJsonCfgs(e),o=null;if(i)for(var n in i)if(i[n].id==t){o=i[n];break}return o},getJsonCfgByKey:function(e,t,i){var o=this.getJsonCfgs(e),n=null;if(o)for(var a in o){var c=o[a];if(c[""+t]==i){n=c;break}}return n},getGameHeroCfg:function(){for(var e=D.currHero.kind,t=D.currHero.level,i=a.getJsonCfgs("hero"),o=0;o<i.length;o++){var n=i[o];if(n.kind==e&&n.level==t)return n}return null},popUpLayer:function(e,t,i){var o=this.createPopUpLayer(e,t,i);return e.addChild(o),o},popUpLayerCurrent:function(e,t){return this.popUpLayer(cc.director.getScene(),e,t)},createPopUpLayer:function(e,t,i){var o=cc.instantiate(t.data),n=i;return n||(n=e.convertToWorldSpace(new cc.v2(o.width/2,o.height/2))),o.position=n,o},createPopUpLayerCurrent:function(e,t){return this.createPopUpLayer(cc.director.getScene(),e,t)},showPopUpLayer:function(e,t,i,o,n){var a=this.createPopUpLayerCurrent(e);this.popLayerNum+=1;var c=this.baseZorder+10*this.popLayerNum;if(null==t&&(t=this.PopUpBg.Gray),t==this.PopUpBg.Gray){var s=cc.director.getScene().getChildByName("GameBlockUITag");if(s)s.zIndex=c-1;else{null==o&&(o=new cc.Color(0,0,0,200)),(s=new cc.Node).position=a.position,s.addComponent(cc.Graphics);var r=s.getComponent(cc.Graphics);r.fillColor=o;var l=Math.max(cc.winSize.width,a.width),d=Math.max(cc.winSize.height,a.height);r.fillRect(0,0,l,d),s.position=cc.v2(0,0),cc.director.getScene().addChild(s,c-1,"GameBlockUITag")}a.addComponent(cc.BlockInputEvents)}if(cc.director.getScene().addChild(a,c),null==i&&(i=this.PopUpAction.Scale),i==this.PopUpAction.Scale){var u=cc.delayTime(.01),h=cc.callFunc(function(){a.scale=.8,a.opacity=255},this),m=cc.scaleTo(.15,1);a.runAction(cc.sequence(u,h,m)),a.opacity=1}return D.removePopUpLayerCallback||(D.removePopUpLayerCallback=n),a},removePopUpLayer:function(e){e.node.parent.removeChild(e.node),this.removeBlock()},removeBlock:function(){this.popLayerNum-=1;var e=cc.director.getScene().getChildByName("GameBlockUITag");if(e)if(this.popLayerNum>0)e.zIndex=this.baseZorder+10*this.popLayerNum-1;else{e.parent.removeChild(e);var t=D.removePopUpLayerCallback;console.log("---------------clearPopLayer scene name="+D.curSceneName),t&&"Start"==D.curSceneName&&(t(),D.removePopUpLayerCallback=null)}0==this.popLayerNum&&Notification.emit("remove_all_poplayer")},clearPopLayer:function(){this.popLayerNum=0;var e=cc.director.getScene().getChildByName("GameBlockUITag");e&&e.parent.removeChild(e)},loading:function(e){if(!this.isLoading){var t=this;this.isLoading=!0,cc.loader.loadRes("prefabs/loading",function(e,i){if(t.isLoading){var o=t.showPopUpLayer(i,t.PopUpBg.Gray,t.PopUpAction.None);o.zIndex=9998,o.name="loadingLayer"}})}},hideLoading:function(){this.isLoading=!1;var e=cc.director.getScene().getChildByName("loadingLayer");e&&(e.parent.removeChild(e),this.removeBlock())},sysMessage:function(e,t,i){cc.loader.loadRes("prefabs/sysMessage",function(o,n){var a=cc.instantiate(n.data),c=a.getComponent("sysMessage");c&&c.onTips(a,e,t,i)})},getShareCfgByType:function(e){var t=this.getJsonCfgs("Share");if(t){var i=[];for(var o in t)t[o].type==e&&i.push(t[o]);return i[Math.floor(Math.random()*i.length)]}return{title:"\u6211\u521a\u521a\u7a81\u7834\u4e86\u6700\u9ad8\u5206\u5566,\u4f60\u8981\u6765\u6311\u6218\u4e00\u4e0b\u5417\uff1f",imageUrl:"https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/share/share6.png"}},guid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},onPlayBtnSound:function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/button",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})},onPlayPopupSound:function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/popup",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})},onPlayBtnReturnSound:function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/button_return",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})},onPlayAwardPlaneSound:function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/award_plane",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})},onPlayAwardCoinSound:function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/award_coin",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})},onPlayScoreChangeSound:function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/score_change",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})}},"onPlayScoreChangeSound",function(){D.isVoideClose||cc.loader.loadRes("subpack/sound/record_breaking",cc.AudioClip,function(e,t){cc.audioEngine.play(t)})}),n(o,"isSameDay",function(e){var t=new Date,i=e.getDate(),o=e.getMonth(),n=e.getFullYear(),a=t.getDate(),c=t.getMonth(),s=t.getFullYear();return console.log("checkDateTime",n,o,i),console.log("nowDateTime",s,c,a),n==s&&o==c&&i==a}),n(o,"stringStartWith",function(e,t){return e.substr(0,t.length)==t}),n(o,"createImage",function(e,t){if(this.stringStartWith(e,"http"));else cc.loader.loadRes(e,cc.SpriteFrame,function(e,i){t.spriteFrame=i})}),n(o,"iphonexAdapter",function(e){if(e&&Device.needOffsetPixel()){var t=e.getComponent(cc.Widget);t?t.top+=100:e.y+=100}}),n(o,"receiveAward",function(e){if(void 0!=e&&null!=e){var t="\u606d\u559c\u60a8\u83b7\u5f97";e.coin&&e.coin>0&&(D.commonState.userGameInfo.coin=e.mycoin,t=t+"\u661f\u661fx"+e.coin),e.qzb&&e.qzb>0&&(D.commonState.userGameInfo.qzb=e.myqzb,t=t+",\u94bb\u77f3x"+e.qzb),null!=e.hero&&(D.commonState.heroList.push(e.hero),t+=",\u5c0f\u98de\u673ax1"),e.items&&e.items.length>0&&(platformUtils.requestItemList(function(e){},!0),e.items.forEach(function(e,i){e.id==ItemConst.SignHeroGas&&(t+=",\u7b7e\u5230\u62d6\u5c3ex1")})),console.log(t),this.sysMessage(t)}}),n(o,"getMoreGamePath",function(e){var t=null;return e&&D.wxMoreGamePath[e]&&(t=D.wxMoreGamePath[e]),t}),n(o,"getMoreGameIcon",function(e){for(var t=["wx5079dbb42e9672b7","wxd4abb0f4db18da79","wxf6658e9f64a5c09c","wx25a6ac1d3557e156","wxe50049290a9887d1","wx71743e2c3394dc9e","wx557f39afcfcb06d6","wxd6c5337aed6300ec","wx52966cd958bcd65b","wxa43c45d6986bcafd","wx5ced162faa4eb1f3","wx79fc05b190c49fde","wxd8de2f6276406b2a","wxe0e3ef455414d91d","wxe003c14add4d3974","wx3df1cf2a43a6b16d","wx5d49b5fa52580889","wxf48553c6ca9bc829","wx7745ae49b819ab1b"],i=1;i<=t.length;i++)if(e==t[i-1])return console.log("------- getMoreGameIcon, idx=",i),i;return console.log("------- getMoreGameIcon, idx=",t.length+1),t.length+1}),o);t.exports=a,cc._RF.pop()},{}],dailySignIn:[function(e,t,i){"use strict";cc._RF.push(t,"6f606QGvrVMfZb8o4K3G8ge","dailySignIn");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils")),a=e("StorageUtils");cc.Class({extends:cc.Component,properties:{sprSignIn:cc.Sprite,btnSound:{default:null,type:cc.AudioClip},awardCoinSound:{default:null,type:cc.AudioClip},sprShareDouble:cc.Sprite,btnShareDouble:cc.Button,sprShareBottom:cc.Sprite,btn_close:cc.Button,isSignedDay3:!1,isSignedDay7:!1},onLoad:function(){var e=this;if(this.sprSignIn.node.active=!1,n.requestSignList(function(t){D.commonState.signCfg=t,D.commonState.userGameInfo.signNum=t.signNum,D.commonState.userGameInfo.todayCanSign=t.todayCanSign,e.loadSign(t)}),this.setDoubleVisible(!1),n.requestShareCfg("signDouble",function(t){var i=a.dailySignIsVideoed();"v"==t&&n.isTodayWxVideoBeyond()&&!i&&(e.setDoubleVisible(!0),e.sprShareDouble.node.stopAllActions(),e.sprShareDouble.node.runAction(cc.repeat(cc.sequence(cc.scaleTo(.5,.7),cc.delayTime(.5),cc.scaleTo(.5,.6)),100)))}),n.requestItemList(function(t){t&&t.forEach(function(t){t.id==ItemConst.SignHeroGas&&(e.isSignedDay3=!0)})}),D.commonState.heroList)for(var t=0;t<D.commonState.heroList.length;t++){if(4==D.commonState.heroList[t].kind){this.isSignedDay7=!0;break}}this.isSignedDay7||cc.loader.loadRes("game/qiandao_day7_plane_1",cc.SpriteFrame,function(t,i){var o=e.sprSignIn.node.children[6].children[0];o&&(o.getComponent(cc.Sprite).spriteFrame=i)})},start:function(){this.btn_close.node.getComponent(cc.Widget);n.createBannerAd(!0)},signNormal:function(e,t,i){1==t?(e.children[1].active=!1,e.children[2].active=!0,e.children[3].active=!1,e.children[4].active=!1,e.children[5].color=new cc.Color(18,52,103,255),e.children[5].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[6].color=new cc.Color(18,52,103,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[7].color=new cc.Color(18,52,103,255),e.children[7].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[8]._components[0].string=i):2==t?(e.children[1].active=!1,e.children[2].active=!0,e.children[3].active=!1,e.children[4].active=!0,e.children[5].color=new cc.Color(18,52,103,255),e.children[5].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[6].color=new cc.Color(18,52,103,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[7].color=new cc.Color(18,52,103,255),e.children[7].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[8].active=!1):3==t&&(e.children[1].active=!0,e.children[2].active=!1,e.children[3].active=!0,e.children[4].active=!1,e.children[5].color=new cc.Color(116,48,24,255),e.children[5].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[6].color=new cc.Color(116,48,24,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[7].color=new cc.Color(116,48,24,255),e.children[7].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[8]._components[0].string=i),e.state=t},signDay3:function(e,t,i){i=null!=i?i:"",this.isSignedDay3?(e.children[4].active=!1,e.children[9]._components[0].string=i,e.children[10].active=!0):(e.children[4].active=!0,e.children[9]._components[0].string="\u7279\u6b8a\u5c3e\u6c14",e.children[10].active=!1),1==t?(e.children[1].active=!1,e.children[2].active=!0,e.children[3].active=!1,e.children[5].active=!1,e.children[6].color=new cc.Color(18,52,103,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[7].color=new cc.Color(18,52,103,255),e.children[7].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[8].color=new cc.Color(18,52,103,255),e.children[8].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[9].active=!0):2==t?(e.children[1].active=!1,e.children[2].active=!0,e.children[3].active=!1,e.children[5].active=!0,e.children[6].color=new cc.Color(18,52,103,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[7].color=new cc.Color(18,52,103,255),e.children[7].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[8].color=new cc.Color(18,52,103,255),e.children[8].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[9].active=!1):3==t&&(e.children[1].active=!0,e.children[2].active=!1,e.children[3].active=!0,e.children[5].active=!1,e.children[6].color=new cc.Color(116,48,24,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[7].color=new cc.Color(116,48,24,255),e.children[7].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[8].color=new cc.Color(116,48,24,255),e.children[8].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[9].active=!0,this.isSignedDay3||this.setDoubleVisible(!1)),e.state=t},signDay7:function(e,t){1==t||2==t?(e.children[1].active=!1,e.children[2].active=!0,e.children[3].active=!1,e.children[4].color=new cc.Color(18,52,103,255),e.children[4].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[5].color=new cc.Color(18,52,103,255),e.children[5].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.children[6].color=new cc.Color(18,52,103,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(18,52,103,255),e.stopAllActions(),e.scale=1):3==t&&(e.children[1].active=!0,e.children[2].active=!1,e.children[3].active=!0,e.children[4].color=new cc.Color(116,48,24,255),e.children[4].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[5].color=new cc.Color(116,48,24,255),e.children[5].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),e.children[6].color=new cc.Color(116,48,24,255),e.children[6].getComponent(cc.LabelOutline).color=new cc.Color(116,48,24,255),this.isSignedDay7||this.setDoubleVisible(!1),e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.05),cc.scaleTo(.5,1))))),e.state=t},loadSign:function(e){var t=!0,i=this;this.sprSignIn.node.children.forEach(function(o,a){if(void 0==e.sign[a])return!1;var c=1;e.sign[a].sign?c=2:e.todayCanSign&&t?(c=3,t=!1,n.setItemByLocalStorage("signCoin",e.sign[a].signCfg.itemNum)):c=1,2==a?i.signDay3(o,c,e.sign[a].signCfg.itemNum):6==a?i.signDay7(o,c):i.signNormal(o,c,e.sign[a].signCfg.itemNum)}),this.sprSignIn.node.active=!0},onSignIn:function(e){this.onBtnSound();var t=this;if(1==e.target.state||3==e.target.state)if(D.commonState.userGameInfo.todayCanSign){var i=D.commonState.userGameInfo.signNum+1;console.log("==== ===D.commonState.userGameInfo.signNum="+D.commonState.userGameInfo.signNum),n.requestSignIn(i,function(e){t.reward(e,e.coin),D.commonState.userGameInfo.todayCanSign=!1})}else o.sysMessage("\u4eca\u65e5\u5df2\u7b7e\u5230,\u8bf7\u660e\u65e5\u518d\u6765!");else o.sysMessage("\u4e0d\u80fd\u91cd\u590d\u7b7e\u5230\u9886\u53d6!")},onClose:function(){this.closeLayer()},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onAwardCoinSound:function(){D.isVoideClose||cc.audioEngine.play(this.awardCoinSound)},setDoubleVisible:function(e){e?(this.btnShareDouble.node.active=!0,this.sprShareDouble.node.active=!0,this.sprShareBottom.node.active=!0):(this.btnShareDouble.node.active=!1,this.sprShareDouble.node.active=!1,this.sprShareBottom.node.active=!1)},onShare:function(){if(a.dailySignIsVideoed())o.sysMessage("\u4e0d\u80fd\u591a\u6b21\u9886\u53d6!");else{var e=n.getItemByLocalStorage("signCoin");void 0==e&&n.requestSignList(function(t){var i=D.commonState.userGameInfo.signNum>0?D.commonState.userGameInfo.signNum-1:0;e=t.sign[i].signCfg.itemNum}),D.commonState.userGameInfo.todayCanSign&&(e*=2),console.log("======= awardCoin="+e),n.requestBill(100008,6,200,0),this.onBtnSound();var t=this,i=function(){n.requestAddCoin(e,D.ReasonAddCoinShare,function(){}),n.requestBill(100008,6,200,1),cc.director.getScene().getChildByName("Canvas").getChildByName("btn_sign").getChildByName("spr_red_point").active=!1,t.closeLayer()};n.createRewardedVideoAd("dailysign",function(){n.setItemByLocalStorage("TodaySignVideoDate",new Date),n.setItemByLocalStorage("SignVideoSigned",!0),D.commonState.userGameInfo.todayCanSign?(D.commonState.userGameInfo.todayCanSign=!1,n.requestSignIn(D.commonState.userGameInfo.signNum+1,function(o){t.reward(o,e),i()})):(o.sysMessage("\u606d\u559c\u83b7\u5f97, "+e+"\u661f\u661f!"),i()),t.btnShareDouble.node.stopAllActions(),t.setDoubleVisible(!1)})}},reward:function(e,t){try{var i=D.commonState.userGameInfo.signNum,a=this.sprSignIn.node.children[i];a&&(2==i?this.signDay3(a,2):6==i?this.signDay7(a,2):this.signNormal(a,2))}catch(e){}D.commonState.userGameInfo.signNum=D.commonState.userGameInfo.signNum+1,this.onAwardCoinSound(),console.log("sign get award ...."),console.log(e),!this.isSignedDay3&&e.items&&e.items.length>0?(e.items[0].id==ItemConst.SignHeroGas?o.sysMessage("\u606d\u559c\u60a8\u83b7\u5f97\u98de\u673a\u62d6\u5c3e\uff01"):e.items[0].id==ItemConst.SignNewPlane&&(o.sysMessage("\u606d\u559c\u60a8\u83b7\u5f97\u5c0f\u98de\u673a\uff01"),D.commonState.heroList=null,n.requestHeroList(function(e){})),n.requestItemList(function(e){},!0)):(D.commonState.userGameInfo.coin+=t,o.sysMessage("\u606d\u559c\u83b7\u5f97, "+t+"\u661f\u661f!"))},setCallback:function(e){this.callback=e},closeLayer:function(){o.removePopUpLayer(this),this.callback&&this.callback()}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",common:"common",sceneManager:"sceneManager"}],dailyTaskItem:[function(e,t,i){"use strict";cc._RF.push(t,"b3a3fmB8s9Mr4EfgmTfnqGG","dailyTaskItem");var o=e("common"),n=e("taskUtils");cc.Class({extends:cc.Component,properties:{node_award:cc.Node,spr_icon:cc.Sprite,lab_num:cc.Label,rtx_desc:cc.RichText,btn_go:cc.Button,btn_receive:cc.Button,btnSound:{default:null,type:cc.AudioClip}},onLoad:function(){},start:function(){Notification.on("task_update_state",this.updateTaskState,this)},onDestroy:function(){Notification.off("task_update_state",this.updateTaskState)},initWithData:function(e){var t=o.getJsonCfgByID("task",e.taskId);this.curConfig=t;var i=t.coin>0?t.coin:t.qzb;if(this.lab_num.string="x"+i,0==t.coin){var a=this;cc.loader.loadRes("game/icon_item_qzb",cc.SpriteFrame,function(e,t){a.spr_icon.spriteFrame=t})}var c=12;t.coin>0&&t.qzb>0&&(c=8,this.addNewAward());var s=t.name.replace("{need}","@");s="<color=#feffff>"+(s=(s=this.insertFlg(s,"\n",c-1)).replace("@",t.need))+"</c></c><color=#ffe760>(@1/@2)</color>";var r=e.currNum>t.need?t.need:e.currNum,l=t.need;t.kind==n.TaskType.FLY_KM&&(r+="KM",l+="KM"),s=(s=s.replace("@1",r)).replace("@2",l),this.rtx_desc.string=s;e.currNum,this.curConfig.need;1==e.isComplete?(this.btn_receive.node.active=!0,this.btn_go.node.active=!1,1==e.isReceive&&(this.btn_receive.interactable=!1)):(this.btn_receive.node.active=!1,this.btn_go.node.active=!0)},addNewAward:function(){var e=this.node.getChildByName("newAwardTag");if(!e){(e=cc.instantiate(this.node_award)).name="newAwardTag",this.node.addChild(e);var t=this.node_award.width+5;e.x=this.node_award.x+t,this.rtx_desc.node.x=this.rtx_desc.node.x+t,cc.loader.loadRes("game/icon_item_qzb",cc.SpriteFrame,function(t,i){var o=e.getChildByName("spr_icon");o&&(o.getComponent(cc.Sprite).spriteFrame=i)})}var i=e.getChildByName("lab_num");i&&(i.getComponent(cc.Label).string="x"+this.curConfig.qzb)},insertFlg:function(e,t,i){return e.substring(0,i)+t+e.substring(i,e.length)},onBtnReceive:function(){this.onBtnSound();n.requestTaskReceive(this.curConfig.id,function(e){o.receiveAward(e.award),n.updateTaskList(e.taskId,e.next)})},onBtnGo:function(){this.onBtnSound();var e="";switch(this.curConfig.kind){case n.TaskType.COIN:case n.TaskType.FLY_KM:case n.TaskType.BATTLE_NUM:e="battle";break;case n.TaskType.INVITE_SUC:e="invite";break;case n.TaskType.UPGRADE_COST:e="upgrade"}""!=e&&this.mainScript.handlerBtnGo(e)},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},updateTaskState:function(e){this.curConfig.id==e.oldId&&this.initWithData(e.info)}}),cc._RF.pop()},{common:"common",taskUtils:"taskUtils"}],dailyTask:[function(e,t,i){"use strict";cc._RF.push(t,"17d54JqswxH9pevKyJlepop","dailyTask");var o=e("common"),n=e("taskUtils"),a=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{scroll_task:cc.ScrollView,itemPrefab:cc.Prefab,btn_close:cc.Button,btnSound:{default:null,type:cc.AudioClip}},onLoad:function(){this.scroll_task.bounceDuration=.5,this.initList()},start:function(){this.btn_close.node.getComponent(cc.Widget);a.createBannerAd(!0)},setCallback:function(e,t){this.callbackToGo=e,this.closeCallback=t},initList:function(){var e=-55,t=this;n.requestTaskList(function(i){var o=t.scroll_task.content;i.forEach(function(i,n){var a=cc.instantiate(t.itemPrefab);o.addChild(a);var c=a.getComponent("dailyTaskItem");c&&(c.initWithData(i,n),c.mainScript=t),a.y=e,e-=14,e-=a.height}),o.height=110*i.length+14*(i.length-1)})},onBtnClose:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound),this.closeCallback&&this.closeCallback(),o.removePopUpLayer(this)},handlerBtnGo:function(e){this.callbackToGo&&this.callbackToGo(e)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",taskUtils:"taskUtils"}],effGroup:[function(e,t,i){"use strict";cc._RF.push(t,"02e69b6dN5CNqX82SuQ+Hlt","effGroup");var o=e("pool"),n=(e("common"),cc.Class({name:"gameEffG",properties:{name:"",prefab:cc.Prefab,size:0}}));cc.Class({extends:cc.Component,properties:{gameEffG:{default:[],type:n},mainScript:{default:null,type:e("main")}},onLoad:function(){o.initPoolBatch(this,this.gameEffG)},startAction:function(){},showReadyView:function(e,t){var i=this.gameEffG[0],o=cc.instantiate(i.prefab);this.node.addChild(o),o.setPosition(cc.v2(0,0));var n=this,a=o.getChildByName("ready").getComponent(cc.Animation),c=o.getChildByName("go").getComponent(cc.Animation);c.node.active=!1;var s=function(){a.node.active=!1,c.node.active=!1,n.node.removeChild(o),e&&e.apply(t)};a.play("readygo"),a.on("finished",function(){a.node.active=!1,c.node.active=!0,c.play("go"),c.on("finished",s,this)},this)},showWarningView:function(e,t){var i=this.gameEffG[1],o=cc.instantiate(i.prefab);this.node.addChild(o),o.setPosition(cc.v2(0,0));var n=this,a=o.getComponent(cc.Sprite),c=cc.fadeIn(.3),s=cc.fadeOut(.5),r=cc.repeat(cc.sequence(c,s),3);a.node.runAction(cc.sequence(r,cc.callFunc(function(){n.node.removeChild(o),e&&e.apply(t)})))},showGameMissileView:function(e,t){var i=this.gameEffG[2],o=cc.instantiate(i.prefab);this.node.addChild(o),o.setPosition(cc.v2(0,200));var n=o.getChildByName("gameeff_missile_warning_light").getComponent(cc.Sprite),a=this,c=cc.fadeIn(.3),s=cc.fadeOut(.5),r=cc.repeat(cc.sequence(c,s),3);n.node.runAction(cc.sequence(r,cc.callFunc(function(){a.node.removeChild(o),e&&e.apply(t)})))},showMissilePreView:function(e,t,i,o){var n=this.gameEffG[3],a=cc.instantiate(n.prefab);this.node.addChild(a),a.setPosition(cc.v2(cc.winSize.width*Math.random(),t));var c=a.getChildByName("gameeff_missile_warning_pre_flag").getComponent(cc.Sprite),s=this,r=cc.fadeIn(.3),l=cc.fadeOut(.5),d=cc.repeat(cc.sequence(r,l),3);c.node.runAction(cc.sequence(d,cc.callFunc(function(){s.node.removeChild(a),i&&i.apply(o)})));var u=cc.moveTo(.5,cc.v2(e,t));a.runAction(u)},showBeHurtEffView:function(e,t){if(!this.isPlayingBeHurtEff){this.isPlayingBeHurtEff=!0;var i=this.gameEffG[4],o=cc.instantiate(i.prefab);this.node.addChild(o),o.setPosition(cc.v2(0,0));var n=this,a=o.getComponent(cc.Animation);a.play("alphe_once"),a.on("finished",function(){n.node.removeChild(o),n.isPlayingBeHurtEff=!1,e&&e.apply(t)},this)}},showBigBoom:function(e,t){var i=this.gameEffG[5],o=cc.instantiate(i.prefab);this.node.addChild(o),o.setPosition(cc.v2(0,0));for(var n=1;n<=4;n++){var a=o.getChildByName("anim"+n);if(a)a.getComponent(cc.ParticleSystem).stopSystem()}var c=this;o.idx=1;var s=function(){var e="anim"+o.idx,t=o.getChildByName(e);t&&t.getComponent(cc.ParticleSystem).resetSystem();o.idx=o.idx+1},r=cc.callFunc(s,this),l=cc.delayTime(.1),d=cc.callFunc(s,this),u=cc.delayTime(.1),h=cc.callFunc(s,this),m=cc.delayTime(.1),p=cc.callFunc(s,this),f=cc.delayTime(.2),g=cc.callFunc(function(){o.stopAllActions(),c.node.removeChild(o),e&&e.apply(t)},this);o.runAction(cc.sequence(r,l,d,u,h,m,p,f,g))},getItemTips:function(e,t,i,o){var n=this.gameEffG[6],a=cc.instantiate(n.prefab);e.addChild(a),a.setPosition(cc.v2(0,25)),a.active=!1,a.zIndex=99;var c=this,s=function(){e.removeChild(a),i&&i.apply(o)},r="items/tips_"+t;cc.loader.loadRes(r,cc.SpriteFrame,function(e,t){a.active=!0,a.getComponent(cc.Sprite).spriteFrame=t;var i=a.getComponent(cc.Animation);i.on("finished",s,c),i.play("get_item_tips")})},heroDieEff:function(e,t,i){var o=this.gameEffG[7],n=cc.instantiate(o.prefab);this.node.addChild(n),n.setPosition(i.position),n.idx=1;for(var a=1;a<=4;a++){var c=n.getChildByName("anim"+a);c&&(c.active=!1)}var s=this,r=function(){s.node.removeChild(n),e&&e.apply(t)},l=function(){var e="anim"+n.idx,t=n.getChildByName(e);if(t){t.active=!0;var i=t.getComponent(cc.Animation);i.play("hero_die"),3==n.idx&&i.on("finished",r,s)}n.idx=n.idx+1},d=cc.callFunc(l,this),u=cc.delayTime(.25),h=cc.callFunc(l,this),m=cc.delayTime(.25),p=cc.callFunc(l,this),f=cc.delayTime(.15),g=cc.callFunc(function(){i.active=!1},this);n.runAction(cc.sequence(d,u,h,m,p,f,g))},starEff:function(e,t,i){var o=this.gameEffG[8],n=cc.instantiate(o.prefab);n.name="starEffTag",e.addChild(n);var a=n.getComponent(cc.Animation);a.on("finished",function(){e.removeChild(n),t&&t.apply(i)},this),a.play("starEff")},gameOver:function(){this.node.stopAllActions()},gamePause:function(){this.node.pauseAllActions()},gameResume:function(){this.node.resumeAllActions()},destroyUfo:function(e){o.returnNode(this,e)}}),cc._RF.pop()},{common:"common",main:"main",pool:"pool"}],enemyGroup:[function(e,t,i){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}cc._RF.push(t,"11f27pfJodDE6qxzKgoFqaj","enemyGroup");var n=e("pool"),a=e("common"),c=e("PlatformUtils"),s=cc.Class({name:"enemyG",properties:{name:"",prefab:cc.Prefab,freq:0,size:0}});cc.Class({extends:cc.Component,properties:{enemyGroup:{default:[],type:s},mainScript:{default:null,type:e("main")},mainLevel:1,mainLineGamePlaying:!1,currlevel:1,nextOrderNum:0,enemyCount:0,randomAry:[],randomIdx:0,bossCount:0,makeMissileNumAry:[],needShowMissileWarning:!0,maxTotleLvl:0,currCoundNum:0,perDis:80},onLoad:function(){n.initPoolBatch(this,this.enemyGroup),this.randomAry=[1,2,3,4];var e=a.getJsonCfgs("levels_All");this.maxTotleLvl=e.length},startAction:function(){Notification.on("boss_die_event",this.bossDieHandler,this),Notification.on("level_Reward_Ani_Finish_event",this.rewardFinishHandler,this),this.bossCount=0,this.mainLevel=1,this.mainLineGamePlaying=!0,this.currlevel=this.mainLevel,this.currCoundNum=this.mainLevel,this.updateNext(1)},updateNext:function(e){if(!(e<=0)){this.mainScript.updateLevelInfo(this.currlevel+"-"+e,e);for(var t,i=a.getJsonCfgs("level_"+this.currlevel),o=0;o<i.length;o++)if((t=i[o]).orderNum==e){this.updateMakeEnemyTime(t),this.checkGuide(t);break}}},checkGuide:function(e){2==e.id&&22==e.orderNum&&this.mainScript.guideItem(1)},randomsort:function(e,t){return Math.random()>.5?-1:1},updateMakeEnemyTime:function(e){var t=e.enemyID,i=e.route,o=e.num,n=e.delayTime,c=e.speed,s=e.ballistic,r=e.boomNum;r||(r="0");var l=r.split(","),d=0;if(1==l.length)d=Number(l[0]);else{var u=Number(l[0]),h=Number(l[1]);d=u+Math.ceil(Math.random()*Math.abs(h-u))}d>0&&(this.makeMissileNumAry.push(d),this.checkShowWarningPreView()),this.randomAry.sort(this.randomsort);var m=e.drop,p=(m+="").split(","),f=(i+="").split(","),g=1,v=a.getJsonCfgByID("enemy",t);function y(){var e=0;if(1==p.length)e=Number(p[0]);else for(var i=0;i<p.length;i++){if((n=p[i].split("#"))[0]==g){e=n[1];break}}var o=0;if(1==f.length)o=Number(f[0]);else for(i=0;i<f.length;i++){var n;if((n=f[i].split("#"))[0]==g){o=n[1];break}}if(3==v.type&&this.bossCount<=0){var a={};a.enemyInfo=this.enemyGroup[t-1],a.enemyCfg=v,a.routeType=o,a.dropID=e,a.ballistic=s,this.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(this.delayMakeNewEnemy,this,a))),this.mainScript.showWarningView()}else 1==f.length&&o>1e3?this.lineupUpdateMake(o,s):this.makeNewEnemy(this.enemyGroup[t-1],v,o,e,s);g++}1==f.length&&Number(f[0])>1e3&&(o=1);for(var b=0;b<o;b++){var S=cc.delayTime(b*n),_=cc.callFunc(y,this);this.node.runAction(cc.sequence(S,_))}if(c<0)this.nextOrderNum=e.nextOrderNum;else{this.nextOrderNum=-1;var B=cc.delayTime(c),C=cc.callFunc(function(t){e.nextOrderNum>0&&this.updateNext(e.nextOrderNum)},this);this.node.runAction(cc.sequence(B,C))}},lineupUpdateMake:function(e,t){var i=a.getJsonCfgs("lineup_"+e);if(i&&!(i.length<=0)){for(var o=i.length,n=1e3,c=function(e){var t=e.split("#"),i=0;if((i=(t.length,Number(t[0])))>0){var o=a.getJsonCfgByID("enemy",i);n>o.runspeed&&(n=o.runspeed)}},s=o-1;s>=0;s--){c((r=i[s]).enemy1),c(r.enemy2),c(r.enemy3),c(r.enemy4),c(r.enemy5),c(r.enemy6),c(r.enemy7)}for(s=o-1;s>=0;s--){var r=i[s];this.handlerLineupItem(1,r.enemy1,t,o-s,n),this.handlerLineupItem(2,r.enemy2,t,o-s,n),this.handlerLineupItem(3,r.enemy3,t,o-s,n),this.handlerLineupItem(4,r.enemy4,t,o-s,n),this.handlerLineupItem(5,r.enemy5,t,o-s,n),this.handlerLineupItem(6,r.enemy6,t,o-s,n),this.handlerLineupItem(7,r.enemy7,t,o-s,n)}}},handlerLineupItem:function(e,t,i,o,n){var a=0,c=0,s=t.split("#");1==s.length?a=Number(s[0]):(a=Number(s[0]),c=Number(s[1])),a>0&&this.makeLineupByXY(e,a,c,i,o,n)},makeLineupByXY:function(e,t,i,o,n,c){var s=.5*-cc.winSize.width+50,r=cc.winSize.height,l=a.getJsonCfgByID("enemy",t),d=this.enemyGroup[t-1],u=this.makeNewEnemy(d,l,1e3,i,o,c);u.node.x=s+this.perDis*e,u.node.y=r+this.perDis*n},checkShowWarningPreView:function(){if(this.makeMissileNumAry.length>0){var e=this.makeMissileNumAry.shift();this.showWarningPreView(e)}},showWarningPreView:function(e){var t=D.gameHeroPx,i=0;e%2==0&&(i=-55);for(var o=0;o<e;o++){var n=t+130*Math.ceil(o/2)*(1==Math.floor(o%2)?1:-1);this.mainScript.showMissileView(o,n+i,.5*cc.winSize.height-50,this.needShowMissileWarning),this.needShowMissileWarning=!1}},bossDieHandler:function(){this.bossCount--,this.bossCount<=0&&(D.gameBossAttacking=!1,this.nextOrderNum<=0?(this.mainScript.hideKillBossTime(),this.mainScript.removeAllBullet(),this.notifyKillAllBoss(),Notification.emit("level_over_event",{lvl:this.currlevel})):this.updateNext(this.nextOrderNum))},notifyKillAllBoss:function(){this.mainScript.levelPass()},notifyLevelOver:function(){Notification.emit("level_over_event",{lvl:this.currlevel})},rewardFinishHandler:function(){var e=-1;if(this.mainLineGamePlaying){this.mainLineGamePlaying=!1;var t=a.getJsonCfgByID("levels_All",this.mainLevel);if(t){var i=Number(t.RateOrderNum),o=Number(t.RateNextNum);i>0&&100*Math.random()<i?e=Number(t.orderNum):o>0&&100*Math.random()<o?e=Number(t.nextNum):(this.needShowMissileWarning=!0,this.mainLevel++,e=this.mainLevel,this.mainLineGamePlaying=!0)}}else this.needShowMissileWarning=!0,this.mainLevel++,e=this.mainLevel,this.mainLineGamePlaying=!0;if(!(e<0)){e<1e4&&(this.mainLevel=e),this.mainLevel>this.maxTotleLvl&&(this.mainLevel=1),this.currCoundNum++,this.currlevel=e,this.updateNext(1),Notification.emit("level_begin_event");var n=c.getItemByLocalStorage("PassedMaxLevel",0);this.mainLevel-1>n&&(c.setItemByLocalStorage("PassedMaxLevel",this.mainLevel-1),console.log("------ next level, this.mainLevel - 1,preMax",this.mainLevel-1,n))}},gameOver:function(){this.node.stopAllActions();for(var e=new(Function.prototype.bind.apply(Array,[null].concat(o(this.node.children)))),t=0;t<e.length;t++)e[t].getComponent("enemy").gamePause();Notification.off("boss_die_event",this.bossDieHandler),Notification.off("level_Reward_Ani_Finish_event",this.rewardFinishHandler)},gamePause:function(){this.node.pauseAllActions();for(var e=new(Function.prototype.bind.apply(Array,[null].concat(o(this.node.children)))),t=0;t<e.length;t++)e[t].getComponent("enemy").gamePause()},gameResume:function(){this.node.resumeAllActions();for(var e=new(Function.prototype.bind.apply(Array,[null].concat(o(this.node.children)))),t=0;t<e.length;t++)e[t].getComponent("enemy").gameResume()},delayMakeNewEnemy:function(e,t){var i=t.enemyInfo,o=t.enemyCfg,n=t.routeType,a=t.dropID,c=t.ballistic;e.getComponent("enemyGroup").makeNewEnemy(i,o,n,a,c)},makeNewEnemy:function(e,t,i,o,a,c){if(e){var s=e.name+"Pool",r=n.borrowNewNode(this[s],e.prefab,this.node),l=this.getPositionOfNewEnemy(r,i);r.setPosition(l);var d=r.getComponent("enemy");d.enemyGroup=this,d.dropID=o,d.ballistic=a;var u=t.initPower+(this.currCoundNum-1)*t.powerRadix,h=t.initAttackSpeed,m=t.initBlood+t.initBlood*(this.currlevel-1)*this.currlevel/2,p=t.initArmor;return d.enemyType=t.type,d.score=t.rewardPoint,d.limitStr=t.limitAry,d.enemyCfgID=t.id,c||(c=t.runspeed),d.runspeed=c,3==d.enemyType&&(this.mainScript.showKillBossTime(),this.bossCount++,this.bossCount>0&&(D.gameBossAttacking=!0)),d.currlevel=this.currlevel,d.enemyInit(u,h,m,p,i,l.x,l.y),d}},getPositionOfNewEnemy:function(e,t){var i=0,o=cc.winSize.height/2+e.height/2;if(0==t){var n=this.randomAry[this.randomIdx];i=-this.node.parent.width/2+n*(this.node.parent.width-100-e.width)/8,this.randomIdx++,this.randomIdx>this.randomAry.length&&(this.randomIdx=0)}else if(1==t){i=100+this.randomAry[this.randomIdx]*((this.node.parent.width-100-e.width)/8-20),this.randomIdx++,this.randomIdx>this.randomAry.length&&(this.randomIdx=0)}else if(2==t){i=50*this.randomAry[this.randomIdx]-100,this.randomIdx++,this.randomIdx>this.randomAry.length&&(this.randomIdx=0)}else 3==t?(i=.5*-cc.winSize.width-100,o=100):4==t?(i=.5*cc.winSize.width+100,o=100):5==t?(i=this.node.parent.width/2,o=1*this.node.parent.height/3):6==t&&(i=-this.node.parent.width/2,o=1*this.node.parent.height/3);return cc.v2(i,o)},destroyEnemy:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n.returnNode(this,e),t&&this.mainScript.changeScore(t)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",main:"main",pool:"pool"}],"enemybullet ":[function(e,t,i){"use strict";cc._RF.push(t,"8fc0dH5Gx5JFobyrbxL/3HO","enemybullet "),cc.Class({extends:cc.Component,properties:{speed:cc.Integer,rationNum:0,owner:1},setIsPlayer:function(e){this.owner=e?1:2},onLoad:function(){},onCollisionEnter:function(e,t){this.bulletGroup.destroyBullet(t.node)},update:function(e){this.node.y+=e*this.speed,this.node.y>this.node.parent.height&&this.bulletGroup.destroyBullet(this.node)}}),cc._RF.pop()},{}],enemy:[function(e,t,i){"use strict";cc._RF.push(t,"32e26kzmGlK4odAEOcH4Z7A","enemy");var o=cc.Class({name:"EnemybulletPosition",properties:{positionX:{default:""},positionY:{default:""}}});cc.Class({extends:cc.Component,properties:{score:{default:0,type:cc.Integer,tooltip:"\u654c\u673a\u5206\u6570"},initSpriteFrame:{default:null,type:cc.SpriteFrame,tooltip:"\u521d\u59cb\u5316\u56fe\u50cf"},explosionSound:{default:null,type:cc.AudioClip},beAttackedSound:{default:null,type:cc.AudioClip},bossAttackedSound:{default:null,type:cc.AudioClip},hpBar:{default:null,type:cc.ProgressBar,tooltip:"\u8840\u91cf\u6761"},position:{default:[],type:o,tooltip:"\u5b50\u5f39\u4f4d\u7f6e"},armorNum:0,attackNum:0,circleCenterX:0,circleCenterY:0,routeType:0,rationNumCount:90,dropID:0,enemyType:1,ballistic:"0",_timer:0,rewardPoint:0,limitStr:"",enemyCfgID:0,gas:cc.Node,bossBoom:cc.Animation,bossBoomIdx:0,runspeed:180,currlevel:1,bossOuting:!1},onLoad:function(){cc.director.getCollisionManager().enabled=!0},checkBossShoot:function(){9==this.enemyCfgID?this.boss9AttackHandlerNew():10==this.enemyCfgID?this.boss10AttackHandlerNew():11==this.enemyCfgID?this.boss11AttackHandlerNew():12==this.enemyCfgID?this.boss12AttackHandler():this.boss13AttackHandler()},checkNeedShoot:function(){if(this.node.y<.5*cc.winSize.height){var e=cc.delayTime(.5),t=cc.callFunc(this.sendBullet,this),i=cc.sequence(e,t);this.node.runAction(i)}else{var o=cc.delayTime(.5),n=cc.callFunc(this.checkNeedShoot,this);i=cc.sequence(o,n);this.node.runAction(i)}},enemyInit:function(e,t,i,o,n,a,c){if(this.node){this.bossOuting=!1,this._timer=0,this.rationNumCount=90,this.HP=i,this.enemyHp=this.HP,this.routeType=n,this.attackNum=e,this.armorNum=o,this.circleCenterX=a,this.circleCenterY=c,this.gas&&(this.gas.active=!0),this.node.enemyType=this.enemyType;var s=this.node.getComponent(cc.Sprite);s.spriteFrame!=this.initSpriteFrame&&(s.spriteFrame=this.initSpriteFrame),this.hpBar.progress=1,this.hpBar.node.active=!1,this.node.opacity=0;var r=cc.fadeIn(.3);this.node.runAction(r);var l=this.node.getComponent(cc.PolygonCollider);if(l&&(l.enabled=!0),3==this.enemyType)return this.bossRoadFun(this.checkBossShoot,this),this.bossBoom.node.active=!1,void(this.bossBoomIdx=0);if(this.routeType<=2){this.node.rotation=180;var d=cc.winSize.height/this.runspeed,u=cc.moveTo(d,cc.v2(this.node.x,-cc.winSize.height/2-this.node.height)),h=cc.delayTime(d),m=this,p=cc.callFunc(function(){m.forceRemove()},this);this.node.runAction(cc.sequence(u,h,p))}var f=this.ballistic.split(",");if(1==f.length)if(Number(f[0])<=0)return;this.checkNeedShoot(),this.node.setScale(1)}},onCollisionEnter:function(e,t){if(!(this.enemyHp<=0||this.bossOuting)){if("hero"==e.node.group){var i=e.node.getComponent("hero"),o=Math.ceil(i.attackNum*i.attackNum/(i.attackNum+5*this.armorNum));return this.updateHp(-o),void Notification.emit("enemy_onCollision_hero",{attackNum:this.attackNum})}if("bullet"==e.node.group||"jiguang"==e.node.group){var n=e.node.getComponent("bullet");if(n.isPlayerBullet()){if(n.isJiGuamg)return this.enemyHp=0,void this.checkLife();var a=Math.ceil(n.attackNum*n.attackNum/(n.attackNum+5*this.armorNum));this.updateHp(-a),!D.isVoideClose&&this.isLife()&&n.needPlaySound&&cc.audioEngine.play(this.beAttackedSound)}}}},tntBombHandler:function(){var e=this.enemyHp;3==this.enemyType&&(e=.1*this.enemyHp),this.updateHp(-e)},updateHp:function(e){this.enemyHp+=e,this.enemyHp<0?this.enemyHp=0:9==this.enemyCfgID?this.boss9AttackHandlerNew():10==this.enemyCfgID?this.boss10AttackHandlerNew():11==this.enemyCfgID&&this.boss11AttackHandlerNew(),this.hpBar.progress=this.enemyHp/this.HP,this.hpBar.node.active=!0,this.hpBar.node.getNumberOfRunningActions()<=0&&this.hpBar.node.runAction(cc.blink(1,2)),this.checkLife()},checkLife:function(){if(this.enemyHp<=0)return this.hpBar.node.active=!1,this.gas&&(this.gas.active=!1),void this.explodingAnim()},isLife:function(){return this.enemyHp>0},isInWinsize:function(){return!(this.node.y<=-cc.winSize.height/2||this.node.y>=cc.winSize.height/2||this.node.x>=cc.winSize.width/2||this.node.x<=-cc.winSize.width/2)},explodingAnim:function(){D.isVoideClose||cc.audioEngine.play(this.explosionSound);var e=this,t=function(t){var i=e.getComponent(cc.Animation);i.play(t),i.on("finished",e.onHandleDestroy,e)};if(1==this.enemyType)t("enemy_die_exploding");else if(2==this.enemyType)t("enemy_die_middle");else if(3==this.enemyType){var i=function(){var t=this.node.parent.getChildByName("bossBoomAnim");t&&(t.stopAllActions(),e.node.removeChild(t)),e.onHandleDestroy()},o=cc.delayTime(.2),n=cc.callFunc(function(){e.bossBoomIdx+=1;var t=e.node.getChildByName("nodeBooms"),o="boom"+e.bossBoomIdx,n=t.getChildByName(o);n?e.bossBoom.node.position=n.position:(e.bossBoom.node.stopAllActions(),e.bossBoom.node.active=!1,cc.loader.loadRes("prefabs/bossBoom",function(t,o){var n=cc.instantiate(o.data);e.node.parent.addChild(n),n.position=e.node.position,n.name="bossBoomAnim",n.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(i,e)))}))},e);this.bossBoom.node.active=!0,this.bossBoom.play(),this.node.stopAllActions(),this.gas.active=!1;var a=cc.repeatForever(cc.sequence(o,n));this.bossBoom.node.runAction(a),Notification.emit("stop_bullet_event"),this.enemyGroup.mainScript.removeAllBullet()}var c=this.node.getComponent(cc.PolygonCollider);(c&&(c.enabled=!1),this.dropID<=0&&3!=this.enemyType)&&(this.enemyGroup.mainScript.ufoGroup.giftDrop(this.node.x,this.node.y)||3!=this.enemyCfgID&&8!=this.enemyCfgID||this.enemyGroup.mainScript.dropRedPacket(this.node.x,this.node.y))},update:function(e){D.gameStatuePause||3!=this.enemyType&&(1e3==this.routeType?this.lineRoadFun(e):this.routeType<=2||(this.routeType<=4?this.circleRoadFun(e,4==this.routeType):this.routeType<=6&&this.obliqueRoadFun(e,6==this.routeType)))},bossRoadFun:function(e,t){this.node.rotation=180,this.bossOuting=!0,this.node.x=0,this.node.y=cc.winSize.height;var i=this.node.parent.height/4,o=cc.moveTo(2,cc.v2(0,i)),n=this;cc.moveTo(1,cc.v2(0,i+100));this.node.runAction(cc.sequence(o,cc.callFunc(function(){e&&e.apply(t),n.bossOuting=!1})))},lineRoadFun:function(e){var t=this.node.x,i=this.node.y-e*this.runspeed*this.enemyGroup.mainScript.gameSpeed,o=JsUnit.getVectorRadians(this.node.x,this.node.y,t,i);this.node.rotation=o,this.node.x=t,this.node.y=i,this._timer+=1,this.node.y<-this.node.parent.height/2&&this.forceRemove()},circleRoadFun:function(e,t){var i=500;t?this.rationNumCount+=1*e:this.rationNumCount-=1*e;var o=Math.cos(this.rationNumCount)*i+this.circleCenterX,n=Math.sin(this.rationNumCount)*i+this.circleCenterY,a=JsUnit.getVectorRadians(this.node.x,this.node.y,o,n);this.node.rotation=a,this.node.x=o,this.node.y=n,t?this.node.x>this.circleCenterX+250&&this.forceRemove():this.node.x<this.circleCenterX-250&&this.forceRemove()},obliqueRoadFun:function(e,t){var i=0,o=this.node.y-e*this.runspeed*this.enemyGroup.mainScript.gameSpeed;i=t?this.node.x+e*this.runspeed*.5*this.enemyGroup.mainScript.gameSpeed:this.node.x-e*this.runspeed*.5*this.enemyGroup.mainScript.gameSpeed;var n=JsUnit.getVectorRadians(this.node.x,this.node.y,i,o);this.node.rotation=n,this.node.x=i,this.node.y=o,this.node.y<-this.node.parent.height/2&&this.forceRemove()},forceRemove:function(e){this.node.stopAllActions(),e?this.enemyGroup.destroyEnemy(this.node,e):this.enemyGroup.destroyEnemy(this.node)},sendBullet:function(){if(this.node){var e=this.ballistic.split(",");if(1==e.length){var t=Number(e[0]);t>0&&this.sendBullet2(t)}else for(var i=0;i<e.length;i++){var o=Number(e[i]);o>0&&this.sendBullet2(o)}}},sendBullet2:function(e){if(1==e)if(this.routeType>2){var t=JsUnit.getVectorRadians(this.node.x,this.node.y,D.gameHeroPx,D.gameHeroPy);this.sendEvent(t,0,0,this.speed)}else this.sendEvent(this.node.rotation,0,0,this.speed);else if(2==e)if(this.routeType>2){var i=JsUnit.getVectorRadians(this.node.x,this.node.y,D.gameHeroPx,D.gameHeroPy);this.bossAttackType3ByAngle(i,this.speed)}else this.bossAttackType3ByAngle(this.node.rotation,this.speed)},boss9AttackHandler:function(){var e=this.node.parent.height/4,t=cc.moveTo(2,cc.v2(0,e)),i=cc.moveTo(1,cc.v2(0,e+100));this.node.runAction(new cc.RepeatForever(cc.sequence(t,i)));var o=this,n=!1,a=function(){var e=cc.v2(Number(o.position[1].positionX),Number(o.position[1].positionY));n||(e=cc.v2(Number(o.position[2].positionX),Number(o.position[2].positionY))),o.sendEvent(o.node.rotation-15,e.x,e.y,450),o.sendEvent(o.node.rotation,e.x,e.y,450),o.sendEvent(o.node.rotation+15,e.x,e.y,450),n=!n},c=180,s=function(){o.sendEvent(c,0,0,300),c+=13};if(2==this.currlevel){var r=cc.repeatForever(cc.sequence(cc.callFunc(s),cc.delayTime(.03)));this.node.runAction(r)}else{var l=cc.repeatForever(cc.sequence(cc.delayTime(2),cc.callFunc(a),cc.delayTime(2),cc.callFunc(a)));this.node.runAction(l);r=cc.repeatForever(cc.sequence(cc.callFunc(s),cc.delayTime(.02)));this.node.runAction(r)}},boss9AttackHandlerNew:function(){var e=this;this.playingStepAttack||(this.playingStepAttack=-1);var t=1,i=this.enemyHp/this.HP*100;i>80?t=1:i>60?t=2:i>40?t=3:i>0&&(t=4),this.playingStepAttack!=t&&(this.playingStepAttack=t,this.node.stopAllActions(),2==this.playingStepAttack?function(){e.node.x;var t=e.node.y,i=cc.moveTo(1,cc.v2(0,t)),o=cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(function(){var t=cc.v2(Number(e.position[0].positionX),Number(e.position[0].positionY)),i=JsUnit.getVectorRadians(e.node.x+t.x,e.node.y+t.y,D.gameHeroPx,D.gameHeroPy);e.sendEvent(i-30,t.x,t.y,450),e.sendEvent(i-20,t.x,t.y,450),e.sendEvent(i-10,t.x,t.y,450),e.sendEvent(i,t.x,t.y,450),e.sendEvent(i+10,t.x,t.y,450),e.sendEvent(i+20,t.x,t.y,450),e.sendEvent(i+30,t.x,t.y,450)})));e.node.runAction(cc.sequence(i,cc.callFunc(function(){e.node.runAction(o)})))}():3==this.playingStepAttack?function(){e.node.x;var t=e.node.y,i=cc.moveTo(.5,cc.v2(-200,t)),o=cc.moveTo(.5,cc.v2(200,t)),n=cc.moveTo(1,cc.v2(0,t)),a=function(){var t=cc.v2(Number(e.position[1].positionX),Number(e.position[1].positionY)),i=cc.v2(Number(e.position[2].positionX),Number(e.position[2].positionY));e.bossAttackType2(t,i)},c=cc.repeatForever(cc.sequence(i,cc.callFunc(a),cc.delayTime(1),o,cc.callFunc(a),cc.delayTime(1),n,cc.callFunc(function(){var t=cc.v2(Number(e.position[0].positionX),Number(e.position[0].positionY)),i=JsUnit.getVectorRadians(e.node.x+t.x,e.node.y+t.y,D.gameHeroPx,D.gameHeroPy);e.sendEvent(i-30,t.x,t.y,450),e.sendEvent(i-20,t.x,t.y,450),e.sendEvent(i-10,t.x,t.y,450),e.sendEvent(i,t.x,t.y,450),e.sendEvent(i+10,t.x,t.y,450),e.sendEvent(i+20,t.x,t.y,450),e.sendEvent(i+30,t.x,t.y,450)}),cc.delayTime(1)));e.node.runAction(c)}():4==this.playingStepAttack?function(){e.node.x;var t=e.node.y,i=cc.moveTo(.5,cc.v2(-200,t)),o=cc.moveTo(.5,cc.v2(200,t)),n=cc.moveTo(1,cc.v2(0,t)),a=function(){var t=cc.v2(Number(e.position[1].positionX),Number(e.position[1].positionY)),i=cc.v2(Number(e.position[2].positionX),Number(e.position[2].positionY));e.bossAttackType2(t,i)},c=function(){var t=cc.v2(Number(e.position[0].positionX),Number(e.position[0].positionY)),i=JsUnit.getVectorRadians(e.node.x+t.x,e.node.y+t.y,D.gameHeroPx,D.gameHeroPy);e.sendEvent(i-30,t.x,t.y,450),e.sendEvent(i-20,t.x,t.y,450),e.sendEvent(i-10,t.x,t.y,450),e.sendEvent(i,t.x,t.y,450),e.sendEvent(i+10,t.x,t.y,450),e.sendEvent(i+20,t.x,t.y,450),e.sendEvent(i+30,t.x,t.y,450)},s=function(){e.bossAttackType3()},r=function(){e.bossAttackType3_1()},l=cc.repeatForever(cc.sequence(i,cc.callFunc(r),cc.delayTime(.5),cc.callFunc(s),cc.delayTime(1),o,cc.callFunc(r),cc.delayTime(.5),cc.callFunc(s),cc.delayTime(1),n,cc.callFunc(c),cc.delayTime(1),i,cc.callFunc(a),cc.delayTime(1),o,cc.callFunc(a),cc.delayTime(1),n,cc.callFunc(c),cc.delayTime(1)));e.node.runAction(l)}():function(){var t=e.node.x,i=e.node.y,o=cc.moveTo(2,cc.v2(t-200,i)),n=cc.moveTo(2,cc.v2(t+200,i));e.node.runAction(new cc.RepeatForever(cc.sequence(o,n)));var a=cc.repeatForever(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){var t=cc.v2(Number(e.position[1].positionX),Number(e.position[1].positionY));e.sendEvent(e.node.rotation,t.x,t.y,450);var i=cc.v2(Number(e.position[2].positionX),Number(e.position[2].positionY));e.sendEvent(e.node.rotation,i.x,i.y,450)})));e.node.runAction(a)}())},boss10AttackHandlerNew:function(){var e=this;this.playingStepAttack||(this.playingStepAttack=-1);var t=1,i=this.enemyHp/this.HP*100;i>80?t=1:i>40?t=2:i>0&&(t=3),this.playingStepAttack!=t&&(this.playingStepAttack=t,this.node.stopAllActions(),2==this.playingStepAttack?function(){e.node.x;var t=e.node.y,i=cc.moveTo(1.5,cc.v2(-200,t)),o=cc.moveTo(1.5,cc.v2(200,t)),n=function(){for(var t=0;t<8;t++)e.sendEvent(360*t/8,0,0,350)},a=function(){for(var t=0;t<8;t++)e.sendEvent(360*t/8,0,0,350,"enemybullet/bullet_small_6")},c=cc.repeatForever(cc.sequence(i,cc.delayTime(.2),cc.callFunc(n),cc.delayTime(.2),cc.callFunc(n),cc.delayTime(.2),cc.callFunc(n),cc.delayTime(.5),cc.callFunc(a),cc.delayTime(.5),o,cc.callFunc(n),cc.delayTime(.2),cc.callFunc(n),cc.delayTime(.2),cc.callFunc(n),cc.delayTime(.5),cc.callFunc(a),cc.delayTime(.5)));e.node.runAction(c)}():3==this.playingStepAttack?function(){e.node.x;var t=e.node.y,i=cc.moveTo(.5,cc.v2(0,t));e.node.runAction(i);var o=0,n=function(){for(var t=0;t<8;t++)e.sendEvent(o+360*t/8,0,0,450,"enemybullet/bullet_small_4");o+=5},a=function(){for(var t=0;t<8;t++)e.sendEvent(360*t/8,0,0,350,"enemybullet/bullet_small_4")},c=cc.repeatForever(cc.sequence(cc.delayTime(.3),cc.callFunc(n),cc.delayTime(.1),cc.callFunc(n),cc.delayTime(.1),cc.callFunc(n),cc.delayTime(.1),cc.callFunc(n),cc.delayTime(.1),cc.callFunc(n),cc.delayTime(.3),cc.callFunc(a),cc.delayTime(.2),cc.callFunc(a),cc.delayTime(.2),cc.callFunc(a),cc.delayTime(.3),cc.callFunc(a)));e.node.runAction(c)}():function(){var t=function(t,i){var o=65*Math.cos(2*Math.PI/360*i),n=65*Math.sin(2*Math.PI/360*i),a=20*Math.cos(2*Math.PI/360*i),c=20*Math.sin(2*Math.PI/360*i);a+=e.node.x,c+=e.node.y-300,e.sendEvent(i,o,n,650,null,-1,cc.v2(a,c))},i=cc.repeatForever(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){var t=cc.v2(0,0),i=JsUnit.getVectorRadians(e.node.x+t.x,e.node.y+t.y,D.gameHeroPx,D.gameHeroPy);e.sendEvent(i,t.x,t.y,450);var o=65*Math.cos(2*Math.PI/360*(i+90)),n=65*Math.sin(2*Math.PI/360*(i+90));e.sendEvent(i+10,t.x+n,t.y+o,450);var a=65*Math.cos(2*Math.PI/360*(i-90)),c=65*Math.sin(2*Math.PI/360*(i-90));e.sendEvent(i-10,t.x+c,t.y+a,450)}),cc.delayTime(.3),cc.callFunc(function(){for(var i=cc.v2(0,0),o=(JsUnit.getVectorRadians(e.node.x+i.x,e.node.y+i.y,D.gameHeroPx,D.gameHeroPy),0);o<8;o++)t(0,360*o/8)}),cc.delayTime(1)));e.node.runAction(i)}())},boss11AttackHandlerNew:function(){var e=this;this.playingStepAttack||(this.playingStepAttack=-1);var t=1,i=this.enemyHp/this.HP*100;i>65?t=1:i>30?t=2:i>0&&(t=3),this.playingStepAttack!=t&&(this.playingStepAttack=t,this.node.stopAllActions(),2==this.playingStepAttack?function(){var t=cc.winSize.height/4,i=cc.moveTo(2,cc.v2(0,t)),o=cc.moveTo(1,cc.v2(0,0)),n=cc.sequence(i,o);e.node.runAction(new cc.RepeatForever(n,n.reverse()));e.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){e.bossAttackType3(-1,"enemybullet/bullet_small_4")}))));var a=!1,c=function(){var t=cc.v2(Number(e.position[0].positionX),Number(e.position[0].positionY));a||(t=cc.v2(Number(e.position[1].positionX),Number(e.position[1].positionY))),e.sendEvent(e.node.rotation-15,t.x,t.y),e.sendEvent(e.node.rotation,t.x,t.y),e.sendEvent(e.node.rotation+15,t.x,t.y),a=!a},s=cc.repeatForever(cc.sequence(cc.delayTime(.1),cc.callFunc(c),cc.delayTime(1.5),cc.callFunc(c),cc.delayTime(3)));e.node.runAction(s)}():3==this.playingStepAttack?function(){var t=cc.winSize.height/4,i=cc.moveTo(.8,cc.v2(150,t)),o=cc.moveTo(.8,cc.v2(-150,t)),n=cc.moveTo(.8,cc.v2(0,t)),a=function(){e.bossAttackTypeXZByTime(2,100,0,!1,550),e.bossAttackTypeXZByTime(2,-100,0,!0,550)},c=function(){var t=JsUnit.getVectorRadians(e.node.x,e.node.y,D.gameHeroPx,D.gameHeroPy),i=cc.v2(Number(e.position[2].positionX),Number(e.position[2].positionY));e.bossAttackTypeByTime(1,i,800,null,1,t+10),e.bossAttackTypeByTime(1,i,800,null,1,t-10);var o=cc.v2(Number(e.position[3].positionX),Number(e.position[3].positionY));e.bossAttackTypeByTime(1,o,800,null,1,t+10),e.bossAttackTypeByTime(1,o,800,null,1,t-10)},s=cc.repeatForever(cc.sequence(n,cc.callFunc(c),cc.delayTime(1.5),i,cc.callFunc(a),cc.delayTime(2.5),n,cc.callFunc(c),cc.delayTime(1.5),o,cc.callFunc(a),cc.delayTime(2.5)));e.node.runAction(s)}():function(){var t=cc.winSize.height/4,i=cc.moveTo(2,cc.v2(150,t)),o=cc.moveTo(2,cc.v2(-150,t)),n=cc.sequence(i,o);e.node.runAction(new cc.RepeatForever(n,n.reverse()));e.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(2),cc.callFunc(function(){var t=cc.v2(Number(e.position[2].positionX),Number(e.position[2].positionY));e.bossAttackTypeByTime(2,t,800,null,1);var i=cc.v2(Number(e.position[3].positionX),Number(e.position[3].positionY));e.bossAttackTypeByTime(2,i,800,null,1)}),cc.delayTime(7))));var a=!1,c=function(){var t=cc.v2(Number(e.position[0].positionX),Number(e.position[0].positionY));a||(t=cc.v2(Number(e.position[1].positionX),Number(e.position[1].positionY))),e.sendEvent(e.node.rotation-15,t.x,t.y),e.sendEvent(e.node.rotation,t.x,t.y),e.sendEvent(e.node.rotation+15,t.x,t.y),a=!a},s=cc.repeatForever(cc.sequence(cc.delayTime(.1),cc.callFunc(c),cc.delayTime(2),cc.callFunc(c),cc.delayTime(3)));e.node.runAction(s)}())},boss12AttackHandler:function(){this.node.rotation=180;var e=this.node.parent.height/4,t=this,i=cc.moveTo(1,cc.v2(0,e+100)),o=cc.moveTo(2,cc.v2(-400,e)),n=cc.moveTo(2,cc.v2(400,e));this.node.runAction(new cc.RepeatForever(cc.sequence(i,o,n)));this.node.runAction(new cc.RepeatForever(cc.sequence(cc.callFunc(function(){t.bossAttackType4()}),cc.delayTime(1.5))))},boss13AttackHandler:function(){this.node.rotation=180;var e=this.node.parent.height/4,t=this,i=cc.moveTo(2,cc.v2(-200,e)),o=cc.moveTo(2,cc.v2(200,e));this.node.runAction(new cc.RepeatForever(cc.sequence(i,o)));var n=this.node.rotation-90,a=cc.callFunc(function(){t.bossAttackTypeByTime(2,cc.v2(0,0),1e3,null,1)}),c=cc.repeat(cc.sequence(cc.callFunc(function(){t.sendEvent(n,0,0,350),n+=13}),cc.delayTime(.03)),50);this.node.runAction(new cc.RepeatForever(cc.sequence(a,cc.delayTime(3),c,cc.delayTime(3))))},bossAttackTypeByTime:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:350,o=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1),n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=void 0,c=this;n||(n=c.node.rotation);a=this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){c.sendEvent(n,t.x,t.y,i,null,o)}),cc.delayTime(.1)))),this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(){c.node.stopAction(a)},this)))},bossAttackType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;JsUnit.getVectorRadians(this.node.x+e.x,this.node.y+e.y,D.gameHeroPx,D.gameHeroPy);this.sendEvent(this.node.rotation,e.x,e.y,t,i)},bossAttackType3ByAngle:function(e,t){this.sendEvent(e-15,0,0,t),this.sendEvent(e,0,0,t),this.sendEvent(e+15,0,0,t)},bossAttackType1:function(e){this.sendEvent(this.node.rotation-15),this.sendEvent(this.node.rotation),this.sendEvent(this.node.rotation+15)},bossAttackType2:function(e,t){var i=this,o=cc.repeat(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){e?i.sendEvent(i.node.rotation,e.x,e.y,600):i.sendEvent(i.node.rotation,-50,0,600),t?i.sendEvent(i.node.rotation,t.x,t.y,600):i.sendEvent(i.node.rotation,50,0,600)})),3);this.node.runAction(o)},bossAttackType7:function(e){var t=this.node.rotation,i=this,o=0,n=cc.repeat(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){i.sendEvent(t+15*o,0,0,350),o++})),30);this.node.runAction(n)},bossAttackType3:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!D.isVoideClose&&this.isLife()&&cc.audioEngine.play(this.bossAttackedSound);for(var i=this.node.rotation,o=0;o<24;o++)this.sendEvent(i+15*o,0,0,350,t,e)},bossAttackType3_1:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;!D.isVoideClose&&this.isLife()&&cc.audioEngine.play(this.bossAttackedSound);for(var t=this.node.rotation,i=0;i<36;i++)this.sendEvent(t+10*i,0,0,350,null,e)},bossAttackTypeXZByTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,a=void 0,c=this,s=0;a=this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){c.sendEvent(s,t,i,n),o?s+=13:s-=13}),cc.delayTime(.05)))),this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(){c.node.stopAction(a)},this)))},bossAttackType4:function(e){!D.isVoideClose&&this.isLife()&&cc.audioEngine.play(this.bossAttackedSound);for(var t=this.node.rotation,i=0;i<12;i++)this.sendEvent(t+30*i,-150),this.sendEvent(t+30*i,150)},bossAttackType5:function(e){var t=0,i=[1,-1,2,-2,1,-1],o=this.node.x,n=this.node.y,a=this,c=cc.repeat(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){a.sendEventByPos(a.node.rotation,o+30*i[t],n,700),t++,a.sendEventByPos(a.node.rotation,o+30*i[t],n,700),t++})),3);this.node.runAction(c)},bossAttackType6:function(){var e=JsUnit.getVectorRadians(this.node.x,this.node.y,D.gameHeroPx,D.gameHeroPy),t=0,i=[1,-1,2,-2,1,-1],o=this.node.x,n=this.node.y,a=this,c=cc.repeat(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){a.sendEventByPos(e,o+30*i[t],n,700),t++,a.sendEventByPos(e,o+30*i[t],n,700),t++})),3);this.node.runAction(c)},sendEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:350,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Notification.emit("send_bullet_event_globle",{speed:o,attackNum:this.attackNum,x:this.node.x+t,y:this.node.y+i,rotation:e,enemyCfgID:this.enemyCfgID,enemyType:this.enemyType,defaultSkin:n,bossBulletType:a,stepMovePos:c})},sendEventByPos:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:350,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;Notification.emit("send_bullet_event_globle",{speed:o,attackNum:this.attackNum,x:t,y:i,rotation:e,enemyCfgID:this.enemyCfgID,enemyType:this.enemyType,defaultSkin:n,bossBulletType:a})},getAttackNum:function(){return this.attackNum},dieHandler:function(){var e=this.score;if(D.isKillBossTimeStatus&&3==this.enemyType){var t=this.limitStr.split(","),i=0;if(1==t.length)i=Number(t[0]);else for(var o=0;o<t.length;o++){var n=t[o].split("#");n[0]>D.isKillBossRemainTime&&(i=Number(n[1]))}e=e*(100+i)/100}this.forceRemove(e)},onHandleDestroy:function(){this.dropID>0&&Notification.emit("make_star_globle_event",{speed:this.runspeed,x:this.node.x,y:this.node.y,dropID:this.dropID}),this.dieHandler(),3==this.enemyType&&Notification.emit("boss_die_event")},gamePause:function(){this.node.pauseAllActions()},gameResume:function(){this.node.resumeAllActions()}}),cc._RF.pop()},{}],followAward:[function(e,t,i){"use strict";cc._RF.push(t,"95611J4HM1IxpR2cvTI2QV+","followAward");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils"));cc.Class({extends:cc.Component,properties:{btnSound:{default:null,type:cc.AudioClip},btnAwardPlane:cc.Button,labAwardStatus:cc.Label},onLoad:function(){var e=this;this.btnAwardPlane.interactable=!1,n.requestHeroList(function(t){t.forEach(function(t){2==t.kind&&(3==t.status?e.btnAwardPlane.interactable=!0:1!=t.status&&2!=t.status||(e.labAwardStatus.string="\u5df2\u9886\u53d6"))})}),this.onMoveAction()},onMoveAction:function(){var e=this.node.getChildByName("spr_right"),t=e.position.x,i=e.position.y,o=cc.moveTo(1.5,new cc.Vec2(t-30,i)),n=cc.moveTo(1.5,new cc.Vec2(t+30,i)),a=cc.repeatForever(cc.sequence(o,n));e.runAction(a)},onBackMain:function(){this.onBtnSound(),o.removePopUpLayer(this)},onGetAward:function(){this.onBtnSound();var e=this;n.requestHeroList(function(t){t.forEach(function(t){2==t.kind&&(3==t.status?(o.sysMessage("\u9886\u53d6\u6210\u529f\uff01"),e.labAwardStatus.string="\u5df2\u9886\u53d6",e.btnAwardPlane.interactable=!1,n.requestUpdateHeroStatus(t.kind,t.status,1,function(e){})):1==t.status||2==t.status||0==t.status&&o.sysMessage("\u8bf7\u5148\u8fdb\u884c\u5173\u6ce8\uff01"))})})},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],friendHelpItem:[function(e,t,i){"use strict";cc._RF.push(t,"febefr2/EFA36jjyquhhNGX","friendHelpItem");var o=e("common"),n=e("PlatformUtils"),a=e("TimeUtils");cc.Class({extends:cc.Component,properties:{rht_desc:cc.RichText,spr_head:cc.Sprite,btn_invite:cc.Button,btn_award:cc.Button,pgb_help:cc.ProgressBar,lab_time:cc.Label,nod_helping:cc.Node,lab_add:cc.Label,btnSound:{default:null,type:cc.AudioClip}},start:function(){o.iphonexAdapter(this.node)},initWithData:function(e){this.data=e;var t=1==e.isRecv&&0==e.remainSec;null==e.headimg||t||o.createImage(e.headimg,this.spr_head);var i="",n=void 0==e.name?"":e.name;1==e.isRecv?t?(this.btn_invite.node.active=!0,this.btn_invite.interactable=!1,this.btn_invite.node.getChildByName("spr_lab").getComponent(cc.Sprite).setState(1),this.btn_award.node.active=!1,i="<color=#ffffff>\u8fd9\u91cc\u7a7a\u7740\u5462\uff0c\u5feb\u9080\u8bf7\u670b\u53cb\n\u6765\u52a9\u529b</color>"):(this.btn_award.node.active=!1,this.btn_invite.node.active=!1,i="<color=#ffe760>"+n+"</color>"):""!=n?(this.btn_invite.node.active=!1,this.btn_award.node.active=!0,i="<color=#ffe760>\u4f60\u7684\u597d\u53cb\u5e2e\u4f60\u4e86\u5927\u5fd9\uff0c\u70b9\u51fb\n\u5f00\u59cb\u52a9\u529b\u6536\u76ca\u5427\uff01</color>"):(this.btn_invite.node.active=!0,this.btn_award.node.active=!1,i="<color=#ffffff>\u8fd9\u91cc\u7a7a\u7740\u5462\uff0c\u5feb\u9080\u8bf7\u670b\u53cb\n\u6765\u52a9\u529b</color>"),this.rht_desc.string=i,e.isNew&&(this.lab_add.string="+10%"),this.nod_helping.active=!1,this.help_time=e.remainSec?e.remainSec:0,this.help_time>0&&this.countDown()},countDown:function(){this.nod_helping.active=!0,this.btn_award.node.active=!1;var e=this;this.lab_time.node.stopAllActions();var t=function(){e.lab_time.string=a.secondsToHMS(e.help_time);var t=e.help_time/600;e.pgb_help.progress=t,e.help_time<=0&&(e.lab_time.node.stopAllActions(),e.isHelping=!1,e.data.remainSec=0,e.initWithData(e.data)),e.help_time-=1},i=cc.delayTime(1),o=cc.callFunc(t,this);this.lab_time.node.runAction(cc.repeatForever(cc.sequence(i,o))),t()},onBtnHelp:function(){this.onBtnSound();var e=o.getShareCfgByType(D.ShareTypeZhuli),t=e.title,i=e.imageUrl,a=(n.getUserSkey(),n.getUserId());n.shareAppMessage(t,i,"type=shareHelp&fromUserId="+a,function(e){e?(o.sysMessage("\u5206\u4eab\u6210\u529f\uff01"),n.requestBill(100007,14,200,1)):n.requestBill(100007,14,200,0),n.setItemByLocalStorage("curFriendHelpNum",D.commonState.friendHelpNum)})},onBtnAward:function(){this.onBtnSound();var e=this;n.requestHelpReceive(this.data.id,function(t){2020==t||2021==t?o.sysMessage("\u52a9\u529b\u5206\u4eab\u6ca1\u8fbe\u6807!"):(t.isRecv=1,e.initWithData(t))})},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",TimeUtils:"TimeUtils",common:"common"}],friendHelp:[function(e,t,i){"use strict";cc._RF.push(t,"23c3dHjTqdBhIW/D/kAQOR6","friendHelp");var o=e("common"),n=e("PlatformUtils"),a=e("StorageUtils");cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,btnSound:{default:null,type:cc.AudioClip},helpItemPrefab:cc.Prefab},start:function(){var e=this;D.commonState.friendHelpNum&&a.checkFriendHelp(),n.requestHelpList(function(t){e.initList(t)})},initList:function(e){var t=this.scrollView.content,i=this,o=0;e.forEach(function(e,n){var a=cc.instantiate(i.helpItemPrefab);t.addChild(a);var c=a.getComponent("friendHelpItem");c&&c.initWithData(e),0==e.isRecv&&void 0!=e.name&&null!=e.name&&(o+=1)}),D.commonState.friendHelpNum=o},onBtnBackMain:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound),o.removePopUpLayer(this)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",common:"common"}],gameAward:[function(e,t,i){"use strict";cc._RF.push(t,"e3c25H7C8hPjpb7Kf9pr2Tg","gameAward");var o=e("common"),n=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{lab_score:cc.Label,btn_video:cc.Button,btn_skip:cc.Button,btnSound:{default:null,type:cc.AudioClip}},start:function(){n.createBannerAd(!0)},initData:function(e){this.score=e,this.lab_score.string=String(e),0==e&&(this.btn_video.interactable=!1)},onBtnVideo:function(){this.onBtnSound(),n.requestBill(100008,8,200,0);var e=this;n.createRewardedVideoAd("doublestar",function(){n.hideWxLayer(),o.removePopUpLayer(e),e.gameMain.commitCoin(!0),e.gameMain.showGameSettle(),o.sysMessage("\u606d\u559c\u83b7\u5f97"+2*e.score+"\u661f\u661f"),n.requestBill(100008,8,200,1)})},onBtnSkip:function(){this.onBtnSound(),o.removePopUpLayer(this),this.gameMain.commitCoin(),this.gameMain.showGameSettle(),this.score>0&&o.sysMessage("\u606d\u559c\u83b7\u5f97"+this.score+"\u661f\u661f")},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],gamePause:[function(e,t,i){"use strict";cc._RF.push(t,"825efWcUKRPKIMvYO0fPSTi","gamePause");var o=e("common"),n=e("sceneManager"),a=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{btnViedo:cc.Button,sprKanshipin:cc.Sprite,sprFenxiang:cc.Sprite,shareMode:cc.string,sprCloseSound:cc.Sprite,sprOpenSound:cc.Sprite,btnSound:{default:null,type:cc.AudioClip}},onLoad:function(){this.btnViedo.node.active=!1;var e=this;a.requestShareCfg("getBombPauseGame",function(t){"v"==t?(e.btnViedo.node.active=!0,e.sprKanshipin.node.active=!0,e.sprFenxiang.node.active=!1):"s"==t&&(e.btnViedo.node.active=!0,e.sprKanshipin.node.active=!1,e.sprFenxiang.node.active=!0),e.shareMode=t}),D.isVoideClose?(this.sprCloseSound.node.opacity=0,this.sprOpenSound.node.opacity=255):(this.sprCloseSound.node.opacity=255,this.sprOpenSound.node.opacity=0)},onGameContinue:function(){this.onBtnSound(),o.removePopUpLayer(this),this.gameMain.pauseToStart()},onViedo:function(){if(this.onBtnSound(),this.gameMain.videoGetBombMax<=0)o.sysMessage("\u672c\u5c40\u770b\u89c6\u9891\u9886\u53d6\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650!");else{var e=this;if("v"==this.shareMode){if(!a.isTodayWxVideoBeyond())return void o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01");a.requestBill(100008,2,200,0),a.createRewardedVideoAd("zanting",function(){D.commonState.labBombAmount+=2,Notification.emit("upgradeBomb",D.commonState.labBombAmount),o.sysMessage("\u606d\u559c\u83b7\u5f972\u4e2a\u70b8\u5f39\uff01"),a.requestBill(100008,2,200,1),e.gameMain.videoGetBombMax-=1})}else if("s"==this.shareMode){if(!a.isTodayWxAwardShareBeyond())return void o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01");var t=o.getShareCfgByType(D.ShareTypeFriend),i=t.title,n=t.imageUrl;a.shareAppMessageCallback(i,n,"",function(e){1==e?(D.commonState.labBombAmount+=2,Notification.emit("upgradeBomb",D.commonState.labBombAmount),o.sysMessage("\u606d\u559c\u83b7\u5f972\u4e2a\u70b8\u5f39\uff01"),a.setTodayWxAwardShare(),a.requestBill(100007,2,200,1)):a.requestBill(100007,2,200,0)})}}},onCloseVoide:function(){this.onBtnSound(),D.isVoideClose?(cc.audioEngine.resumeAll(),cc.audioEngine.resumeMusic(),this.sprCloseSound.node.opacity=255,this.sprOpenSound.node.opacity=0,D.isVoideClose=!1):(cc.audioEngine.pauseAll(),cc.audioEngine.pauseMusic(),this.sprCloseSound.node.opacity=0,this.sprOpenSound.node.opacity=255,D.isVoideClose=!0)},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},handBackStart:function(){this.onBtnSound(),this.gameMain.gameEndAndRelease(),this.gameMain.commitCoin(),n.loadScene("Start"),D.commonState.isBattle=!1,D.commonState.battleFromUserId=0}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],gameSettle:[function(e,t,i){"use strict";cc._RF.push(t,"1a93dIcVLFI9oSSaFFO7sg5","gameSettle");var o=e("common"),n=e("sceneManager"),a=e("PlatformUtils"),c=e("taskUtils");cc.Class({extends:cc.Component,properties:{sprHeadimg:cc.Sprite,labBestScore:cc.Label,labScore:cc.Label,labQzb:cc.Label,labQzDescr:cc.Label,labTopRemain:cc.Label,topPrefab:cc.Prefab,upgradePrefab:cc.Prefab,btnSound:{default:null,type:cc.AudioClip},btn_moregame_menu:cc.Button,btn_moregame2:cc.Button},onLoad:function(){this.initData(D.commonState.gameScore),a.requestBill(100006,1,100),a.hideWxLayer(),this.initMoreGame2();var e=D.SvrCfgs.nav2&&D.SvrCfgs.nav2.length>0;this.btn_moregame_menu.node.active=e},start:function(){var e=a.getItemByLocalStorage("GameSettleCount",0)+1;a.setItemByLocalStorage("GameSettleCount",e),e>=3&&a.lotteryVideoCount()>0&&(cc.loader.loadRes("prefabs/lotteryDraw",function(e,t){o.showPopUpLayer(t)}),a.setItemByLocalStorage("GameSettleCount",0)),c.taskReport(c.TaskType.FLY_KM,D.commonState.gameDist)},initMoreGame2:function(){if(D.SvrCfgs.cgnav&&0!=D.SvrCfgs.cgnav.length){var e=this,t=function(){var t=D.moreGameBaseUrl+"icon2/icon"+e.btn_moregame2.icon+".png";cc.loader.load(t,function(t,i){e.btn_moregame2.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)})};e.btn_moregame2.node.active=!0,e.btn_moregame2.node.rotation=0,e.btn_moregame2.count=0,e.btn_moregame2.icon=1,t(),e.btn_moregame2.node.runAction(cc.repeatForever(cc.sequence(cc.repeat(cc.sequence(cc.rotateBy(.3,15),cc.rotateBy(.3,-15)),2),cc.delayTime(1.5),cc.callFunc(function(){e.btn_moregame2.count+=1,e.btn_moregame2.count%2==0&&(e.btn_moregame2.icon+=1,e.btn_moregame2.icon>D.SvrCfgs.cgnav.length&&(e.btn_moregame2.icon=1),t())},e))))}else this.btn_moregame2.node.active=!1},initMoreGame:function(){},isCanUpgrade:function(){var e=0;a.requestGameInfo(function(t){e=t.coin});var t=o.getJsonCfgs("hero"),i=!1;return a.requestHeroList(function(o){o.every(function(o){if((1==o.status||2==o.status)&&(i=function(i){var o=!1;return t.every(function(t,n){if(i.id==t.id){i.powerLevel>0&&i.powerLevel;var a=t.powerNeed+t.powerNeedIncr*(i.powerLevel-1);if(e>=a)return o=!0,!1;i.bloodLevel>0&&i.bloodLevel;var c=t.bloodNeed+t.bloodNeedIncr*(i.bloodLevel-1);if(e>=c)return o=!0,!1;i.attackSpeedLevel>0&&i.attackSpeedLevel;var s=t.attackSpeedNeed+t.attackSpeedNeedIncr*(i.attackSpeedLevel-1);if(e>=s)return o=!0,!1}}),o}(o)))return!1})}),i},initData:function(e){this.initScore()},onBackMain:function(){this.onBtnSound(),n.loadScene("Start"),D.commonState.isBattle=!1,D.commonState.battleFromUserId=0},onGotoTop:function(){this.onBtnSound(),o.showPopUpLayer(this.topPrefab).getComponent("top").isShowRankTop3=!0,a.requestBill(100006,2,200)},onGotoUpgrade:function(){this.onBtnSound(),o.showPopUpLayer(this.upgradePrefab),a.requestBill(100006,3,200)},onGameAgain:function(){this.onBtnSound();var e=this,t=function(){o.removePopUpLayer(e),a.requestBill(100006,4,200),n.loadScene("Tmp")};cc.loader.loadRes("prefabs/beginFight",function(e,i){var n=o.showPopUpLayer(i).getComponent("beginFight");n&&n.setCallBack(t,D.currHero.kind)})},onFriendHelp:function(){this.onBtnSound();var e=function(){var e=o.getShareCfgByType(D.ShareTypeBattle),t=e.title,i=e.imageUrl,n=(a.getUserSkey(),a.getUserId());a.shareAppMessage(t,i,"type=shareBattle&fromUserId="+n,function(e){e?(o.sysMessage("\u53d1\u8d77\u6311\u6218\u6210\u529f\uff01"),a.requestBill(100007,15,200,1)):a.requestBill(100007,15,200,0)})};a.requestBattleList(a.getUserId(),function(t){t&&t.items&&t.items.length>0?e():a.requestBattleAdd(D.currHero.kind,D.currHero.subSeq,D.commonState.gameScore,function(t){e()})})},update:function(e){},initScore:function(){var e=this;a.getHigthScore(function(t){e.labBestScore.string=String(t)}),a.requestGameInfo(function(t){e.labQzb.string=t.qzb+""}),this.labScore.string=String(D.commonState.gameScore),a.getUserInfo(function(t){e.loadHeadPic(e.sprHeadimg,t.avatarUrl)})},loadHeadPic:function(e,t){cc.loader.load({url:t,type:"png"},function(t,i){e.spriteFrame=new cc.SpriteFrame(i)})},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onBtnMoreGame2:function(){this.onBtnSound(),this.btn_moregame2.node.getChildByName("spr_red_point").active=!1},onBtnMoreGame:function(){if(!this.btn_moregame_menu.opening){this.onBtnSound();var e=this,t=function(){e.btn_moregame_menu.opening=!1;var t=e.btn_moregame_menu.node.x>0?-1:1,i=e.btn_moregame_menu.node.getChildByName("spr_arrow");i&&(i.scaleX=t);var o=e.btn_moregame_menu.node.getChildByName("spr_red");e.btn_moregame_menu.node.x>0?o.active=!1:o.active=!0},i=function(t){if(t){var i=t.getComponent("moreGame");e.btn_moregame_menu.node.x<0?t.active=!1:i&&i.setGraphicsVisible(!0)}},o=function(o){e.btn_moregame_menu.node.stopAllActions(),o.stopAllActions();var n=e.btn_moregame_menu.node.x<0?490:-490,a=cc.moveBy(.45,cc.v2(n,0)),c=cc.callFunc(t,e),s=cc.moveBy(.45,cc.v2(n,0)),r=cc.callFunc(i,e);if(e.btn_moregame_menu.node.runAction(cc.sequence(a,c)),o.runAction(cc.sequence(s,r)),e.btn_moregame_menu.node.x>0){var l=o.getComponent("moreGame");l&&l.setGraphicsVisible(!1)}},n=this.node.getChildByName("moregameTag");if(n)return n.active=!0,o(n),void(this.btn_moregame_menu.opening=!0);cc.loader.loadRes("prefabs/moreGame",function(t,i){if(!e.node.getChildByName("moregameTag")){var n=cc.instantiate(i);e.node.addChild(n),n.x=-490,n.getChildByName("nodeBg").y+=300,n.getChildByName("scrollview").y+=300,n.name="moregameTag",n.zIndex=1e3,e.btn_moregame_menu.node.zIndex=1001,o(n),e.btn_moregame_menu.opening=!0;var a=e.btn_moregame_menu.node.getChildByName("spr_red");a&&(a.active=!1)}})}}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager",taskUtils:"taskUtils"}],gameUtils:[function(e,t,i){"use strict";cc._RF.push(t,"7ba3cda8EBJ7KO2Um20LA76","gameUtils");var o=e("common"),n=e("PlatformUtils"),a={isNewExplain:function(){var e=n.getItemByLocalStorage("TodayExplainDate");if(e){var t=new Date(e);o.isSameDay(t)||n.setItemByLocalStorage("NewExplainCount",0)}var i=n.getItemByLocalStorage("NewExplainCount",0);return i<(n.getItemByLocalStorage("NewExplainNewPlayer",!0)?2:1)?(n.setItemByLocalStorage("NewExplainCount",i+1),n.setItemByLocalStorage("TodayExplainDate",new Date),!0):(n.setItemByLocalStorage("NewExplainNewPlayer",!1),!1)},getFriendHelpAdd:function(e){n.requestHelpList(function(t){var i=0;t.forEach(function(e,t){e.remainSec&&e.remainSec>0&&(i+=5,e.isNew&&(i+=5))}),e&&e(i)})},redPacketIsDrop:function(e,t){var i=D.commonState.userGameInfo.money,o=D.commonState.userGameInfo.createdDays,a=.4,c=this;if(i>=function(){if(c.redPacketMaxMoney)return c.redPacketMaxMoney;var e=n.getItemByLocalStorage("RedPacketMaxMoney",0);if(0==e){var t=16*Math.random();e=Math.floor(t)/10+17.2,n.setItemByLocalStorage("RedPacketMaxMoney",e),c.redPacketMaxMoney=e,console.log("====== create saveMax = ",e)}return c.redPacketMaxMoney=e,c.redPacketMaxMoney}())return!1;if(function(){c.gameLevel!=e&&(c.gameLevel=e,c.curLevelDropNum=0,c.dropNumMax=-1,c.curLevelIdx=null);var t=n.getItemByLocalStorage("PassedMaxLevel",0);if(c.dropNumMax,e<=t)return 1;if(c.dropNumMax<0){var i=Math.ceil(2*Math.random());c.dropNumMax=i}return c.dropNumMax}()<=this.curLevelDropNum)return!1;if(!(this.curLevelIdx&&t-this.curLevelIdx<5)){var s=function(){e<=3&&(o>=3&&o<7?a-=.1:o>=7&&(a*=.5));var t=n.getItemByLocalStorage("preEedGameLevel",0),i=n.getItemByLocalStorage("preEedGameLevelCount",0),c=n.getItemByLocalStorage("PassedMaxLevel",0);return 1==t&&1==e&&c<1&&(1==i?a*=.5:i>1&&(a=.01)),2==t&&2==e&&c<2&&(1==i?a*=.5:i>1&&(a=.05)),a}();if(Math.random()>s)return!1;if(this.curLevelIdx=t,e<=3){var r="redpacketAwardLevel"+e;n.getItemByLocalStorage(r,!1)||(this.redpacketReason=3001)}return!0}},redpacketInitState:function(){this.curLevelIdx=null,this.curLevelDropNum=0,this.dropNumMax=-1,this.redpacketReason=3e3}};t.exports=a,cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],gameover:[function(e,t,i){"use strict";cc._RF.push(t,"a931bVNOc5FgJ3VUeRLoaxL","gameover");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils"));cc.Class({extends:cc.Component,properties:{txt_score:cc.Label,btnVideo:cc.Button,nQzb:cc.Integer,txt_diamond:cc.Label,txt_need:cc.Label,btnZhuli:cc.Button,sprMyqzb:cc.Sprite,btnSound:{default:null,type:cc.AudioClip},scoreChangeSound:{default:null,type:cc.AudioClip},scoreBreakingSound:{default:null,type:cc.AudioClip},btn_skip:cc.Button},onLoad:function(){this.btnVideo.node.active=!1,this.btnZhuli.node.active=!1,this.sprMyqzb.node.active=!1,this.adapteBtn();var e=this;n.requestShareCfg("gameOverRevive,gameOverZhuli",function(t){0==D.commonState.gameContinueCounter?"v"==t.gameOverRevive?e.btnVideo.node.active=!0:"s"==t.gameOverZhuli&&(e.btnZhuli.node.active=!0,e.sprMyqzb.node.active=!0):"s"==t.gameOverZhuli?(e.btnZhuli.node.active=!0,e.sprMyqzb.node.active=!0):"v"==t.gameOverRevive&&(e.btnVideo.node.active=!0),e.adapteBtn()}),this.initData(D.commonState.gameScore,D.commonState.gameDist),n.requestBill(100005,1,100),n.createBannerAd(!0)},onDestroy:function(){},adapteBtn:function(){1==this.btnVideo.node.active&&0==this.btnZhuli.node.active?(this.btnZhuli.node.y=this.btnVideo.node.y-131,this.txt_score.node.y=96):0==this.btnVideo.node.active&&1==this.btnZhuli.node.active?(this.btnZhuli.node.y=this.btnVideo.node.y-65,this.txt_score.node.y=96):0==this.btnVideo.node.active&&0==this.btnZhuli.node.active?this.txt_score.node.y=0:1==this.btnVideo.node.active&&1==this.btnZhuli.node.active&&(this.txt_score.node.y=96)},initData:function(e,t){this.onScoreChangeSound(),this.initUserInfo(e),this.txt_need.string=D.recoverHpCost;var i=this;n.requestGameInfo(function(e){i.nQzb=e.qzb,i.txt_diamond.string=e.qzb+"\u4e2a"}),n.setAndGetHigthScore(e,function(t){e>=t&&i.onScoreBreakingSound()})},initUserInfo:function(e){this.txt_score.string=e+"",n.getUserInfo(function(e){})},onSkipGameAndSettle:function(){this.onBtnSound(),n.hideWxLayer(),o.removePopUpLayer(this),this.gameMain.showGameAward(),this.gameMain.gameEndAndRelease()},onGameContinue:function(){n.requestBill(100008,3,200,0),this.onBtnSound();var e=this;n.createRewardedVideoAd("fuhuo",function(){n.hideWxLayer(),o.removePopUpLayer(e),e.gameMain.recoverHpAndGame(100),n.requestBill(100008,3,200,1)})},onShare:function(){if(this.onBtnSound(),n.requestBill(100005,2,200,0),this.nQzb>=D.recoverHpCost){var e=this,t=function(t){e.scheduleOne(function(){var t=Date.now()/1e3;console.log("----- share back---curTime=,shareTime=",t,e.shareTime),t-e.shareTime<2.5?o.sysMessage("\u8bf7\u5206\u4eab\u5230\u4e0d\u540c\u7684\u7fa4\u5185"):state?(n.hideWxLayer(),o.removePopUpLayer(e),e.gameMain.recoverHpAndGame(100),n.requestBill(100005,2,200,1)):e.doAwardQzbShare()},.01)};return e.shareTime=Date.now()/1e3,void n.requestRecover(-1*D.recoverHpCost,function(e){t(res)})}this.doAwardQzbShare()},doAwardQzbShare:function(){this.onBtnSound();var e=o.getShareCfgByType(D.ShareTypeSettle),t=e.title,i=e.imageUrl,a=this;n.shareAppMessage(t,i,"",function(e){if(e){n.requestRecover(2,function(e){e&&(o.sysMessage("\u5206\u4eab\u6210\u529f\u83b7\u5f97 2 \u4e2a\u94bb\u77f3 \uff01"),n.requestGameInfo(function(e){a.nQzb=e.qzb,a.txt_diamond.string=e.qzb+"\u4e2a"}))}),n.requestBill(100007,1,200,1)}else n.requestBill(100007,1,200,0)})},update:function(e){},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onScoreChangeSound:function(){D.isVoideClose||cc.audioEngine.play(this.scoreChangeSound)},onScoreBreakingSound:function(){D.isVoideClose||cc.audioEngine.play(this.scoreBreakingSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],global:[function(e,t,i){"use strict";cc._RF.push(t,"5e8abuccWVB27wHfN03ylCQ","global"),window.D={Versioin:"1.1.19",poolObjs:{},commonState:{},commonConfigs:{},configsDir:"config/",SceneManagerValues:{},UrlDomain:"http://ls.otctop.com/toujiao-websocket/",wxVideoAdUnitId:{shengji:"adunit-e845eda53d6ecc10",fuhuo:"adunit-3d11a8a5972b3cff",zanting:"adunit-cfe2c267872621cb",game:"adunit-1a45661202ddb189",dating:"adunit-407b0a251c863cef",lottery:"adunit-6a51043a65d06a74",dailysign:"adunit-cd46873bbbe4489a",redpacket:"adunit-0d21ee748ae77b19",doublestar:"adunit-c6737fee6ed72378"},wxAdUnitId:"adunit-7c969c10b6eb1bed",wxLaunchOption:null,wxShareTicket:null,wxMoreGameUrls:["https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/moregame/nzpk.jpg","https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/moregame/mg2.jpg","https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/moregame/mg3.jpg","https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/moregame/mg4.png","https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/moregame/mg5.jpg","https://aircraft-1255396242.cos.ap-guangzhou.myqcloud.com/moregame/mg6.jpg"],moreGameBaseUrl:"https://qcloud-cdn.budding-tech.com/moregame/",wxGameClubBtn:null,wxVideoMaxNum:7,wxAwardShareMaxNum:10,wxFromAppID:"",removePopUpLayerCallback:null,ShareTypeZhuli:1,ShareTypeFriend:2,ShareTypeInvite:3,ShareTypeGroup:4,ShareTypeSettle:5,ShareTypeBattle:6,ReasonAddCoinAward:1e3,ReasonAddCoinUpgrade:1001,ReasonAddCoinVideo:1002,ReasonAddCoinFight:1003,ReasonAddCoinShare:1005,ReasonCostCoinFight:1006,ReasonLotteryDraw:1007,AwardCoinVideo:400,AwardCoinShare:300,currHero:{},isKillBossTimeStatus:!1,isKillBossRemainTime:0,magnetStatus:!1,gameHeroPx:0,gameHeroPy:0,gameBossAttacking:!1,SvrCfgs:{},SvrCfgsReturn:!1,isVoideClose:cc.Boolean=!1,gameStatuePause:!1,recoverHpCost:2,beginFightBuffs:[],curSceneName:"",lotteryFreeDrawCount:2,lotteryVideoDrawCount:3,isAutoPopedDailySign:!1,wxMoreGamePath:{wx71743e2c3394dc9e:"?krq_qmbk=015&ald_media_id=2677&ald_link_key=56b08fa11a4c2483&ald_position_id=0",wxd6c5337aed6300ec:"pages/index/index?shareType=helplock&ad_channel=6g&uid=162025&sid=10&ald_media_id=6590&ald_link_key=a20a68239e929800",wx52966cd958bcd65b:"pages/index/index?Ads=woying&AdsPos=feiji",wxa43c45d6986bcafd:"pages/index/index?channel=xiaoyouxi",wx5ced162faa4eb1f3:"pages/index/index?share_id=100019&ald_media_id=7753&ald_link_key=8bd4eda525a330a0",wx79fc05b190c49fde:"?ald_media_id=4400&ald_link_key=c7cd0c6aca3bb6bf&ald_position_id=0",wx3df1cf2a43a6b16d:"pages/index/index",wxe0e3ef455414d91d:"?ald_media_id=4560&ald_link_key=af65a1ccfb0475bd&ald_position_id=0",wxd8de2f6276406b2a:"pages/blank/blank?ald_media_id=8305&ald_link_key=b4e2b47d97b246f7",wx5d49b5fa52580889:"pages/index/index?ald_media_id=8138&ald_link_key=b68d0eadada2fb03",wxf48553c6ca9bc829:"pages/shop/index",wx7745ae49b819ab1b:"pages/index/index?source=&ald_media_id=10489&ald_link_key=dd8086b79675d327"}},window.ItemConst={SignHeroGas:1e3,SignNewPlane:2e3},window.Notification={_eventMap:[],on:function(e,t,i){void 0===this._eventMap[e]&&(this._eventMap[e]=[]),this._eventMap[e].push({callback:t,target:i})},emit:function(e,t){var i=this._eventMap[e];if(void 0!==i)for(var o=0;o<i.length;o++){var n=i[o];n&&n.callback.call(n.target,t)}},off:function(e,t){var i=this._eventMap[e];if(void 0!==i)for(var o=0;o<i.length;o++){var n=i[o];if(n&&n.callback===t){i[o]=void 0;break}}},offType:function(e){this._eventMap[e]=void 0}},window.JsUnit={getVectorRadians:function(e,t,i,o){var n=o-t,a=i-e,c=c=Math.abs(n)/Math.abs(a),s=0;return n>=0&&a<0?s=180*Math.atan(c)/Math.PI-90:n>=0&&a>0?s=90-180*Math.atan(c)/Math.PI:n<0&&a<=0?s=180*-Math.atan(c)/Math.PI-90:n<0&&a>=0&&(s=180*Math.atan(c)/Math.PI+90),s}},window.Device={needOffsetPixel:function(){return cc.winSize.width/cc.winSize.height<.49}},cc._RF.pop()},{}],guideItem:[function(e,t,i){"use strict";cc._RF.push(t,"f3c18Ywv0BEJLJhQZ6vPc+g","guideItem");var o=e("common");cc.Class({extends:cc.Component,properties:{point:cc.Node,line1:cc.Node,line2:cc.Node,spCenter:cc.Node,finger:cc.Node,txt_desc:cc.Label,mask:cc.Node,maskBg:cc.Node},onLoad:function(){},start:function(){},guide:function(e,t,i){this.initView(e);var o=this,n=cc.callFunc(function(){o.runAnim()},this),a=cc.delayTime(6.5),c=cc.callFunc(function(){t&&(e.stopAllActions(),t.apply(i))},this);e.runAction(cc.sequence(n,a,c))},initView:function(e){this.txt_desc.string="\u5168\u5c4f\u70b8\u5f39\u70b8\u6bc1\u73b0\u6709\u654c\u673a\u548c\u70ae\u5f39";var t=e.parent.convertToWorldSpace(new cc.v2(e.x,e.y)),i=t.y>0?-1:1;this.point.position=new cc.v2(t.x,t.y+i*e.height/2+10*i),this.line1.position=new cc.v2(this.point.x,this.point.y-2*i);var o=this.point.y*i-10*i;this.line1.height=o;var n=t.y>0?180:0;this.line1.rotation=n;var a=t.x>0?1:-1;this.line2.position=new cc.v2(this.line1.x,0),this.line2.height=this.line2.x*a-this.spCenter.width/2+5;var c=t.x>0?90:270;this.line2.rotation=c,this.spCenter.position=new cc.v2(0,0),this.finger.position=new cc.v2(t.x+e.width/2,t.y-e.height/2),this.mask.position=new cc.v2(t.x+15,t.y);var s=this.maskBg.addComponent(cc.Graphics);s.fillColor=new cc.Color(0,0,0,150);this.mask.x,cc.winSize.width,this.mask.y,cc.winSize.height;s.fillRect(-100,-100,cc.winSize.width+100,cc.winSize.height+100),this.point.active=!1,this.line1.active=!1,this.line2.active=!1,this.spCenter.active=!1,this.finger.active=!1},runAnim:function(){var e=this,t=cc.callFunc(function(){var t=0;e.point.active=!0,e.point.scaleY=0,e.point.runAction(cc.scaleTo(.4,1)),t+=.4,e.line1.active=!0,e.line1.scaleY=0,e.line1.runAction(cc.sequence(cc.delayTime(t),cc.scaleTo(.4,1,1))),t+=.4,e.line2.active=!0,e.line2.scaleY=0,e.line2.runAction(cc.sequence(cc.delayTime(t),cc.scaleTo(.4,1,1))),t+=.4,e.spCenter.active=!0,e.spCenter.opacity=0,e.spCenter.runAction(cc.sequence(cc.delayTime(t),cc.fadeIn(.2))),t+=.2},this),i=cc.delayTime(1.4),o=cc.callFunc(function(){e.finger.active=!0,e.finger.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.45,cc.v2(e.finger.x+10,e.finger.y-10)),cc.delayTime(.1),cc.moveTo(.45,cc.v2(e.finger.x-10,e.finger.y+10)))))},this);this.node.runAction(cc.sequence(t,i,o))},close:function(){this.node.stopAllActions(),o.removePopUpLayer(this)}}),cc._RF.pop()},{common:"common"}],guideLayer:[function(e,t,i){"use strict";cc._RF.push(t,"412d9axU61PyKh678OTzbum","guideLayer");var o=e("common");cc.Class({extends:cc.Component,properties:{txt_desc:cc.Label},onLoad:function(){this.txt_desc.enableWrapText=!0},start:function(){},gotoBackGame:function(e){this.callback&&this.callback.apply(this.callbackObj),this.node.off(cc.Node.EventType.TOUCH_START,this.gotoBackGame,this),o.removePopUpLayer(this)},startAnim:function(e,t){this.callback=e,this.callbackObj=t;for(var i=1;i<=6;i++){var o=this.node.getChildByName("guide_"+i);o&&(o.active=!1)}var n=this.node.getChildByName("spr_center");n&&(n.opacity=0),this.node.idx=1,this.next()},next:function(){var e="guide_"+this.node.idx,t=this.node.getChildByName(e);if(t){t.active=!0;var i=0,o=t.getChildByName("point");o&&(o.scale=0,o.runAction(cc.scaleTo(.15,1)),i+=.2);var n=t.getChildByName("line1"),a=t.getChildByName("line2");n&&(n.scaleY=0,n.runAction(cc.sequence(cc.delayTime(i),cc.scaleTo(.2,1,1))),i+=.2),a&&(a.scaleY=0,a.runAction(cc.sequence(cc.delayTime(i),cc.scaleTo(.2,1,1))),i+=.2);var c=this.node.getChildByName("spr_center");if(c){var s=cc.delayTime(i),r=cc.fadeIn(.15),l=cc.delayTime(1.2),d=cc.fadeOut(.15),u=cc.callFunc(function(){t.active=!1,c.stopAllActions()},this),h=cc.callFunc(this.next,this);c.runAction(cc.sequence(s,r,l,d,u,h)),this.setTextDesc()}this.node.idx+=1}else this.gotoBackGame()},setTextDesc:function(){var e="";1==this.node.idx?e="\u6682\u505c\u6309\u94ae\u53ef\u6682\u505c\u5f53\u524d\u6e38\u620f":2==this.node.idx?e="\u6e38\u620f\u4e2d\u6240\u83b7\u53d6\u7684\u661f\u661f\u6570\u91cf":3==this.node.idx?e="\u81ea\u5df1\u98de\u673a\u5269\u4f59\u8840\u91cf":4==this.node.idx?e="\u5168\u5c4f\u70b8\u5f39\u70b8\u6bc1\u73b0\u6709\u654c\u673a\u548c\u70ae\u5f39":5==this.node.idx&&(e="\u98de\u673a\u4e2d\u5fc3\u4f53\u88ab\u51fb\u4e2d\u6263\u9664\u751f\u547d\u503c"),this.txt_desc.string=e}}),cc._RF.pop()},{common:"common"}],heroBuff:[function(e,t,i){"use strict";cc._RF.push(t,"56c15ECIqJP753DMXs4RoWX","heroBuff"),cc.Class({extends:cc.Component,properties:{spr_countdown:cc.Sprite,txt_num:cc.Label,curType:1},onLoad:function(){},start:function(){},addBuff:function(e){var t=this,i="items/buff_"+e.name;cc.loader.loadRes(i,cc.SpriteFrame,function(e,i){t.node.getComponent(cc.Sprite).spriteFrame=i}),this.updateBuff(e)},updateBuff:function(e){e.time?this.countDown(e.time):e.num?this.setCount(e.num):(this.spr_countdown.node.active=!1,this.txt_num.node.active=!1)},countDown:function(e){this.spr_countdown.node.active=!0,this.txt_num.node.active=!1;var t=this;this.spr_countdown.node.stopAllActions(),this.spr_countdown.node.scaleY=0,this.spr_countdown.node.runAction(cc.sequence(cc.scaleTo(e,1,1),cc.delayTime(e),cc.callFunc(function(){t.spr_countdown.node.stopAllActions()},this)))},setCount:function(e){this.spr_countdown.node.active=!1,this.txt_num.node.active=!0,this.txt_num.string=String(e)}}),cc._RF.pop()},{}],hero:[function(e,t,i){"use strict";cc._RF.push(t,"35228kMYCZE1bmZTk9kWR9s","hero");var o=e("common"),n=e("PlatformUtils");cc.Class({extends:cc.Component,properties:function(){return{bulletGroup:{default:null,type:e("bulletGroup")},mainScript:{default:null,type:e("main")},hp:100,maxHP:100,attackNum:100,attackSpeed:0,armorNum:0,level:1,defentHurtNum:0,isSuperBuffByDis:!1,isSuperBuffByTime:!1,superBuffByDisNum:0,reLifeBuff:!1,heroBuffs:[]}},onLoad:function(){cc.director.getCollisionManager().enabled=!0;var e=D.currHero.powerLevel,t=D.currHero.attackSpeedLevel,i=D.currHero.bloodLevel,n=o.getGameHeroCfg();this.attackNum=n.initPower+(e-1)*n.powerRadix,this.attackSpeed=n.initAttackSpeed+n.initAttackSpeed*n.attackSpeedRadix/100*t,this.maxHP=n.initBlood+n.bloodRadix*(i-1),this.armorNum=n.initArmor+this.attackNum/7+this.attackSpeed/14,this.loadSkin(n.subSeq),this._skinKind=D.currHero.kind,this._skinSubSeq=n.subSeq,Notification.on("change_bullet_buff",this.onChangeBulletEnd,this),Notification.on("enemy_onCollision_hero",this.onEnemyCollisionHero,this)},start:function(){var e=!1;if(n.requestItemList(function(t){t&&t.forEach(function(t){console.log("====== isHeroNewGas=== val:"+t),t.id==ItemConst.SignHeroGas&&(e=!0)})}),e){var t=this;cc.loader.loadRes("prefabs/hero_newgas",function(e,i){var o=cc.instantiate(i);t.node.addChild(o);var n=t.node.getChildByName("hero_gas");o.position=n.position,t.node.removeChild(n)})}},loadSkin:function(e){var t="plane/plane_"+D.currHero.kind+"_"+e,i=this;cc.loader.loadRes(t,cc.SpriteFrame,function(e,t){i.getComponent(cc.Sprite).spriteFrame=t})},initData:function(){this.hp=this.maxHP,this.mainScript.updateHeroHP(this.hp),this.defentHurtNum=0,this.node.active=!0,this.heroBuffs=[]},addChargeBuff:function(){var e=this;D.beginFightBuffs.forEach(function(t,i){e.addHeroItemEffect("item_"+t)})},onCollisionEnter:function(e,t){if("ufo"===e.node.group)this.addHeroItemEffect(e.node.name);else if("enemy"===e.node.group){var i=e.node.getComponent("enemy");if(i.isLife()){if(this.defentHurtNum>0)return this.defentHurtNum--,void(this.defentHurtNum<=0&&this.removeDefentBuffhandler());if(!this.isSuperBuffByTime&&!this.isSuperBuffByDis){var o=Math.ceil(i.attackNum*i.attackNum/(i.attackNum+5*this.armorNum));this.addHeroHP(2*-o),this.checkLife()}}}else if("bullet"===e.node.group){var n=e.node.getComponent("bullet");if(!n.isPlayerBullet()){if(this.defentHurtNum>0)return this.defentHurtNum--,void(this.defentHurtNum<=0&&this.removeDefentBuffhandler());if(!this.isSuperBuffByTime&&!this.isSuperBuffByDis){var a=Math.ceil(n.attackNum*n.attackNum/(n.attackNum+5*this.armorNum));this.addHeroHP(-a),this.checkLife()}}}},addHeroItemEffect:function(e){switch(e){case"item_1":this.defentBuffhandler();break;case"item_2":var t=o.getJsonCfgByID("Items",2);Notification.emit("updateUfoTimes_event",{timesNum:2,time:t.periodTime}),this.addHeroBuff({name:"item_2",time:t.periodTime});break;case"item_3":t=o.getJsonCfgByID("Items",3);Notification.emit("updateUfoTimes_event",{timesNum:3,time:t.periodTime}),this.addHeroBuff({name:"item_2",time:t.periodTime});break;case"item_4":t=o.getJsonCfgByID("Items",4);Notification.emit("updateUfoTimes_event",{timesNum:5,time:t.periodTime}),this.addHeroBuff({name:"item_2",time:t.periodTime});break;case"item_5":t=o.getJsonCfgByID("Items",5);Notification.emit("updateUfoTimes_event",{timesNum:8,time:t.periodTime}),this.addHeroBuff({name:"item_2",time:t.periodTime});break;case"item_6":this.addHPByPercent(10);break;case"item_7":this.addHPByPercent(20);break;case"item_8":this.magnetHandler();break;case"item_9":t=o.getJsonCfgByID("Items",9);this.spurtHandlerBySpeed(t.sprintDisID);break;case"item_10":t=o.getJsonCfgByID("Items",10);this.spurtHandlerByTime(t.sprintTime);break;case"item_11":t=o.getJsonCfgByID("Items",11);this.bulletGroup.changeBullet("item_11",t.periodTime),this.addHeroBuff({name:"item_11",time:t.periodTime});break;case"item_12":t=o.getJsonCfgByID("Items",12);this.bulletGroup.sendJiGuangBullet(),this.addHeroBuff({name:"item_12",time:t.periodTime});break;case"item_14":t=o.getJsonCfgByID("Items",14);this.mainScript.showLiaojiHandler(),this.addHeroBuff({name:"item_14",time:t.periodTime});break;case"item_15":this.mainScript.receiveBomb();break;case"item_16":this.mainScript.onListinShareItemPkg(16);break;case"item_17":this.mainScript.onListinShareItemPkg(17);break;case"item_18":this.mainScript.addStarNum(1);break;case"item_19":this.mainScript.addRedPacket()}},checkLife:function(){this.hp<=0&&this.onHandleDestroy()},addHPByPercent:function(e){var t=this.maxHP*e;this.addHeroHP(t)},addHeroHP:function(e){if(!(this.reLifeBuff&&e<=0)){this.hp+=e,this.hp>this.maxHP&&(this.hp=this.maxHP),this.hp<0&&(this.hp=0);var t=this.hp;t<0&&(t=0),e<0&&t>0&&this.mainScript.showBeHurtEffView(),this.mainScript.updateHeroHP(t)}},reLife:function(){this.initData(),this.reLifeBuff=!0;var e=cc.delayTime(3),t=cc.callFunc(this.closeRelifeBuff,this);this.node.runAction(cc.sequence(e,t)),this.showHeroShield()},closeRelifeBuff:function(){this.reLifeBuff=!1,this.removeHeroShield()},gameOver:function(){Notification.off("change_bullet_buff",this.onChangeBulletEnd),Notification.off("enemy_onCollision_hero",this.onEnemyCollisionHero)},onHandleDestroy:function(){this.mainScript.gameOver()},defentBuffhandler:function(){this.defentHurtNum++,this.showHeroShield(),this.addHeroBuff({name:"item_1",num:this.defentHurtNum})},removeDefentBuffhandler:function(){this.removeHeroShield(),this.removeHeroBuff({name:"item_1"})},showHeroShield:function(){if(!this.node.getChildByName("HeroShieldTag")){var e=this;cc.loader.loadRes("prefabs/shieldEff",function(t,i){var o=cc.instantiate(i);e.node.addChild(o,100,"HeroShieldTag"),o.getChildByName("animPlay").getComponent(cc.Animation).play(),o.getChildByName("animEnd").getComponent(cc.Animation).node.active=!1})}},removeHeroShield:function(){var e=this.node.getChildByName("HeroShieldTag");if(e&&!(this.defentHurtNum>0)){e.getChildByName("animPlay").getComponent(cc.Animation).node.active=!1;var t=this,i=e.getChildByName("animEnd").getComponent(cc.Animation);i.node.active=!0,i.play(),e.runAction(cc.sequence(cc.delayTime(1.35),cc.callFunc(function(){e.stopAllActions(),t.node.removeChild(e)},t)))}},magnetHandler:function(){if(!this.node.getChildByName("magnetEffTag")){this.unschedule(this.magnetDealyCall);var e=o.getJsonCfgByID("Items",8);D.magnetStatus||this.addHeroBuff({name:"item_8",time:e.periodTime});var t=this;this.magnetDealyCall=function(e){D.magnetStatus=!1,t.removeHeroBuff({name:"item_8"});var i=t.node.getChildByName("magnetEffTag");i&&t.node.removeChild(i)}.bind(this),D.magnetStatus=!0,this.scheduleOnce(this.magnetDealyCall,e.periodTime),cc.loader.loadRes("prefabs/magnetEff",function(e,i){var o=cc.instantiate(i);t.node.addChild(o),o.position=cc.v2(0,-20),o.name="magnetEffTag"})}},spurtHandlerByTime:function(e){if(this.isSuperBuffByTime=!0,this.unschedule(this.resetSpurtHandlerByTime),!this.spurtByTimeNode){var t=this;cc.loader.loadRes("game/buff_huzhao.png",cc.SpriteFrame,function(e,i){t.spurtByTimeNode=new cc.Node("spurtByTimeNode"),t.spurtByTimeNode.addComponent(cc.Sprite).spriteFrame=i,t.node.addChild(t.spurtByTimeNode),t.spurtByTimeNode.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.5),cc.fadeOut(.3))))}),this.addHeroBuff({name:"item_10"})}this.scheduleOnce(this.resetSpurtHandlerByTime,e)},resetSpurtHandlerByTime:function(){this.isSuperBuffByTime=!1,this.spurtByTimeNode&&(this.node.removeChild(this.spurtByTimeNode),this.spurtByTimeNode=null),this.removeHeroBuff({name:"item_10"})},spurtHandlerBySpeed:function(e){if(!this.spurtByDisNode){this.isSuperBuffByDis=!0,this.superBuffByDisNum=this.mainScript.juliNum+e/100;var t=this;cc.loader.loadRes("game/buff_huzhao",cc.SpriteFrame,function(e,i){t.spurtByDisNode=new cc.Node("spurtByDisNode"),t.spurtByDisNode.addComponent(cc.Sprite).spriteFrame=i,t.node.addChild(t.spurtByDisNode),t.spurtByDisNode.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.5),cc.fadeOut(.3))))}),this.addHeroBuff({name:"item_10"})}},resetSpurtHandlerBySpeed:function(){this.isSuperBuffByDis=!1,this.spurtByDisNode&&(this.node.removeChild(this.spurtByDisNode),this.spurtByDisNode=null),this.removeHeroBuff({name:"item_9"})},addHeroBuff:function(e){this.heroBuffs&&(this.heroBuffs.some(function(t){return t.name==e.name})||this.heroBuffs.push(e),-1!=e.time&&(this.mainScript.addHeroBuff(e,this.heroBuffs),this.mainScript.tipsGetItem(e.name)))},removeHeroBuff:function(e){if(this.heroBuffs){var t=this.heroBuffs.filter(function(t,i){return t.name!=e.name});this.heroBuffs=t,this.mainScript.removeHeroBuff(e,this.heroBuffs);var i=e.name.split("_")[1],n=o.getJsonCfgByID("Items",i);n&&-1!=n.periodTime&&this.mainScript.removeHeroBuff(e,this.heroBuffs)}},clearAllBuff:function(){this.removeHeroBuff({name:"item_11"}),this.removeHeroBuff({name:"item_1"}),this.defentHurtNum=0,this.magnetDealyCall&&(this.magnetDealyCall(),this.unschedule(this.magnetDealyCall)),this.resetSpurtHandlerByTime&&(this.resetSpurtHandlerByTime(),this.unschedule(this.resetSpurtHandlerByTime))},onChangeBulletEnd:function(e){this.removeHeroBuff({name:e.item})},onEnemyCollisionHero:function(e){if(this.defentHurtNum>0)return this.defentHurtNum--,void(this.defentHurtNum<=0&&this.removeDefentBuffhandler());var t=Math.ceil(e.attackNum*e.attackNum/(e.attackNum+5*this.armorNum));this.addHeroHP(2*-t),this.checkLife()},update:function(e){D.gameStatuePause||this.isSuperBuffByDis&&this.mainScript.juliNum>this.superBuffByDisNum&&this.resetSpurtHandlerBySpeed()}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",bulletGroup:"bulletGroup",common:"common",main:"main"}],loading:[function(e,t,i){"use strict";cc._RF.push(t,"4a90dJn4hVMCp4NM2ulrHsS","loading");var o=e("common");cc.Class({extends:cc.Component,properties:{imgLoading:cc.Sprite},onLoad:function(){},start:function(){this.loadingAnim()},loadingAnim:function(e){e||(e=10);var t=360*e/2,i=new cc.rotateBy(e,t),n=new cc.callFunc(function(){o.hideLoading()},this);this.imgLoading.node.runAction(cc.sequence(i,n))},update:function(e){}}),cc._RF.pop()},{common:"common"}],login:[function(e,t,i){"use strict";cc._RF.push(t,"f5f2dgmSpRB2L3uQlis+cSf","login");var o=e("common"),n=e("sceneManager"),a=e("PlatformUtils"),c=e("taskUtils");cc.Class({extends:cc.Component,properties:{btnLogin:{default:null,type:cc.Button},btnSound:{default:null,type:cc.AudioClip},txt_desc:cc.Label,txt_load:cc.Label,progressBar:cc.ProgressBar,btn_moregame_menu:cc.Button},onLoad:function(){this.btn_moregame_menu.node.active=!1,D.curSceneName="Login",a.init(function(){a.requestBill(100001,2,200)}),this.node.getChildByName("background").setScale(1,cc.winSize.height/1280),this.btnLogin.node.active=!1,this.loadingScene("Start"),this.node.loadIdx=1,o.loadJsonAllCfgs()},loadingScene:function(e){var t=this;cc.director.preloadScene(e,function(e,i,o){t.txt_desc.string="\u6b63\u5728\u89e3\u538b\u8d44\u6e90,\u89e3\u538b\u4e0d\u6d88\u8017\u6d41\u91cf";var n=100*e/i;n=Math.floor(n),t.txt_load.string=n+"%",t.progressBar.progress=n/100},function(){t.loadFinsh()})},loadFinsh:function(){this.btnLogin.node.active=!0,this.txt_desc.node.active=!1,this.txt_load.node.active=!1,this.progressBar.node.active=!1;var e=this;a.getUserInfo(function(e){0});var t=a.getUserSkey();console.log("getUserSkey=",t),t&&void 0!=t&&"undefined"!=t&&a.requestHeroList(function(e){}),a.requestShareCfg("giftInMain",function(e){}),a.requestItemList(function(e){}),c.requestTaskList();var i=cc.director.getPhysicsManager();i.enabled=!0,i.update(.2),i.enabled=!1,this.scheduleOnce(function(){D.SvrCfgs.nav2&&D.SvrCfgs.nav2.length>0&&(e.btn_moregame_menu.node.active=!0)},.1)},start:function(){a.requestBill(100001,1,100)},gotoLogin:function(){cc.audioEngine.play(this.btnSound),a.requestBill(100001,1,200),a.login(function(e,t){e&&n.loadScene("Start")})},onMoregameMenu:function(){if(!this.btn_moregame_menu.opening){var e=this,t=function(){e.btn_moregame_menu.opening=!1;var t=e.btn_moregame_menu.node.x>0?-1:1,i=e.btn_moregame_menu.node.getChildByName("spr_arrow");i&&(i.scaleX=t)},i=function(t){if(t){var i=t.getComponent("moreGame");e.btn_moregame_menu.node.x<0?t.active=!1:i&&i.setGraphicsVisible(!0)}},o=function(o){e.btn_moregame_menu.node.stopAllActions(),o.stopAllActions();var n=e.btn_moregame_menu.node.x<0?490:-490,a=cc.moveBy(.45,cc.v2(n,0)),c=cc.callFunc(t,e),s=cc.moveBy(.45,cc.v2(n,0)),r=cc.callFunc(i,e);if(e.btn_moregame_menu.node.runAction(cc.sequence(a,c)),o.runAction(cc.sequence(s,r)),e.btn_moregame_menu.node.x>0){var l=o.getComponent("moreGame");l&&l.setGraphicsVisible(!1)}},n=this.node.getChildByName("moregameTag");if(n)return n.active=!0,o(n),void(this.btn_moregame_menu.opening=!0);cc.loader.loadRes("prefabs/moreGame",function(t,i){if(!e.node.getChildByName("moregameTag")){var n=cc.instantiate(i);e.node.addChild(n),n.x=-490,n.name="moregameTag",n.zIndex=1e3,e.btn_moregame_menu.node.zIndex=1001,o(n),e.btn_moregame_menu.opening=!0;var a=e.btn_moregame_menu.node.getChildByName("spr_red");a&&(a.active=!1)}})}}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager",taskUtils:"taskUtils"}],lotteryDraw:[function(e,t,i){"use strict";cc._RF.push(t,"842dcIdRtVLLrwOwKUUs/ac","lotteryDraw");var o=e("common"),n=e("PlatformUtils"),a=e("TimeUtils"),c=e("StorageUtils");cc.Class({extends:cc.Component,properties:{nodeReward:cc.Node,btnSound:{default:null,type:cc.AudioClip},sprFree:cc.Sprite,sprVideo:cc.Sprite,txt_timedesc:cc.Label,txt_timenum:cc.Label,nodeTime:cc.Node,btn_close:cc.Button,curIdx:6,perRotation:60,curCountDown:0,countDownType:1,freeDelayTime:0,videoDelayTime:0,awardItemPos:{default:[]}},onLoad:function(){o.iphonexAdapter(this.node),this.curIdx=6,this.awardItemPos=[1,2,3,4,6,5],this.freeDelayTime=14400,this.videoDelayTime=30,this.initBtnState()},start:function(){for(var e=1;e<=6;e++){var t=this.awardItemPos[e-1];this.initItem(e,t)}this.btn_close.node.getComponent(cc.Widget);n.createBannerAd(!0)},onDestroy:function(){},initBtnState:function(){this.countDownType=0,this.curCountDown=0;var e=!1,t=this,i=function(){e=!0,t.txt_timenum.node.stopAllActions();var i=cc.delayTime(1),o=cc.callFunc(function(){t.curCountDown-=1,t.txt_timenum.string=a.secondsToHMS(t.curCountDown),t.curCountDown<0&&(t.txt_timenum.node.stopAllActions(),t.initBtnState())});t.txt_timenum.string=a.secondsToHMS(t.curCountDown),t.txt_timenum.node.runAction(cc.repeatForever(cc.sequence(i,o)))},o=D.lotteryFreeDrawCount-c.lotteryFreeCount(),s=c.lotteryFreeTime(),r=o>0&&0==s;this.sprFree.node.active=r,this.sprFree.canClick=r;var l=n.lotteryVideoCount(),d=Math.floor(Date.now()/1e3)-n.getItemByLocalStorage("LotteryVideoPreTime",0);d=d>this.videoDelayTime?0:this.videoDelayTime-d;var u=l>0&&0==d;if(this.sprVideo.node.active=u,this.sprVideo.canClick=u,s>0&&d>0?s<d||0==l?(this.countDownType=1,this.curCountDown=s,this.txt_timedesc.string="\u4e0b\u6b21\u514d\u8d39\u65f6\u95f4:",i()):(this.countDownType=2,this.curCountDown=d,this.txt_timedesc.string="\u4e0b\u6b21\u89c6\u9891\u65f6\u95f4:",i()):s>0&&d<=0?(this.countDownType=1,this.curCountDown=s,this.txt_timedesc.string="\u4e0b\u6b21\u514d\u8d39\u65f6\u95f4:",i()):d>0&&s<=0&&l>0&&(this.countDownType=2,this.curCountDown=d,this.txt_timedesc.string="\u4e0b\u6b21\u89c6\u9891\u65f6\u95f4:",i()),this.nodeTime.active=e,this.sprFree.node.active||this.sprVideo.node.active||(1==this.countDownType?this.sprFree.node.active=!0:2==this.countDownType&&(this.sprVideo.node.active=!0)),this.sprFree.node.active){var h=this.sprFree.canClick?0:1;this.sprFree.node.getComponent(cc.Sprite).setState(h)}if(this.sprVideo.node.active){var m=this.sprVideo.canClick?0:1;this.sprVideo.node.getComponent(cc.Sprite).setState(m)}},initItem:function(e,t){var i=o.getJsonCfgByID("lottery_draw",t);if(i){var n=this.node.getChildByName("nodeReward").getChildByName("txt_"+e);n&&(n.getComponent(cc.Label).string=i.name)}},onBtnDraw:function(){if(this.sprFree.canClick)return n.setItemByLocalStorage("TodayLetteryFreeCountDown",Math.floor(Date.now()/1e3)),n.setItemByLocalStorage("TodayLetteryFreeDate",new Date),void this.handleFreeDraw();this.sprVideo.canClick&&this.handleVideoDraw()},handleFreeDraw:function(){if(this.drawing)console.log(" drawing now...");else{this.onBtnSound();var e=c.lotteryFreeCount();e<D.lotteryFreeDrawCount&&(n.setItemByLocalStorage("LetteryFreeCount",e+1),n.setItemByLocalStorage("TodayLetteryFreeDraw",new Date),this.requestDraw())}},handleVideoDraw:function(){if(this.drawing)console.log(" drawing now...");else if(n.lotteryVideoCount()<=0)o.sysMessage("\u60a8\u4eca\u65e5\u89c6\u9891\u5956\u52b1\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650\uff0c\u8bf7\u660e\u5929\u518d\u6765\uff01");else{n.requestBill(100008,5,200,0),this.onBtnSound();var e=this;n.createRewardedVideoAd("lottery",function(){n.requestBill(100008,5,200,1),n.setTodayWxVideo(),n.setItemByLocalStorage("TodayLotteryVideoCnt",n.getItemByLocalStorage("TodayLotteryVideoCnt",0)+1),n.setItemByLocalStorage("TodayLotteryVideoTime",new Date),n.setItemByLocalStorage("LotteryVideoPreTime",Math.floor(Date.now()/1e3)),e.requestDraw(),Notification.emit("remove_all_poplayer")})}},onBtnClose:function(){this.onBtnSound(),o.removePopUpLayer(this),console.log("------------- lotteryDraw onDestroy 111111 "),"Game"==D.curSceneName&&(console.log("------------- lotteryDraw onDestroy 2222222222 "),n.hideWxLayer()),this.drawing&&this.reward(this.curIdx)},requestDraw:function(){this.drawing=!0,this.initBtnState();for(var e=o.getJsonCfgs("lottery_draw"),t=Math.floor(100*Math.random())+1,i=0,n=0;n<e.length;n++){var a=e[n];if((i+=a.precent)>=t)return void this.draw(a.id)}},draw:function(e){for(var t=1,i=0;i<this.awardItemPos.length;i++){if(this.awardItemPos[i]==e){t=i+1;break}}console.log("======== draw===  awardId="+e+",---- idx="+t);for(var o=t-this.curIdx,n=this.perRotation*o+1440,a=.2,c=[];n>0;){n>540?a>.04&&(a-=.04):a+=.008;var s=cc.rotateBy(a,20);c.push(s),a,n-=20}var r=this;c.push(cc.callFunc(function(){r.drawing=!1,r.reward(t)},this)),this.nodeReward.stopAllActions(),this.nodeReward.runAction(cc.sequence(c)),this.curIdx=t},reward:function(e){var t=this.awardItemPos[e-1],i=o.getJsonCfgByID("lottery_draw",t);o.sysMessage("\u606d\u559c\u60a8\u83b7\u5f97"+i.num+"\u661f\u661f"),n.requestAddCoin(i.num,D.ReasonLotteryDraw,function(e){}),n.requestBill(100007,13,200,1)},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",TimeUtils:"TimeUtils",common:"common"}],main:[function(e,t,i){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}cc._RF.push(t,"a45d2fCne1FZ4aswnM6yL8+","main");var n=e("pool"),a=e("common"),c=(e("sceneManager"),e("PlatformUtils")),s=e("gameUtils"),r=e("StorageUtils");cc.Class({extends:cc.Component,properties:function(){return{btnPause:cc.Button,labScoreDisplay:cc.Label,labBombAmount:cc.Label,txt_juliNum:cc.Label,starNum:cc.Label,txt_level_info:cc.Label,txt_kill_boss_time:cc.Label,labBombDisplay:cc.Node,img_kill_boss_time:cc.Sprite,node_buffs:cc.Node,isGamePlaying:!1,btnPauseSprite:{default:[],type:cc.SpriteFrame,tooltip:"ButtonsGroupOfPauseTheGame"},hero:{default:null,type:e("hero")},bulletGroup:{default:null,type:e("bulletGroup")},enemyGroup:{default:null,type:e("enemyGroup")},ufoGroup:{default:null,type:e("ufoGroup")},effGroup:{default:null,type:e("effGroup")},bgm:{default:null,type:cc.AudioClip},soundGameOver:{default:null,type:cc.AudioClip},soundBomb:{default:null,type:cc.AudioClip},soundBtn:{default:null,type:cc.AudioClip},heroHPBar:{default:null,type:cc.ProgressBar,tooltip:"\u8840\u91cf\u6761"},gameoverPrefab:cc.Prefab,gameSettlePrefab:cc.Prefab,gamePausePrefab:cc.Prefab,juliNum:0,juliNumWxSync:0,killBossTimeMax:30,currKillBossTime:0,videoGetBombMax:2,shareItemPkgPrefab:cc.Prefab,hero_liaoji_1:cc.Sprite,hero_liaoji_2:cc.Sprite,txt_cdStart:cc.Label,spr_help_add:cc.Sprite,txt_helpadd:cc.Label,stopMoveHero:!1,gameFightingID:cc.String,battlePrefab:cc.Prefab,redpacketPrefab:cc.Prefab,gameAwardPrefab:cc.Prefab,btn_speed:cc.Button,gameSpeed:1}},onLoad:function(){if(D.curSceneName="Game",Device.needOffsetPixel()){var e=this.node._parent.getChildByName("Canvas").getChildByName("spr_node").getComponent(cc.Widget);e&&(e.top=e.top+70)}this.hero_liaoji_1.node.active=!1,this.hero_liaoji_2.node.active=!1,this.txt_level_info.node.active=!1,this.initState(),D.isVoideClose||(cc.audioEngine.stopAll(),this.currentBGMusic=cc.audioEngine.play(this.bgm,!0,.4)),this.labBombDisplay.on(cc.Node.EventType.TOUCH_START,this.useBomb,this),this.ufoGroup.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),Notification.on("upgradeBomb",this.onListenBombChange,this),Notification.on("giveAwayItemPkg",this.onListenGiveAwayItemPkg,this),Notification.on("pauseToStart",this.pauseToStart,this),Notification.on("shake_game_bg",this.sharkBg,this),Notification.on("level_Reward_Finish_event",this.rewardFinishHandler,this),c.hideWxLayer(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){c.hideWxLayer()}))),D.gameBossAttacking=!1},onDestroy:function(e){Notification.off("upgradeBomb",this.onListenBombChange),Notification.off("giveAwayItemPkg",this.onListenGiveAwayItemPkg),Notification.off("pauseToStart",this.pauseToStart),Notification.off("shake_game_bg",this.sharkBg),Notification.off("level_Reward_Finish_event",this.rewardFinishHandler),this.hero.gameOver(),D.beginFightBuffs=[],cc.director.getScheduler().setTimeScale(1),this.savePassLevel()},start:function(){a.hideLoading(),a.clearPopLayer(),c.hideWxLayer(),this.checkReadyGoEff()},checkReadyGoEff:function(){var e=this,t=function(){e.readyGoEff()};s.isNewExplain()?(D.commonState.pauseState=!0,D.gameStatuePause=!0,this.hero.node.y=.5*cc.winSize.height*-1-200,cc.loader.loadRes("prefabs/newExplain",function(e,i){var o=a.showPopUpLayer(i,a.PopUpBg.Gray,a.PopUpAction.None,new cc.Color(0,0,0,80)).getComponent("newExplain");o&&o.setCallback(t)})):t()},initState:function(){this.gameFightingID=a.guid(),c.requestBill(100003,1,100,this.gameFightingID),D.commonState.pauseState=!1,D.gameStatuePause=!1,D.commonState.labBombAmount=3,this.labBombAmount.string="x"+String(D.commonState.labBombAmount),D.commonState.gameScore=0,D.commonState.gameDist=0,this.labScoreDisplay.string=D.commonState.gameScore.toString(),this.btnPause.active=!0,this.labBombDisplay.active=!0,this.starNum.string=String(0),this.juliNum=0,this.juliNumWxSync=0,this.txt_juliNum.string=String(this.juliNum),this.txt_cdStart.node.active=!1,this.hero.node.active=!0;var e=this.hero.getComponent("hero");this.updateHeroHP(e.maxHP),this.hideKillBossTime(),D.commonState.gameContinueCounter=0,this.spr_help_add.node.active=!1;var t=this;s.getFriendHelpAdd(function(e){e>0&&(t.spr_help_add.node.active=!0,t.txt_helpadd.string=e+"%")}),s.redpacketInitState()},readyGoEff:function(){D.commonState.pauseState=!0,D.gameStatuePause=!0;var e=this;this.hero.initData(),this.hero.node.x=0,this.hero.node.y=.5*cc.winSize.height*-1-200;var t=.5*cc.winSize.height*-1+300;this.hero.node.stopAllActions(),this.hero.node.runAction(cc.sequence(cc.moveTo(.3,cc.v2(0,t)),cc.blink(.3,3),cc.delayTime(.5),cc.callFunc(function(){e.effGroup.showReadyView(e.newGuide,e)})))},newGuide:function(){var e=this,t=function(){e.gameStart(),c.setItemByLocalStorage("newGuide1",!0)};if(!c.getItemByLocalStorage("newGuide1",!1))return c.requestBill(100004,1,100),D.commonState.pauseState=!0,D.gameStatuePause=!0,void cc.loader.loadRes("prefabs/guideLayer",function(i,o){var n=a.showPopUpLayer(o,a.PopUpBg.Gray,a.PopUpAction.None,new cc.Color(0,0,0,80)).getComponent("guideLayer");n&&n.startAnim(t,e)});this.gameStart()},guideItem:function(e){if(!D.commonState.pauseState){var t="guideItem_id"+e,i=this,o=function(){i.labBombDisplay.guiding&&(i.doGamePause(),i.useBomb())};this.labBombDisplay.runAction(cc.sequence(cc.delayTime(6),cc.callFunc(function(){if(!D.commonState.pauseState&&!c.getItemByLocalStorage(t,!1)){if(!i.labBombDisplay.guiding)return;if(D.commonState.pauseState)return;this.doGamePause(),cc.loader.loadRes("prefabs/guideItem",function(e,t){var n=a.showPopUpLayer(t,a.PopUpBg.None,a.PopUpAction.None,new cc.Color(0,0,0,50));i.labBombDisplay.guideLayer=n,n.removeComponent(cc.BlockInputEvents);var c=n.getComponent("guideItem");c&&c.guide(i.labBombDisplay,o,i)})}},this))),this.labBombDisplay.guiding=!0}},gameStart:function(){D.commonState.pauseState=!1,D.gameStatuePause=!1,this.isGamePlaying=!0,this.enemyGroup.startAction(),this.bulletGroup.startAction(),this.ufoGroup.startAction(),this.hero.addChargeBuff()},showLiaojiHandler:function(){this.hero_liaoji_1.node.active=!0,this.hero_liaoji_2.node.active=!0,this.bulletGroup.liaojiHandler(!0);a.getJsonCfgByID("Items",14);this.hideLiaojiHandler=function(){this.hero_liaoji_1.node.active=!1,this.hero_liaoji_2.node.active=!1,this.bulletGroup.liaojiHandler(!1),Notification.emit("change_bullet_buff",{item:"item_14"})}},getLiaojiPoint:function(e){return 1==e?cc.v2(this.hero.node.x-100,this.hero.node.y):cc.v2(this.hero.node.x+100,this.hero.node.y)},startFireEvent:function(){this.bulletGroup.levelBeginlHandler()},showWarningView:function(){this.effGroup.showWarningView(this.startFireEvent,this)},showMissileView:function(e,t,i,o){this.effGroup.showMissilePreView(t,i),o&&this.effGroup.showGameMissileView();var n=this,a=cc.delayTime(2),c=cc.callFunc(function(){n.enemyGroup.checkShowWarningPreView(),n.bulletGroup.missileBulletHandler(t,i)},this);this.node.runAction(cc.sequence(a,c))},recoverHpAndGame:function(e){D.gameStatuePause=!1,this.stopMoveHero=!1,this.isGamePlaying=!0,this.btnPause.active=!0,this.labBombDisplay.active=!0,D.commonState.gameContinueCounter++;var t=this;this.hero.node.stopAllActions(),this.hero.reLife(),this.hero.node.x=0,this.hero.node.y=.5*cc.winSize.height*-1-200;var i=.5*cc.winSize.height*-1+300;this.hero.node.runAction(cc.sequence(cc.moveTo(.3,cc.v2(0,i)),cc.blink(.3,3),cc.delayTime(.5),cc.callFunc(function(){t.doResumeGame(),1==t.levelPassing&&(t.hero.closeRelifeBuff(),t.heroFlyTop())})))},newGameAgain:function(){if(D.isKillBossTimeStatus=!1,D.gameBossAttacking=!1,D.gameStatuePause=!1,this.stopMoveHero=!1,this.commitCoin(),this.enemyGroup.gameOver(),this.bulletGroup.gameOver(),this.ufoGroup.gameOver(),this.removeAllEnemy(!0),this.removeAllBullet(!0),this.removeAllUfo(),this.clearHeroBuff(),this.initState(),this.checkReadyGoEff(),this.savePassLevel(),!D.isVoideClose){cc.audioEngine.stopAll();var e=this;this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){e.currentBGMusic=cc.audioEngine.play(e.bgm,!0,.4)},this)))}},clearHeroBuff:function(){this.hero.clearAllBuff(),this.hideLiaojiHandler&&this.hideLiaojiHandler(),this.ufoGroup.resetUpdteUfoTimesHandler()},showBeHurtEffView:function(){this.effGroup.showBeHurtEffView()},commitCoin:function(e){var t=Number(this.starNum.string);e&&(t*=2),c.requestAddCoin(t,D.ReasonAddCoinFight,function(){}),this.starNum.string="0"},savePassLevel:function(){c.getItemByLocalStorage("preEedGameLevel",0)==this.enemyGroup.mainLevel?c.setItemByLocalStorage("preEedGameLevelCount",c.getItemByLocalStorage("preEedGameLevelCount",0)+1):c.setItemByLocalStorage("preEedGameLevelCount",1),c.setItemByLocalStorage("preEedGameLevel",this.enemyGroup.mainLevel)},gameOver:function(){if(this.isGamePlaying){this.isGamePlaying=!1,D.isVoideClose||cc.audioEngine.play(this.soundGameOver);var e=this;this.doPauseGame(),D.commonState.gameDist=this.juliNum,D.gameStatuePause=!0,this.submitScore(),this.effGroup.heroDieEff(function(){e.btnPause.active=!1,e.labBombDisplay.active=!1,c.requestShareCfg("gameOverRevive,gameOverZhuli",function(t){console.log("requestShareCfg",JSON.stringify(t)),!t.gameOverRevive&&!t.gameOverZhuli||D.commonState.gameContinueCounter>=2?(e.gameEndAndRelease(),e.showGameAward()):a.showPopUpLayer(e.gameoverPrefab).getComponent("gameover").gameMain=e})},this,this.hero.node)}},handlebtnPause:function(){if(D.isVoideClose||cc.audioEngine.play(this.soundBtn),!D.commonState.pauseState){this.doGamePause();var e=a.showPopUpLayer(this.gamePausePrefab).getComponent("gamePause");e.node.getComponentsInChildren(cc.Label).forEach(function(e,t){"lab_close_voice"==e.node.name&&(e._string=D.isVoideClose?"\u5f00\u542f":"\u9759\u97f3")}),e.gameMain=this}},doGamePause:function(){D.commonState.pauseState?this.doResumeGame():this.doPauseGame()},doResumeGame:function(){D.gameStatuePause=!1,this.enemyGroup.gameResume(),this.bulletGroup.gameResume(),this.ufoGroup.gameResume(),D.isVoideClose||cc.audioEngine.resume(this.currentBGMusic),D.commonState.pauseState=!1},doPauseGame:function(){D.gameStatuePause=!0,this.enemyGroup.gamePause(),this.bulletGroup.gamePause(),this.ufoGroup.gamePause(),D.isVoideClose||cc.audioEngine.pause(this.currentBGMusic),D.commonState.pauseState=!0},pauseToStart:function(){this.txt_cdStart.node.active=!0,this.txt_cdStart.string="3";var e=this,t=function(){var t=parseInt(e.txt_cdStart.string);(t-=1)<1?(e.doGamePause(),e.txt_cdStart.node.stopAllActions(),e.txt_cdStart.node.active=!1):e.txt_cdStart.string=String(t)},i=cc.delayTime(1),o=cc.callFunc(t,e),n=cc.delayTime(1),a=cc.callFunc(t,e),c=cc.delayTime(1),s=cc.callFunc(t,e);this.txt_cdStart.node.runAction(cc.sequence(i,o,n,a,c,s))},useBomb:function(){if(cc.log("===D.commonState.labBombAmount==",D.commonState.labBombAmount),1!=this.txt_cdStart.node.active){var e=!1;if(this.labBombDisplay.guiding&&this.labBombDisplay.guideLayer){this.labBombDisplay.guiding=!1;var t=this.labBombDisplay.guideLayer.getComponent("guideItem");t&&t.close(),c.setItemByLocalStorage("guideItem_id1",!0),this.labBombDisplay.guideLayer=null,e=!0,D.commonState.pauseState&&this.doGamePause()}if(D.commonState.labBombAmount>0||e){D.isVoideClose||cc.audioEngine.play(this.soundBomb);for(var i=!1,n=void 0,s=new(Function.prototype.bind.apply(Array,[null].concat(o(this.enemyGroup.node.children)))),r=0;r<s.length;r++)(n=s[r].getComponent("enemy"))&&n.isInWinsize()&&n.tntBombHandler(),i=!0;var l=this.removeAllBullet();if(i||l){e||D.commonState.labBombAmount--,this.labBombAmount.string="x"+String(D.commonState.labBombAmount);this.effGroup.showBigBoom(function(){this.bulletGroup.resumeEnemyBullet()},this),this.bulletGroup.stopEnemyBullet(),this.sharkBg()}else a.sysMessage("\u6ca1\u6709\u53ef\u4ee5\u70b8\u6bc1\u7684\u7269\u4f53")}else a.sysMessage("\u5168\u5c4f\u70b8\u5f39\u6570\u91cf\u4e0d\u8db3")}},touchMove:function(e){if(!D.gameStatuePause&&!this.stopMoveHero){var t=e.touch.getDelta();this.hero.node.x+=t.x,this.hero.node.y+=t.y;var i=.5*cc.winSize.width-50,o=.5*cc.winSize.height-50;this.hero.node.x<-i?this.hero.node.x=-i:this.hero.node.x>i?this.hero.node.x=i:this.hero.node.y<-o?this.hero.node.y=-o:this.hero.node.y>o&&(this.hero.node.y=o)}},removeAllBullet:function(e){for(var t=!1,i=new(Function.prototype.bind.apply(Array,[null].concat(o(this.bulletGroup.node.children)))),n=0;n<i.length;n++){var a=i[n].getComponent("bullet");a&&e?(t=!0,a.forceRemove()):a&&!a.isPlayerBullet()&&(t=!0,this.bulletGroup.destroyBullet(a.node))}return t},removeAllEnemy:function(e){for(var t=!1,i=new(Function.prototype.bind.apply(Array,[null].concat(o(this.enemyGroup.node.children)))),n=0;n<i.length;n++)e?(t=!0,i[n].getComponent("enemy").forceRemove()):(t=!0,i[n].getComponent("enemy").explodingAnim());return t},removeAllUfo:function(){for(var e=new(Function.prototype.bind.apply(Array,[null].concat(o(this.ufoGroup.node.children)))),t=0;t<e.length;t++)e[t].getComponent("ufo").removeUfo()},receiveBomb:function(){D.commonState.labBombAmount++,this.labBombAmount.string="x"+String(D.commonState.labBombAmount)},changeScore:function(e){D.commonState.gameScore+=e,this.labScoreDisplay.string=D.commonState.gameScore.toString()},gameEndAndRelease:function(){this.hero.node.active=!0,this.enemyGroup.gameOver(),this.bulletGroup.gameOver(),this.ufoGroup.gameOver(),n.clearAllPool()},showGameAward:function(){var e=a.showPopUpLayer(this.gameAwardPrefab).getComponent("gameAward");e.initData(Number(this.starNum.string)),e.gameMain=this},showGameSettle:function(){D.commonState.isBattle&&D.commonState.battleFromUserId!=c.getUserId()?this.showBattleResult():a.showPopUpLayer(this.gameSettlePrefab).getComponent("gameSettle").gameMain=this},showBattleResult:function(){var e=this,t=function(){var t=a.showPopUpLayer(e.battlePrefab).getComponent("battleLayer");t&&t.requestData(D.commonState.battleFromUserId,!0)};if(D.commonState.battleFromUserId==c.getUserId())c.requestBattleAdd(this.hero._skinKind,this.hero._skinSubSeq,D.commonState.gameScore,function(e){t()});else{var i={fromUserId:D.commonState.battleFromUserId,heroKind:this.hero._skinKind,heroSeq:this.hero._skinSubSeq,score:D.commonState.gameScore};c.requestBattleAddScore(i,function(e){t()})}},updateHeroHP:function(e){var t=this.hero.getComponent("hero").maxHP;this.heroHPBar.progress=e/t},addStarNum:function(e){var t=Number(this.starNum.string);if(this.starNum.string=String(Math.floor(e+t)),!this.hero.starEff){var i=this;this.hero.starEff=!0,this.effGroup.starEff(this.hero.node,function(){i.hero.starEff=!1},this)}},updateJuLiNum:function(){D.gameBossAttacking||(this.juliNum+=.01,this.txt_juliNum.string=String(this.juliNum.toFixed(2)+"km"),(0==this.juliNumWxSync||this.juliNum-this.juliNumWxSync>=.5)&&(this.nearFriend(0==this.juliNumWxSync?0:5),this.juliNumWxSync=this.juliNum))},updateLevelInfo:function(e,t){this.txt_level_info.string=e,this.level_idx=t},showKillBossTime:function(){D.isKillBossTimeStatus||(this.currKillBossTime=this.killBossTimeMax,this.killBossTimeCallback=function(){this.currKillBossTime<=0&&this.hideKillBossTime(),this.updateKillBossTime(),this.currKillBossTime--},this.schedule(this.killBossTimeCallback,1),this.updateKillBossTime())},hideKillBossTime:function(){D.isKillBossTimeStatus=!1,this.img_kill_boss_time.node.active=!1,this.unschedule(this.killBossTimeCallback)},updateKillBossTime:function(){D.isKillBossRemainTime=this.killBossTimeMax-this.currKillBossTime;var e=new Date(1e3*this.currKillBossTime);this.txt_kill_boss_time.string=e.getMinutes()+":"+e.getSeconds()},isKillBossTime:function(){return!1},update:function(e){D.gameStatuePause||(D.gameHeroPx=this.hero.node.x,D.gameHeroPy=this.hero.node.y,this.updateJuLiNum())},onListenBombChange:function(e){this.labBombAmount.string="x"+String(D.commonState.labBombAmount)},levelPass:function(){this.levelPassing=!0,this.heroFlyTop()},heroFlyTop:function(e,t){this.stopMoveHero=!0;var i=this,o=cc.moveTo(1,cc.v2(this.hero.node.x,.5*cc.winSize.height+200)),n=cc.delayTime(1),a=cc.callFunc(function(){i.changeRewardBg(e,t)},this);this.hero.node.stopAllActions(),this.hero.node.runAction(cc.sequence(o,n,a))},changeRewardBg:function(e,t){null==e&&(e="bg/reward_bg"),null==t&&(t="level_reward_event"),this.hero.node.x=0,this.hero.node.y=.5*cc.winSize.height*-1-200;var i=this,o=function(){i.stopMoveHero=!1,Notification.emit(t,{lvl:i.enemyGroup.currlevel})},n=function(){var e=cc.moveTo(.5,cc.v2(0,.5*cc.winSize.height*-1+300)),t=cc.delayTime(.5),n=cc.callFunc(o,i);i.hero.node.stopAllActions(),i.hero.node.runAction(cc.sequence(e,t,n))},a=this.node.parent.getChildByName("Canvas").getChildByName("nodeBg");cc.loader.loadRes(e,cc.SpriteFrame,function(e,t){for(var o=1;o<=3;o++){a.getChildByName("bg"+o)&&i.changeBgAnim(t,n)}})},rewardFinishHandler:function(){this.heroFlyTop("bg/fighting_bg","level_Reward_Ani_Finish_event"),this.levelPassing=!1},changeBgAnim:function(e,t){var i=this.node.parent.getChildByName("Canvas").getChildByName("nodeBg"),o=cc.fadeOut(.3),n=cc.callFunc(function(){for(var o=1;o<=3;o++){var n=i.getChildByName("bg"+o);n&&(n.getComponent(cc.Sprite).spriteFrame=e)}t&&t()},this),a=cc.fadeIn(.3);i.stopAllActions(),i.runAction(cc.sequence(o,n,a))},onListinShareItemPkg:function(e){var t=void 0,i=void 0,o=void 0,n=void 0,c=void 0,s=void 0;a.getJsonCfgs("Items")[e].dropValue.split(",").forEach(function(e,a){switch(a){case 0:t=e.split("#")[0],i=e.split("#")[1];break;case 1:o=e.split("#")[0],n=e.split("#")[1];break;case 2:c=e.split("#")[0],s=e.split("#")[1]}});var r=cc.director.getScene("Game"),l=null;r._children.forEach(function(e,t){"mainScript"==e._name&&e._components.forEach(function(e,t){l=e.shareItemPkgPrefab,e.hero})});var d=this,u=["items/item_"+t,"items/item_"+o,"items/item_"+c];cc.loader.loadResArray(u,cc.SpriteFrame,function(t,o){if(t)cc.error(t);else{l.data.children[3].children[0]._components[0].spriteFrame=o[0],l.data.children[3].children[1]._components[0].string="x"+i,l.data.children[4].children[0]._components[0].spriteFrame=o[1],l.data.children[4].children[1]._components[0].string="x"+n,l.data.children[5].children[0]._components[0].spriteFrame=o[2],l.data.children[5].children[1]._components[0].string="x"+s,l.data.getChildByName("lab_itemid").getComponent(cc.Label).string=e+"";var c=new cc.Vec2(cc.winSize.width/2,cc.winSize.height/2),u=a.createPopUpLayer(r,l,c);r.addChild(u),d.doGamePause()}})},onListenGiveAwayItemPkg:function(e){var t=void 0,i=void 0,o=void 0,n=void 0,c=void 0,s=void 0;a.getJsonCfgs("Items")[e].dropValue.split(",").forEach(function(e,a){switch(a){case 0:t=e.split("#")[0],i=e.split("#")[1];break;case 1:o=e.split("#")[0],n=e.split("#")[1];break;case 2:c=e.split("#")[0],s=e.split("#")[1]}}),this.addHeroItem(t,i),this.addHeroItem(o,n),this.addHeroItem(c,s),this.pauseToStart()},addHeroItem:function(e,t){switch(e){case 18:this.addStarNum(t);default:for(var i=0;i<t;i++)this.hero.addHeroItemEffect("item_"+e)}},addHeroBuff:function(e,t){if(e&&-1!=e.time){var i=this,o=this.node_buffs.getChildByName("herobuff_tag_"+e.name);o?function(e,t){var i=t.getComponent("heroBuff");i&&i.updateBuff(e)}(e,o):function(e){cc.loader.loadRes("prefabs/heroBuff",function(o,n){var a=cc.instantiate(n);i.node_buffs.addChild(a,1,"herobuff_tag_"+e.name);var c=a.getComponent("heroBuff");c&&c.addBuff(e),i.updateBuffPos(t)})}(e)}},removeHeroBuff:function(e,t){if(null!=e){var i=this.node_buffs.getChildByName("herobuff_tag_"+e.name);i&&this.node_buffs.removeChild(i),this.updateBuffPos(t)}},updateBuffPos:function(e){var t=1,i=this;e.forEach(function(e,o){if(-1!=e.time){var n=i.node_buffs.getChildByName("herobuff_tag_"+e.name);if(n){var a=i.node_buffs.getChildByName("img_buff"+t);a&&(n.position=a.position)}t+=1}})},tipsGetItem:function(e){if(!this.hero.itemTios){var t=this;this.effGroup.getItemTips(this.hero.node,e,function(){t.hero.itemTios=!1},this),this.hero.itemTios=!0}},getNearEnemyByPos:function(e){for(var t=null,i=99999999,n=new(Function.prototype.bind.apply(Array,[null].concat(o(this.enemyGroup.node.children)))),a=0;a<n.length;a++){var c=n[a].getComponent("enemy");if(c&&c.isLife()&&c.isInWinsize()){var s=c.node.getPosition().subSelf(e).mag();i>s&&(t=c,i=s)}}return t},sharkBg:function(){var e=this.node.parent.getChildByName("Canvas").getChildByName("nodeBg");e&&(e.stopAllActions(),e.runAction(new cc.shake(.5,30,30)))},nearFriend:function(e){if(!D.commonState.isBattle);},submitScore:function(){var e=D.commonState.gameScore,t=D.commonState.gameDist;c.requestBill(100005,3,100,e,100*t/60,this.enemyGroup.mainLevel,this.gameFightingID);var i={};i.id=D.currHero.id,i.kind=D.currHero.kind,i.subSeq=D.currHero.subSeq,i.level=D.currHero.level,i.tag=(D.currHero&&D.currHero.kind>0?D.currHero.kind:1)+"_"+(D.currHero&&D.currHero.subSeq>0?D.currHero.subSeq:1);c.setAndGetHigthScore(e,function(e){0})},onBtnSpeed:function(){var e=1;this.isAddSpeed?(this.gameSpeed=1,this.isAddSpeed=!1):(this.gameSpeed=1.6,this.isAddSpeed=!0,e=2),cc.director.getScheduler().setTimeScale(this.gameSpeed);var t=this;cc.loader.loadRes("game/icon_game_speed_"+e,cc.SpriteFrame,function(e,i){t.btn_speed.getComponent(cc.Sprite).spriteFrame=i})},dropRedPacket:function(e,t){if(s.redPacketIsDrop(this.enemyGroup.mainLevel,this.level_idx)){console.log("============  dropRedPacket ");var i=this;c.requestShareCfg("redpacket_test",function(o){"s"==o&&(r.redpacketShareCount()>0||r.redpacketVideoCount()>0)&&i.ufoGroup.dropRedPacket(e,t)})}},addRedPacket:function(){if(D.isVoideClose||cc.audioEngine.play(this.soundBtn),!D.commonState.pauseState){this.doGamePause();var e=s.redpacketReason;console.log("--------- main addRedPacket,---reason=",e);var t=a.showPopUpLayer(this.redpacketPrefab).getComponent("redpacketDrop");t&&(t.initWithData(e,this.enemyGroup.mainLevel),t.gameMain=this),s.curLevelDropNum++}}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",bulletGroup:"bulletGroup",common:"common",effGroup:"effGroup",enemyGroup:"enemyGroup",gameUtils:"gameUtils",hero:"hero",pool:"pool",sceneManager:"sceneManager",ufoGroup:"ufoGroup"}],moreGame:[function(e,t,i){"use strict";cc._RF.push(t,"13a35ob+rBLnL+sxjM48CJh","moreGame");e("PlatformUtils");var o=e("common");cc.Class({extends:cc.Component,properties:{scrollview:{type:cc.ScrollView,default:null},nodeGraphics:cc.Node,nodeItem:cc.Node,isInitedView:!1},onLoad:function(){this.scrollview.bounceDuration=.5,this.nodeItem.active=!1;var e=this.nodeGraphics.addComponent(cc.Graphics);e.fillColor=new cc.Color(0,0,0,120),e.fillRect(-this.nodeGraphics.width/2,-this.nodeGraphics.height/2,this.nodeGraphics.width,this.nodeGraphics.height),this.nodeGraphics.addComponent(cc.BlockInputEvents),this.nodeGraphics.active=!1},start:function(){},onDestroy:function(){},initView:function(){if(D.SvrCfgs.nav2&&0!=D.SvrCfgs.nav2.length){for(var e=this.scrollview.content,t=1.2*this.nodeItem.width,i=1.2*this.nodeItem.height,o=-t-20,n=-i/2-20+10,a=1;a<=D.SvrCfgs.nav2.length;a++){var c=cc.instantiate(this.nodeItem);c.active=!0,e.addChild(c),c.position=cc.v2(o,n),c.idx=a,o+=t+20,a%3==0&&(o=-t-20,n=n-i-20+10),this.initItem(c)}e.height=-n+this.nodeItem.height/2}},initItem:function(e){var t=e.getChildByName("Mask").getChildByName("spr_icon");t&&(t.active=!1);var i=D.SvrCfgs.nav2[e.idx-1],n=o.getMoreGameIcon(i),a=D.moreGameBaseUrl+"iconNew/icon"+n+".png";console.log(a),cc.loader.load(a,function(e,i){t&&(t.active=!0,t.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i))});var c=e.getChildByName("txt_name");c&&(c.getComponent(cc.Label).string=D.SvrCfgs.navName[e.idx-1]),e.on(cc.Node.EventType.TOUCH_END,this.onClickItem,this)},onClickItem:function(e){console.log("========== onClickItem---idx="+e.target.idx)},setGraphicsVisible:function(e){this.nodeGraphics.active=e,e&&!this.isInitedView&&(this.initView(),this.isInitedView=!0)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],myeval:[function(e,t,i){"use strict";cc._RF.push(t,"0380bwvDlBH54gkC78N1m75","myeval");var o={isOperator:function(e){return"+-*/()\xd7\xf7".indexOf(e)>-1},getPrioraty:function(e){return"-"==e||"+"==e?1:"*"==e||"/"==e||"\xd7"==e||"\xf7"==e?2:0},prioraty:function(e,t){return this.getPrioraty(e)<=this.getPrioraty(t)},output:function(e){var t=[],i=[],o=[],n=!1;e.replace(/\s/g,""),this.isOperator(e[0])&&(e=e.substring(1),n=!0);for(var a=0,c=e.length;a<c;a++)this.isOperator(e[a])||this.isOperator(e[a-1])||0==a?t.push(e[a]):t[t.length-1]=t[t.length-1]+e[a]+"";for(n&&(t[0]=-t[0]);t.length>0;){var s=t.shift();if(this.isOperator(s))if("("==s)i.push(s);else if(")"==s)for(var r=i.pop();"("!=r&&i.length>0;)o.push(r),r=i.pop();else{for(;this.prioraty(s,i[i.length-1])&&i.length>0;)o.push(i.pop());i.push(s)}else o.push(Number(s))}if(i.length>0)for(;i.length>0;)o.push(i.pop());return o},calExp:function(e){for(var t=[],i=0,o=e.length;i<o;i++)if(this.isOperator(e[i])){var n=t.pop(),a=t.pop();if("-"==e[i])var c=a-n;else if("+"==e[i])c=a+n;else if("*"==e[i]||"\xd7"==e[i])c=a*n;else if("/"==e[i]||"\xf7"==e[i])c=a/n;t.push(c)}else t.push(e[i]);return t[0]},cal:function(e){return this.calExp(this.output(e))}};t.exports=o,cc._RF.pop()},{}],newExplain:[function(e,t,i){"use strict";cc._RF.push(t,"69976s3mDpKraQJneE5OL4d","newExplain");var o=e("common");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){},setCallback:function(e){this.callback=e},onBtnClose:function(){o.removePopUpLayer(this),this.callback&&this.callback()}}),cc._RF.pop()},{common:"common"}],newGifts:[function(e,t,i){"use strict";cc._RF.push(t,"a123aPD8/dEm7rbvSmRQ5qj","newGifts");var o=e("common"),n=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{btnSound:{default:null,type:cc.AudioClip},btn_receive:cc.Button,node_invite:cc.Node,lab_gem:cc.Label,btn_close:cc.Button,isSignNewPlane:!1},onLoad:function(){if(o.iphonexAdapter(this.node),this.node_invite.active=!1,this.initInvite(),D.commonState.heroList)for(var e=0;e<D.commonState.heroList.length;e++){if(4==D.commonState.heroList[e].kind){this.isSignNewPlane=!0;break}}},start:function(){var e=this;n.requestInviteNewList(function(t){e.btn_receive.interactable=1==t.isRecv,e.lab_gem.string="\u94bb\u77f3x"+t.award.qzb,e.setItemData(t)});this.btn_close.node.getComponent(cc.Widget);n.createBannerAd(!0)},initInvite:function(){for(var e=this.node_invite.x,t=this.node_invite.y,i=1;i<=3;i++){var o=cc.instantiate(this.node_invite);o.active=!0,o.idx=i,o.name="itemTag"+i,o.position=cc.v2(e+(i-1)*(o.width+40),t),this.node.addChild(o),o.on(cc.Node.EventType.TOUCH_END,this.onInvite,this)}},setItemData:function(e){if(e){var t=function(e,t){t=null!=t?t:"";var i=e.getChildByName("Mask").getChildByName("spr_icon");i&&cc.loader.load({url:t,type:"png"},function(e,t){i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)})};if(e.list&&!(e.list.length<=0))for(var i=1;i<=e.list.length;i++){var o=this.node.getChildByName("itemTag"+i);o&&t(o,e.list[i-1].headimg)}}},onInvite:function(){this.onBtnSound();var e=o.getShareCfgByType(D.ShareTypeZhuli),t=e.title,i=e.imageUrl,a=n.getUserId();n.shareAppMessage(t,i,"type=shareAward&fromUserId="+a,function(e){e?(o.sysMessage("\u5206\u4eab\u6210\u529f\uff01"),n.requestBill(100007,6,200,1)):n.requestBill(100007,6,200,0)})},onBtnReceive:function(){this.onBtnSound();var e=this;n.requestNewgiftsReceive(function(t){if(t){e.btn_receive.interactable=!1,console.log(t);var i="\u606d\u559c\u60a8\u83b7\u5f97";t.coin&&t.coin>0&&(D.commonState.userGameInfo.coin+=t.coin,i=i+"\u661f\u661fx"+t.coin),t.qzb&&t.qzb>0&&(D.commonState.userGameInfo.qzb+=t.qzb,i=i+",\u94bb\u77f3x"+t.qzb),e.isSignNewPlane||null!=t.hero&&(D.commonState.heroList=null,n.requestHeroList(function(e){}),i+=",\u5c0f\u98de\u673ax1"),t.items&&t.items.length>0&&n.requestItemList(function(e){},!0),console.log(i),o.sysMessage(i),D.commonState.newgiftsList=null}})},onBtnClose:function(){o.removePopUpLayer(this)},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],newGuide:[function(e,t,i){"use strict";cc._RF.push(t,"36159XeXpJGO7xPFyU2kTXW","newGuide");var o=e("common"),n=e("sceneManager");e("PlatformUtils");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.gotoBackGame,this)},gotoBackGame:function(e){this.node.off(cc.Node.EventType.TOUCH_START,this.gotoBackGame,this),o.removePopUpLayer(this);var t=n.isLoadedGame?"Game":"Tmp";n.loadScene(t)},start:function(){}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],pool:[function(e,t,i){"use strict";cc._RF.push(t,"6271bfkKV9FRq5GFLERpqj1","pool");var o={onLoad:function(){},initPoolBatch:function(e,t){for(var i=0;i<t.length;i++){var o=t[i];this.initPool(e,o)}},initPool:function(e,t){var i=t.name+"Pool";if(e[i]=new cc.NodePool,D.poolObjs[i]||(D.poolObjs[i]=e[i]),e[i].length<t.size)for(var o=0;o<t.size;o++){var n=cc.instantiate(t.prefab);e[i].put(n)}},borrowNewNode:function(e,t,i){var o=null;return e.size()>0?(o=e.get()).active=!0:o=cc.instantiate(t),i.addChild(o),o},returnNode:function(e,t){e[t.name+"Pool"].put(t),t.active=!1},clearAllPool:function(){for(var e in D.poolObjs)D.poolObjs[e].clear()}};t.exports=o,cc._RF.pop()},{}],redpacketCrash:[function(e,t,i){"use strict";cc._RF.push(t,"47713isUw9N+pVDUmH4cO6J","redpacketCrash");var o=e("common");cc.Class({extends:cc.Component,properties:{lab_money:cc.Label,btnSound:{default:null,type:cc.AudioClip}},start:function(){this.lab_money.string="\uffe5"+D.commonState.userGameInfo.money;var t=e("PlatformUtils");t.setItemByLocalStorage("PassedMaxLevel",0),t.setItemByLocalStorage("preEedGameLevel",0),t.setItemByLocalStorage("preEedGameLevelCount",0)},onBtnClose:function(){this.onBtnSound(),o.removePopUpLayer(this)},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}],redpacketDrop:[function(e,t,i){"use strict";cc._RF.push(t,"51809caZ5BDsJTckwsp6JjG","redpacketDrop");var o=e("common"),n=e("PlatformUtils"),a=e("StorageUtils");cc.Class({extends:cc.Component,properties:{node_award_bg:cc.Node,node_award:cc.Node,node_open:cc.Node,spr_video:cc.Sprite,lab_award:cc.Label,lab_have:cc.Label,btn_award:cc.Button,spr_have_bg:cc.Sprite,btnSound:{default:null,type:cc.AudioClip}},onLoad:function(){this.node_award.active=!1,this.node_award_bg.active=!1,this.spr_have_bg.node.active=!1,this.lab_have.node.active=!1},start:function(){var e=D.commonState.userGameInfo.money?D.commonState.userGameInfo.money:"0:00";this.lab_have.string="\u4f59\u989d:"+e+"\u5143",this.initState()},initWithData:function(e,t){this.reason=e,this.gameLevel=t},initState:function(){if(!(a.redpacketVideoCount()>0)){var e=this;n.requestShareCfg("redpacket_test",function(t){"s"==t&&a.redpacketShareCount()>0&&(e.changeShareIcon(),e.isShare=!0)})}},changeShareIcon:function(){var e=this;cc.loader.loadRes("redpacket/redpacket",cc.SpriteAtlas,function(t,i){var o=i.getSpriteFrame("redpacket_share");o&&(e.spr_video.spriteFrame=o)})},onBtnOpen:function(){this.onBtnSound();var e=this;n.requestRedpacketReady(this.reason,function(t){e.node_open.active=!1,e.node_award.active=!0,e.node_award_bg.active=!0,e.spr_have_bg.node.active=!0,e.lab_have.node.active=!0,e.money=t.money,e.canGetMoney=t.canGetMoney,e.lab_award.string="\uffe5"+t.money,o.sysMessage("\u606d\u559c\u60a8\u83b7\u5f97"+t.money+"\u5143"),e.spr_video.node.rotation=0,e.spr_video.node.runAction(cc.repeatForever(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(.3,15),cc.rotateTo(.3,-15),cc.rotateTo(.1,0)),2),cc.delayTime(1.5))))})},onBtnAward:function(){if(this.onBtnSound(),this.isShare)this.onShare();else{var e=this;n.requestBill(100008,7,200,0),n.createRewardedVideoAd("redpacket_test",function(){console.log("=========== video back"),n.requestBill(100008,7,200,1),e.reward(),n.setItemByLocalStorage("TodayRedpacketVideoDate",new Date),n.setItemByLocalStorage("RedpacketVideoCount",n.getItemByLocalStorage("RedpacketVideoCount",0)+1)})}},onShare:function(){var e=this,t=o.getShareCfgByType(D.ShareTypeFriend),i=t.title,a=t.imageUrl;n.shareAppMessageCallback(i,a,"",function(t){t?(e.reward(),n.requestBill(100007,16,200,1),n.setItemByLocalStorage("TodayRedpacketShareDate",new Date),n.setItemByLocalStorage("RedpacketShareCount",n.getItemByLocalStorage("RedpacketShareCount",0)+1)):n.requestBill(100007,16,200,0)})},reward:function(){var e=this;n.requestRedpacketAdd(this.reason,this.money,function(t){if(console.log("------- reward",t),D.commonState.userGameInfo.money=t.mymoney,e.lab_have.string="\u4f59\u989d:"+t.mymoney,o.sysMessage("\u5b58\u5165\u6210\u529f"),e.spr_video.node.rotation=0,e.spr_video.node.stopAllActions(),e.btn_award.node.active=!1,e.gameLevel<=3){var i="redpacketAwardLevel"+e.gameLevel;n.setItemByLocalStorage(i,!0)}})},onBtnClose:function(){this.onBtnSound(),o.removePopUpLayer(this),this.gameMain.pauseToStart()},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",common:"common"}],sceneManager:[function(e,t,i){"use strict";cc._RF.push(t,"1fa9crJATVBIpNKFDkixCLK","sceneManager");var o=e("stack"),n={curSceneName:"",preSceneName:"",isLoadedGame:!1,init:function(){D.commonState.sceneStack&&void 0!=D.commonState.sceneStack||(D.commonState.sceneStack=o)},loadScene:function(e){this.init(),D.commonState.sceneStack.push(e),cc.director.loadScene(e),this.preSceneName=this.curSceneName,this.curSceneName=e},gobackLast:function(e){this.init();var t=D.commonState.sceneStack.pop();t?cc.director.loadScene(t):e&&this.loadScene(e)},resetMark:function(){this.init(),D.commonState.sceneStack.clear()}};t.exports=n,cc._RF.pop()},{stack:"stack"}],shareAwardItem:[function(e,t,i){"use strict";cc._RF.push(t,"dad435Ks41MI4DULAWZDkV5","shareAwardItem");var o=e("common"),n=e("PlatformUtils");e("TimeUtils");cc.Class({extends:cc.Component,properties:{sprFriendHeadimg:cc.Sprite,labFriendName:cc.RichText,labAwardCoin:cc.RichText,btnGetAward:cc.Button,btn_get_invite:cc.Button,btnBgGrey:cc.Sprite,awardId:cc.Integer,btnSound:{default:null,type:cc.AudioClip},awardCoinSound:{default:null,type:cc.AudioClip},node_normal:cc.Node},loadData:function(e,t){this.awardId=e.id;var i=e.headimg,n=e.name,a=e.award,c=e.isRecv;null!=i&&o.createImage(i,this.sprFriendHeadimg);var s=1;void 0==n?(n="\u7b2c"+(t+1)+"\u4f4d\u597d\u53cb",s=0):D.commonState.shareFriendNum+=1,this.labFriendName.string="<color=#ffe760>"+n+"</color>",this.labAwardCoin.string="<color=#e6e5f8>"+a+"</color>",1==c?(this.btn_get_invite.node.active=!1,this.btnGetAward.node.getChildByName("apr_bg_yellow").active=!1):1==s?(this.btn_get_invite.node.active=!1,this.btnGetAward.node.getChildByName("spr_bg_grey").active=!1):this.btnGetAward.node.active=!1},onGetAward:function(){this.onBtnSound();var e=this,t=this.btnBgGrey.node;n.requestShareAward(this.awardId,function(i){if(2020!=i)if(2021!=i){e.btnGetAward.node.children[0].getComponent(cc.Sprite).spriteFrame=t.getComponent(cc.Sprite).spriteFrame;var n=i.addCoin;D.commonState.userGameInfo.coin+=n,o.sysMessage("\u606d\u559c\u83b7\u5f97 "+n+" \u661f\u661f!"),e.onAwardCoinSound()}else{o.sysMessage("\u5df2\u7ecf\u9886\u53d6\u8fc7,\u4e0d\u80fd\u91cd\u590d\u9886\u53d6!")}else{o.sysMessage("\u52a9\u529b\u5206\u4eab\u6ca1\u8fbe\u6807!")}})},onInvite:function(){this.onBtnSound();var e=o.getShareCfgByType(D.ShareTypeZhuli),t=e.title,i=e.imageUrl,a=n.getUserId();n.shareAppMessage(t,i,"type=shareAward&fromUserId="+a,function(e){e?(o.sysMessage("\u5206\u4eab\u6210\u529f\uff01"),n.requestBill(100007,6,200,1)):n.requestBill(100007,6,200,0)})},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onAwardCoinSound:function(){D.isVoideClose||cc.audioEngine.play(this.awardCoinSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",TimeUtils:"TimeUtils",common:"common"}],shareAward:[function(e,t,i){"use strict";cc._RF.push(t,"222baXrZNtGSZap4YqgMdV4","shareAward");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils"));cc.Class({extends:cc.Component,properties:{scrollView:{type:cc.ScrollView,default:null},labExtAwardCoin:cc.Label,shareAwardItemPrefab:cc.Prefab,btnSound:{default:null,type:cc.AudioClip},awardCoinSound:{default:null,type:cc.AudioClip}},onLoad:function(){var e=this.scrollView.content,t=this;D.commonState.shareFriendNum=0,n.requestShareAwardList(function(i){i.forEach(function(i,o){var n=cc.instantiate(t.shareAwardItemPrefab),a=n.getComponent("shareAwardItem");a.target=t,a.loadData(i,o),e.addChild(n)}),D.commonState.shareFriendNum>=6&&(cc.director.getScene().getChildByName("Canvas").getChildByName("btn_invite").getChildByName("spr_share_red_point").active=!1),t.scrollView.scrollToTop(.1)})},onShare:function(){this.onBtnSound();var e=o.getShareCfgByType(D.ShareTypeZhuli),t=e.title,i=e.imageUrl,a=n.getUserId();n.shareAppMessage(t,i,"type=shareAward&fromUserId="+a,function(e){e?(o.sysMessage("\u5206\u4eab\u6210\u529f\uff01"),n.requestBill(100007,5,200,1)):n.requestBill(100007,5,200,0)})},onGetExtAward:function(){var e=this;this.onBtnSound(),n.requestShareAward(0,function(t){if(2020!=t)if(2021!=t){var i=t.addCoin,n="\u606d\u559c\u83b7\u5f97, "+i+"\u661f\u661f!";D.commonState.userGameInfo.coin+=i,o.sysMessage(n),e.onAwardCoinSound()}else{o.sysMessage("\u5df2\u7ecf\u9886\u53d6\u8fc7,\u4e0d\u80fd\u91cd\u590d\u9886\u53d6!")}else{o.sysMessage("\u52a9\u529b\u5206\u4eab\u6ca1\u8fbe\u6807!")}})},onBackMain:function(){this.onBtnSound(),o.removePopUpLayer(this)},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onAwardCoinSound:function(){D.isVoideClose||cc.audioEngine.play(this.awardCoinSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],shareItemPkg:[function(e,t,i){"use strict";cc._RF.push(t,"7b6e9RSIINKqomzyZQs8hEz","shareItemPkg");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils"));cc.Class({extends:cc.Component,properties:{labItemID:cc.Label,btnSound:{default:null,type:cc.AudioClip}},onClosePrefab:function(){this.onBtnSound(),o.removePopUpLayer(this),Notification.emit("pauseToStart",this)},onViedo:function(){this.onBtnSound();var e=this;n.requestShareCfg("giftInGame",function(t){"v"==t&&n.createRewardedVideoAd("game",function(){o.sysMessage("\u606d\u559c\u83b7\u5f97\u5206\u4eab\u5927\u793c\u5305\uff01"),o.removePopUpLayer(e),Notification.emit("giveAwayItemPkg",e.labItemID.string),Notification.emit("pauseToStart",e)})})},onLoad:function(){},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],stack:[function(e,t,i){"use strict";cc._RF.push(t,"4a68fPZ9/FCYI6z0Luj27M1","stack");t.exports={vals:[],index:0,push:function(e){this.vals[this.index++]=e},pop:function(){return this.vals[--this.index]},clear:function(){delete this.vals,this.vals=[],this.index=0},isEmpty:function(){return 0==this.index}},cc._RF.pop()},{}],start:[function(e,t,i){"use strict";cc._RF.push(t,"44cfefVxUNO/ZxMfj0BGy8V","start");var o=e("common"),n=e("sceneManager"),a=e("PlatformUtils"),c=e("pool"),s=e("StorageUtils"),r=e("taskUtils");cc.Class({extends:cc.Component,properties:{btnStart:{default:null,type:cc.Button},btn_upgrade:{default:null,type:cc.Button},btnSound:{default:null,type:cc.AudioClip},topPrefab:cc.Prefab,upgradePrefab:cc.Prefab,shareAwardPrefab:cc.Prefab,followAwardPrefab:cc.Prefab,btnShare:cc.Button,sprPlane:cc.Sprite,dailySignInPrefab:cc.Prefab,planeBulSpr:cc.Sprite,planeBulPrefab:cc.Prefab,hallSound:{default:null,type:cc.AudioClip},sprSoundOpen:cc.Sprite,sprSoundClose:cc.Sprite,btn_chuzhan_arrow_right:cc.Sprite,btn_chuzhan_arrow_left:cc.Sprite,nodeGuide:cc.Node,btnMoreGame2:cc.Button,btn_txt_chuzhan:cc.Sprite,btn_txt_5000gm:cc.Sprite,btn_txt_gzjs:cc.Sprite,btn_txt_cz_bg:cc.Sprite,btn_txt_7rlq:cc.Sprite,redPointNode:cc.Node,shareRedPointNode:cc.Node,btn_video:cc.Button,btn_share:cc.Button,btn_moregame_menu:cc.Button,lotteryDrawPrefab:cc.Prefab,lotteryRed:cc.Sprite,btn_newgifts:cc.Button,newGiftsPrefab:cc.Prefab,dailyTaskPrefab:cc.Prefab,friendHelpPrefab:cc.Prefab,spr_task_red:cc.Sprite,battlePrefab:cc.Prefab,node_redpacket:cc.Node,node_notice_item:cc.Node,lab_redpacket:cc.Label,richtext_award:cc.RichText,redpacketCrashPrefab:cc.Prefab},queryDeal:function(e){if(e)switch(console.log("queryDeal=",JSON.stringify(e)),e.type){case"shareAward":this.onFromRewardShare(e.fromUserId);break;case"shareUnlock":this.onFromUnlockShare(e.fromUserId);break;case"shareQzb":this.onFromQzbShare(e.fromUserId);break;case"shareHelp":this.onFromRewardShareTips(e.fromUserId);break;case"shareBattle":this.onFromBattleShare(e.fromUserId)}},onLoad:function(){D.curSceneName="Start",this.btn_txt_chuzhan.node.active=!1,this.btn_txt_5000gm.node.active=!1,this.btn_txt_gzjs.node.active=!1,this.btn_txt_cz_bg.node.active=!1,this.btn_txt_7rlq.node.active=!1,o.hideLoading(),o.clearPopLayer();var e=this;if(console.log("start onLoad......................."),c.initPool(this,this.planeBulPrefab.data),Device.needOffsetPixel()){var t=this.node.getChildByName("btn_node").getComponent(cc.Widget);t&&(t.top=t.top+70),this.node_redpacket.getComponent(cc.Widget).top+=70}this.btn_upgrade.node.setScale(-1,1);e.btnShare.node.position.x;this.btnShare.node.active=!1,D.isVoideClose?(this.sprSoundOpen.node.opacity=0,this.sprSoundClose.node.opacity=255):(this.sprSoundOpen.node.opacity=255,this.sprSoundClose.node.opacity=0),a.requestShareCfg("giftInMain",function(t){t?(e.btnShare.node.active=!0,e.btn_share.node.active=!0):e.btnShare.node.active=!1}),this.btn_share.node.active=!1,this.btn_video.node.active=!1,a.requestShareCfg("shareAwardInMain,videoAwardInMain",function(t){"s"==t.shareAwardInMain?e.btn_share.node.active=!0:"v"==t.videoAwardInMain&&(e.btn_video.node.active=!0)}),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.btn_chuzhan_arrow_right.node.on(cc.Node.EventType.TOUCH_START,this.touchRight,this),this.btn_chuzhan_arrow_left.node.on(cc.Node.EventType.TOUCH_START,this.touchLeft,this),this.movePlane(this.sprPlane.node.y),a.requestHeroList(function(t){t.forEach(function(e){2==e.status&&console.log("\u51fa\u6218",e)}),D.currHero||console.log(" curr hero is null..."),console.log("D.currHero",JSON.stringify(D.currHero));var i=D.currHero?D.currHero.kind:1,o=D.currHero.subSeq?D.currHero.subSeq:1;D.currHero.level&&D.currHero.level;e.onUpdatePlaneBulletLevel(i,o)}),D.commonState.shareFriendNum>=6&&(this.shareRedPointNode.active=!1),D.SvrCfgs.nav2&&0!=D.SvrCfgs.nav2.length||(this.btn_moregame_menu.node.active=!1),this.replayBackgroupMusic(),this.initShareAndVideo(),this.initkSign(),this.initUpgrade(),this.initLotteryRed(),this.initNewGifts(),this.initMoreGame2(),this.initRedpacket()},initkSign:function(){console.log("---------- initkSign");var e=this;a.requestGameInfo(function(t){D.commonState.userGameInfo.coin=t.coin,D.commonState.userGameInfo.qzb=t.qzb;var i=D.commonState.userGameInfo?D.commonState.userGameInfo.money:"0:00";if(e.lab_redpacket.string="\uffe5"+i,e.redPointNode.active=!1,a.getItemByLocalStorage("todayCanSign",!0)&&!D.isAutoPopedDailySign)e.redPointNode.active=!0,e.onBtnSignIn(null,!0),D.isAutoPopedDailySign=!0;else{var o=a.getItemByLocalStorage("signTime");if("undefined"!=o){var n=new Date(o),c=new Date,s=n.getDate(),r=n.getMonth(),l=n.getFullYear(),d=c.getDate(),u=c.getMonth();if(l==c.getFullYear()&&r==u&&s==d||D.isAutoPopedDailySign)if(a.getItemByLocalStorage("signShare")||D.commonState.signShare||D.isAutoPopedDailySign){if(a.getItemByLocalStorage("signShare")&&!D.commonState.signShare){D.commonState.signShare=!0;var h=new Date(a.getItemByLocalStorage("signShare")),m=new Date,p=h.getDate(),f=h.getMonth(),g=h.getFullYear(),v=m.getDate(),y=m.getMonth();g==m.getFullYear()&&f==y&&p==v||D.isAutoPopedDailySign||(e.redPointNode.active=!0,e.onBtnSignIn(null,!0),D.isAutoPopedDailySign=!0)}}else D.commonState.signShare=!0,e.redPointNode.active=!0,e.onBtnSignIn(null,!0),D.isAutoPopedDailySign=!0;else e.redPointNode.active=!0,e.onBtnSignIn(null,!0),D.isAutoPopedDailySign=!0}}})},initUpgrade:function(){if("Game"==n.preSceneName){var e=0;a.requestGameInfo(function(t){e=t.coin});var t=o.getJsonCfgs("hero"),i=!1;a.requestHeroList(function(o){o.every(function(o){if((1==o.status||2==o.status)&&(i=function(i){var o=!1;if(!t||0==t.length)return o;for(var n=0;n<t.length;n++){var a=t[n];if(i.id==a.id){i.powerLevel>0&&i.powerLevel;var c=a.powerNeed+a.powerNeedIncr*(i.powerLevel-1);if(e>=c){o=!0;break}i.bloodLevel>0&&i.bloodLevel;var s=a.bloodNeed+a.bloodNeedIncr*(i.bloodLevel-1);if(e>=s){o=!0;break}i.attackSpeedLevel>0&&i.attackSpeedLevel;var r=a.attackSpeedNeed+a.attackSpeedNeedIncr*(i.attackSpeedLevel-1);if(e>=r){o=!0;break}}}return o}(o)))return!1})}),i&&(this.gotoUpgrade(),o.sysMessage("\u60a8\u53ef\u4ee5\u5347\u7ea7\u98de\u673a\uff0c\u5feb\u901f\u63d0\u5347\u5b9e\u529b\u5566\uff01"))}},initLotteryRed:function(){var e=D.lotteryFreeDrawCount-s.lotteryFreeCount(),t=s.lotteryFreeTime(),i=e>0&&0==t,o=a.lotteryVideoCount(),n=Math.floor(Date.now()/1e3)-a.getItemByLocalStorage("LotteryVideoPreTime",0);n=n>s.lotteryVideoDelay?0:s.lotteryVideoDelay-n;var c=i||o>0&&0==n;this.lotteryRed.node.active=c},initNewGifts:function(){this.btn_newgifts.node.active=!1;var e=this;a.requestShareCfg("newGifts",function(t){"s"==t&&(e.btn_newgifts.node.active=!0)})},initMoreGame2:function(){if(D.SvrCfgs.cgnav&&0!=D.SvrCfgs.cgnav.length){var e=this,t=function(){var t=D.moreGameBaseUrl+"icon2/icon"+e.btnMoreGame2.icon+".png";cc.loader.load(t,function(t,i){e.btnMoreGame2.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)})};e.btnMoreGame2.node.active=!0,e.btnMoreGame2.node.rotation=0,e.btnMoreGame2.count=0,e.btnMoreGame2.icon=1,t(),e.btnMoreGame2.node.runAction(cc.repeatForever(cc.sequence(cc.repeat(cc.sequence(cc.rotateBy(.3,15),cc.rotateBy(.3,-15)),2),cc.delayTime(1.5),cc.callFunc(function(){e.btnMoreGame2.count+=1,e.btnMoreGame2.count%2==0&&(e.btnMoreGame2.icon+=1,e.btnMoreGame2.icon>D.SvrCfgs.cgnav.length&&(e.btnMoreGame2.icon=1),t())},e))))}else this.btnMoreGame2.node.active=!1},touchEnd:function(e){console.log("touchEnd");var t=e.touch.getDelta();console.log("touchMove2.x......................",t.x);var i=e.touch._startPoint,o=e.touch._point.x-i.x;if(o>0&&Math.abs(o)>100)this.currSHowHeroKind--;else{if(!(o<0&&Math.abs(o)>100))return;this.currSHowHeroKind++}this.checkShowHero()},touchRight:function(){this.currSHowHeroKind--,this.checkShowHero()},touchLeft:function(){this.currSHowHeroKind++,this.checkShowHero()},checkShowHero:function(){this.currSHowHeroKind>4?this.currSHowHeroKind=1:this.currSHowHeroKind<1&&(this.currSHowHeroKind=4);var e=null;if(D.commonState.heroList)for(var t=0;t<D.commonState.heroList.length;t++){var i=D.commonState.heroList[t];if(i.kind==this.currSHowHeroKind){e=i;break}}this.currSHowHeroIdx=e?e.subSeq:1,this.currSHowHeroIdx<=0&&(this.currSHowHeroIdx=1),this.setPlane(this.currSHowHeroKind,this.currSHowHeroIdx),this.onPlaneBullet(this.currSHowHeroKind,this.currSHowHeroIdx)},start:function(){console.log("start start......................."),a.requestBill(100002,1,100),Notification.on("remove_all_poplayer",this.onRemoveAllPoplayer,this)},onDestroy:function(){Notification.off("remove_all_poplayer",this.onRemoveAllPoplayer),this.btn_video.isSchedule&&this.unschedule(this.videoTimeTicket)},setPlane:function(e,t){var i="plane/plane_"+e+"_"+t,o=this;if(console.log(i),cc.loader.loadRes(i,cc.SpriteFrame,function(e,t){o.sprPlane.spriteFrame=t}),this.currSHowHeroKind=e,this.currSHowHeroIdx=t,void 0!=this.btn_txt_chuzhan&&null!=this.btn_txt_chuzhan&&this.btn_txt_chuzhan.node){for(var n=0;n<D.commonState.heroList.length;n++){if(D.commonState.heroList[n].kind==this.currSHowHeroKind)return this.btn_txt_chuzhan.node.active=!0,this.btn_txt_5000gm.node.active=!1,this.btn_txt_gzjs.node.active=!1,this.btn_txt_7rlq.node.active=!1,void(this.btn_txt_cz_bg.node.active=!1)}this.btn_txt_chuzhan.node.active=!1,this.btn_txt_5000gm.node.active=!1,this.btn_txt_gzjs.node.active=!1,this.btn_txt_7rlq.node.active=!1,this.btn_txt_cz_bg.node.active=!1,2==this.currSHowHeroKind?(this.btn_txt_gzjs.node.active=!0,this.btn_txt_cz_bg.node.active=!0):3==this.currSHowHeroKind?(this.btn_txt_5000gm.node.active=!0,this.btn_txt_cz_bg.node.active=!0):4==this.currSHowHeroKind&&(this.btn_txt_7rlq.node.active=!0,this.btn_txt_cz_bg.node.active=!0)}},movePlane:function(e){var t=cc.moveTo(3,cc.v2(this.sprPlane.node.x,e+40)).easing(cc.easeCubicActionIn()),i=cc.moveTo(3,cc.v2(this.sprPlane.node.x,e-40)).easing(cc.easeCubicActionOut()),o=cc.repeatForever(cc.sequence(t,i));this.sprPlane.node.runAction(o),this.sprPlane.node.setScale(1.3,1.3)},onFromRewardShare:function(e){a.requestonFromRewardShare(e)},onFromRewardShareTips:function(e){a.requestonFromHelpShare(e,function(e){o.sysMessage("\u4f60\u5e2e\u4e86"+e.name+"\u5927\u5fd9\uff0c\u52a9\u529b\u6210\u529f!")})},onFromBattleShare:function(e){this.onBtnBattle({fromUserId:e})},onFromUnlockShare:function(e){},onFromQzbShare:function(e){a.requestAddQzbFriend(e)},onFollowThisApp:function(){var e=this;a.requestFollowAward(function(t){e.checkShowHero()},this)},gotoGroupRank:function(e){D.commonState.shareTicket=e,this.gotoTop()},gotoStartGame:function(){for(var e=0;e<D.commonState.heroList.length;e++){var t=D.commonState.heroList[e];if(t.kind==this.currSHowHeroKind)return t.status=2,D.currHero=t,void this.toGame()}if(2==this.currSHowHeroKind)this.gotoFollow();else if(3==this.currSHowHeroKind){var i=this;if(D.commonState.userGameInfo.coin<5e3)return void o.sysMessage("\u60a8\u7684\u661f\u661f\u6570\u91cf\u4e0d\u8db3");a.requestNewHeroUseCoin(this.currSHowHeroKind,function(e){if(e.hero){for(var t=0;t<D.commonState.heroList.length;t++){if(D.commonState.heroList[t].kind==this.currSHowHeroKind)return}D.commonState.heroList.push(e.hero),i.checkShowHero()}})}},toGame:function(){var e=function(){a.requestBill(100002,2,200),D.isVoideClose||(cc.audioEngine.stop(D.commonState.hallAudioID),D.commonState.hallAudioID=0,cc.audioEngine.play(this.btnSound)),this.node.stopAllActions(),a.hideWxLayer();var e=n.isLoadedGame?"Game":"Tmp";n.loadScene(e)},t=this;cc.loader.loadRes("prefabs/beginFight",function(i,n){a.hideWxLayer();var c=o.showPopUpLayer(n,null,null,null,function(){a.showWxLayer()}).getComponent("beginFight");c&&c.setCallBack(e,t.currSHowHeroKind)})},gotoUpgrade:function(){a.requestBill(100002,3,200),this.onBtnSound(),this.node.stopAllActions(),a.hideWxLayer();var e=o.showPopUpLayer(this.upgradePrefab,null,null,null,function(){a.showWxLayer()}).getComponent("upgrade");if(e){var t=this.currSHowHeroKind-1<0?0:this.currSHowHeroKind-1;e.setCurPageIndex(t)}},gotoTop:function(){a.requestBill(100002,4,200),this.onBtnSound(),a.hideWxLayer(),o.showPopUpLayer(this.topPrefab,null,null,null,function(){a.showWxLayer()})},onBtnInvite:function(){a.requestBill(100002,5,200),this.onBtnSound(),a.hideWxLayer(),o.showPopUpLayer(this.shareAwardPrefab,null,null,null,function(){a.showWxLayer()})},gotoFollow:function(){a.requestBill(100002,6,200),this.onBtnSound(),a.hideWxLayer(),o.showPopUpLayer(this.followAwardPrefab,null,null,null,function(){a.showWxLayer()})},gotoMoreGame:function(){a.requestBill(100002,7,200),wx.offHide(),this.onBtnSound()},playBackgroupMusic:function(){cc.audioEngine.stopAll(),D.commonState.hallAudioID=cc.audioEngine.play(this.hallSound,!0,.3)},replayBackgroupMusic:function(){0==D.commonState.hallAudioID||void 0==D.commonState.hallAudioID?D.commonState.hallAudioID=cc.audioEngine.play(this.hallSound,!0,.3):cc.audioEngine.play(D.commonState.hallAudioID)},onCloseVoide:function(){D.isVoideClose?(cc.audioEngine.resumeAll(),cc.audioEngine.resumeMusic(),D.isVoideClose=!1,this.sprSoundOpen.node.opacity=255,this.sprSoundClose.node.opacity=0):(cc.audioEngine.pauseAll(),cc.audioEngine.pauseMusic(),D.isVoideClose=!0,this.sprSoundOpen.node.opacity=0,this.sprSoundClose.node.opacity=255),D.isVoideClose||(0!=D.commonState.hallAudioID?cc.audioEngine.play(D.commonState.hallAudioID):D.commonState.hallAudioID=cc.audioEngine.play(this.hallSound,!0,.3))},onPlaneBullet:function(e,t){if(e>=2){this.startShoot=function(){this.onPlaneBullet2(e,t)};var i=7;3==e?i=2:4==e&&(i=5);var o=cc.delayTime(1/i),n=cc.callFunc(this.startShoot,this),a=cc.repeatForever(cc.sequence(o,n));this.planeBulSpr.node.stopAllActions(),this.planeBulSpr.node.runAction(a)}else 1==e&&this.onPlaneBullet1(e,t)},onPlaneBullet1:function(e,t){t>5&&(t=5);var i="bullet/bullet_"+e+"_"+t;this.startShoot=function(){var e=cc.v2(this.sprPlane.node.x,this.sprPlane.node.y-40),t=this.planeBulPrefab.data.name+"Pool",i=c.borrowNewNode(this[t],this.planeBulPrefab.data,this.planeBulSpr.node);i.moveRotation=0,i.setPosition(e)};o.getJsonCfgs("hero").forEach(function(i){i.kind==e&&i.subSeq==t&&i});var n=cc.delayTime(1/7),a=cc.callFunc(this.startShoot,this),s=cc.repeatForever(cc.sequence(n,a));this.planeBulSpr.node.stopAllActions();var r=this;cc.loader.loadRes(i,cc.SpriteFrame,function(e,t){r.planeBulPrefab.data.getComponent(cc.Sprite).spriteFrame=t,r.planeBulSpr.node.runAction(s)})},onPlaneBullet2:function(e,t){2==e?this.startShoot_2(e,t):3==e?this.startShoot_3(e,t):4==e&&this.startShoot_4(e,t)},startShoot_2:function(e,t){this.shootCount||(this.shootCount=0),5==t?(this.shootCount%2==0?(this.makeNewBullet(1,-15,-50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,-50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,15,50,-20,"bullet/bullet_new_2_1")):(this.makeNewBullet(1,0,-50,-20,"bullet/bullet_new_2_2"),this.makeNewBullet(1,0,50,-20,"bullet/bullet_new_2_2")),this.makeNewBullet(2,0,0,-20,"bullet/bullet_new_2_4")):1==t?(this.makeNewBullet(1,-5,0,-50,"bullet/bullet_new_2_1"),this.makeNewBullet(1,5,0,-50,"bullet/bullet_new_2_1")):2==t?this.shootCount%2==0?(this.makeNewBullet(1,-10,-50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,0,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,10,50,-20,"bullet/bullet_new_2_1")):this.makeNewBullet(1,0,0,-20,"bullet/bullet_new_2_2"):3==t?this.shootCount%2==0?(this.makeNewBullet(1,-15,-50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,-30,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,30,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,15,50,-20,"bullet/bullet_new_2_1")):(this.makeNewBullet(1,0,-30,-20,"bullet/bullet_new_2_2"),this.makeNewBullet(1,0,30,-20,"bullet/bullet_new_2_2")):4==t&&(this.shootCount%2==0?(this.makeNewBullet(1,-15,-50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,-50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,0,50,-20,"bullet/bullet_new_2_1"),this.makeNewBullet(1,15,50,-20,"bullet/bullet_new_2_1")):(this.makeNewBullet(1,0,-50,-20,"bullet/bullet_new_2_2"),this.makeNewBullet(1,0,50,-20,"bullet/bullet_new_2_2")),this.makeNewBullet(1,0,0,-20,"bullet/bullet_new_2_3")),this.shootCount++},startShoot_3:function(e,t){this.shootCount||(this.shootCount=0);var i=this,o=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=0;n<10;n++){var a=Math.PI/180*36*n,c=65*Math.cos(a),s=65*Math.sin(a);a%Math.PI==0&&(s=0),i.makeNewBullet(1,o,c+e,s+t,"bullet/bullet_new_3_1",800)}},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=i.makeNewBullet(1,o,0,-30,"bullet/bullet_new_3_2");a.stopMove=!0;var c=cc.moveBy(n,cc.v2(e,t)),s=cc.callFunc(function(){a.stopMove=!1});a.runAction(cc.sequence(c,s))};5==t?(o(0,0,-10),o(0,0,10),n(-120,-80,2),n(120,-80,2),n(-80,-30,1),n(80,-30,1)):1==t?o(0,0,0):2==t?(o(0,0,0),n(-100,-80),n(100,-80)):3==t?(o(0,0,-10),o(0,0,10)):4==t&&(o(0,0,-10),o(0,0,10),n(-120,-80,2),n(120,-80,2)),this.shootCount++},startShoot_4:function(e,t){this.shootCount||(this.shootCount=0);this.ddddd||(this.ddddd=1,this.shootCount=0),this.shootCount+=this.ddddd,this.shootCount>=10?(this.ddddd=-1,this.shootCount=10):this.shootCount<0&&(this.ddddd=1,this.shootCount=0);var i=3*this.shootCount;this.makeNewBullet(1,0,-25-1*i,-50,"bullet/bullet_new_4_1",800),this.makeNewBullet(1,0,-1*i,-50,"bullet/bullet_new_4_2",800),this.makeNewBullet(1,0,25+i,-50,"bullet/bullet_new_4_1",800),this.makeNewBullet(1,0,i,-50,"bullet/bullet_new_4_2",800)},makeNewBullet:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1500,a=cc.v2(this.sprPlane.node.x,this.sprPlane.node.y);a.y=a.y+50;var c=this.planeBulPrefab.data.name+"Pool",s=this.creatreBullet(c,a,o);return s.x+=t,s.y+=i,s.speed=n,s.moveRotation=e,s},creatreBullet:function(e,t,i){var o=c.borrowNewNode(this[e],this.planeBulPrefab.data,this.planeBulSpr.node);if(o.setPosition(t),o.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW,this.bulletObj||(this.bulletObj={}),this.bulletObj[i])o.getComponent(cc.Sprite).spriteFrame=this.bulletObj[i];else{var n=this;cc.loader.loadRes(i,cc.SpriteFrame,function(e,t){n.bulletObj[i]=t,o.getComponent(cc.Sprite).spriteFrame=n.bulletObj[i]})}return o},onUpdatePlaneBulletLevel:function(e,t){this.node.stopAllActions(),this.currSHowHeroKind=e,this.currSHowHeroIdx=t,this.checkShowHero()},update:function(e){for(var t=this.planeBulSpr.node.children,i=new Array,o=0;o<t.length;o++){var n=t[o];if("planeBullet"==n.name&&!n.stopMove){var a=n.speed;a||(a=1500);var c=this.sprPlane.node.y+800;if(n.y>c)i.push(n);else{var s=e*a,r=s*Math.cos(Math.PI/180*n.moveRotation),l=s*Math.sin(Math.PI/180*n.moveRotation);n.rotation=n.moveRotation,n.x+=l,n.y+=r}}}for(var d=0;d<i.length;d++){var u=i[d];this.planeBulSpr.node.removeChild(u)}},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onBtnSignIn:function(e,t){if(this.isShareBattle)this.isShareBattle=!1;else{a.hideWxLayer();var i=o.showPopUpLayer(this.dailySignInPrefab);i.position=cc.v2(cc.winSize.width/2,cc.winSize.height/2);var n=this;if(t){var c=i.getComponent("dailySignIn");c&&c.setCallback(function(){a.lotteryVideoCount()>0&&n.onBtnLottery()})}}},onBtnLottery:function(){this.onBtnSound(),a.hideWxLayer(),o.showPopUpLayer(this.lotteryDrawPrefab)},onGameService:function(){0},guideStrength:function(){var e=this;this.nodeGuide.stopAllActions();var t=cc.callFunc(function(){var t=e.nodeGuide.getChildByName("point"),i=e.nodeGuide.getChildByName("line1"),o=e.nodeGuide.getChildByName("line2"),n=0;t&&(t.active=!0,t.scale=0,t.stopAllActions(),t.runAction(cc.scaleTo(.4,1)),n+=.4),i&&(i.active=!0,i.scaleY=0,i.stopAllActions(),i.runAction(cc.sequence(cc.delayTime(n),cc.scaleTo(.4,1,1))),n+=.4),o&&(o.active=!0,o.scaleY=0,o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(n),cc.scaleTo(.4,1,1))),n+=.4)},this),i=cc.delayTime(1.6),o=cc.callFunc(function(){var t=e.nodeGuide.getChildByName("point"),i=e.nodeGuide.getChildByName("line1"),o=e.nodeGuide.getChildByName("line2");t.active=!1,i.active=!1,o.active=!1,e.btn_upgrade.node.stopAllActions(),e.btn_upgrade.node.runAction(cc.sequence(cc.scaleTo(.5,1.2),cc.delayTime(.1),cc.scaleTo(.5,1)))},this),n=cc.delayTime(1.5);this.nodeGuide.runAction(cc.repeatForever(cc.sequence(t,i,o,n)))},onMoreGame2:function(){},initShareAndVideo:function(){var e=function(e,t,i){var o=e.getChildByName("sp_redpoint");o.active=!0,o.getChildByName("lab_num").getComponent(cc.Label).string=String(t),e.stopAllActions(),e.rotation=0,i?e.runAction(cc.repeatForever(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(.3,15),cc.rotateTo(.3,-15),cc.rotateTo(.1,0)),2),cc.delayTime(1.5)))):o.active=!1};if(1==this.btn_share.node.active){var t=a.isTodayWxAwardShareBeyond(),i=D.wxAwardShareMaxNum-a.getItemByLocalStorage("TodayWxAwardShareCnt",0);e(this.btn_share.node,i,t)}if(this.btn_video.node.active){a.isTodayWxVideoBeyond();var n=D.wxVideoMaxNum-a.getItemByLocalStorage("TodayWxVideoCnt",0),c=a.getItemByLocalStorage("TodayStartVodieDate");if(c){var s=new Date(c);o.isSameDay(s)||a.setItemByLocalStorage("TodayStartVodieCount",0)}var r=2-a.getItemByLocalStorage("TodayStartVodieCount",0),l=(n=Math.min(n,r))>0,d=a.getItemByLocalStorage("createRewardedVideoAdTime",0),u=Math.floor(Date.now()/1e3)-d;if(u<20&&l)return this.videoTimeCountDown(20-u),this.btn_video.node.rotation=0,this.btn_video.node.stopAllActions(),this.btn_video.interactable=!1,void(this.btn_video.node.getChildByName("sp_redpoint").getChildByName("lab_num").getComponent(cc.Label).string=String(n));this.btn_video.interactable=!0,this.btn_video.node.getChildByName("txt_time").active=!1,this.btn_video.node.getChildByName("spr_desc").active=!0,e(this.btn_video.node,n,l),l||(this.btn_video.interactable=!1)}},onShareGetCoin:function(){var e=this,t=o.getShareCfgByType(D.ShareTypeFriend),i=t.title,n=t.imageUrl;a.shareAppMessageCallback(i,n,"",function(t){a.isTodayWxAwardShareBeyond()?1==t?(a.requestAddCoin(D.AwardCoinShare,D.ReasonAddCoinShare,function(t){e.initShareAndVideo()}),o.sysMessage("\u5206\u4eab\u83b7\u5f97 "+D.AwardCoinShare+" \u661f\u661f\uff01"),a.requestBill(100007,12,200,1),a.setTodayWxAwardShare()):a.requestBill(100007,12,200,0):o.sysMessage("\u60a8\u4eca\u65e5\u9886\u53d6\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650\uff0c\u8bf7\u660e\u5929\u518d\u6765\uff01")})},onVideoGetCoin:function(){if(a.isTodayWxVideoBeyond()){console.log("=========== start.onVideoGetCoin  111111 "),a.requestBill(100008,4,200,0);var e=this;a.createRewardedVideoAd("dating",function(t){a.requestAddCoin(D.AwardCoinVideo,D.ReasonAddCoinVideo,function(e){}),a.requestBill(100008,4,200,1),a.setTodayWxVideo(),o.sysMessage("\u606d\u559c\u60a8\u9886\u53d6\u4e86"+D.AwardCoinVideo+"\u661f\u661f"),a.setItemByLocalStorage("createRewardedVideoAdTime",Math.floor(Date.now()/1e3)),a.setItemByLocalStorage("TodayStartVodieCount",a.getItemByLocalStorage("TodayStartVodieCount",0)+1),a.setItemByLocalStorage("TodayStartVodieDate",new Date),e.initShareAndVideo()})}else o.sysMessage("\u60a8\u4eca\u65e5\u9886\u53d6\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650\uff0c\u8bf7\u660e\u5929\u518d\u6765\uff01")},videoTimeCountDown:function(e){this.btn_video.isSchedule||(this.btn_video.delayTime=e,this.schedule(this.videoTimeTicket,1,e),this.btn_video.isSchedule=!0,this.btn_video.node.getChildByName("spr_desc").active=!1,this.videoTimeTicket())},videoTimeTicket:function(){var e=this.btn_video.node.getChildByName("txt_time");if(this.btn_video.delayTime<=0)return e&&(e.active=!1),this.btn_video.isSchedule=!1,this.unschedule(this.videoTimeTicket),void this.initShareAndVideo();if(this.btn_video.delayTime-=1,e){e.active=!0;var t=this.btn_video.delayTime>=10?"00:":"00:0";e.getComponent(cc.Label).string=t+this.btn_video.delayTime}},onRemoveAllPoplayer:function(){this.initShareAndVideo(),this.initLotteryRed(),a.createBannerAd()},onMoregameMenu:function(){if(!this.btn_moregame_menu.opening){this.onBtnSound();var e=this,t=function(){e.btn_moregame_menu.opening=!1;var t=e.btn_moregame_menu.node.x>0?-1:1,i=e.btn_moregame_menu.node.getChildByName("spr_arrow");i&&(i.scaleX=t)},i=function(t){if(t){var i=t.getComponent("moreGame");e.btn_moregame_menu.node.x<0?t.active=!1:i&&i.setGraphicsVisible(!0)}},o=function(o){e.btn_moregame_menu.node.stopAllActions(),o.stopAllActions();var n=e.btn_moregame_menu.node.x<0?490:-490,a=cc.moveBy(.45,cc.v2(n,0)),c=cc.callFunc(t,e),s=cc.moveBy(.45,cc.v2(n,0)),r=cc.callFunc(i,e);if(e.btn_moregame_menu.node.runAction(cc.sequence(a,c)),o.runAction(cc.sequence(s,r)),e.btn_moregame_menu.node.x>0){var l=o.getComponent("moreGame");l&&l.setGraphicsVisible(!1)}},n=this.node.getChildByName("moregameTag");if(n)return n.active=!0,o(n),void(this.btn_moregame_menu.opening=!0);cc.loader.loadRes("prefabs/moreGame",function(t,i){if(!e.node.getChildByName("moregameTag")){var n=cc.instantiate(i);e.node.addChild(n),n.x=-490,n.name="moregameTag",n.zIndex=1e3,e.btn_moregame_menu.node.zIndex=1001,o(n),e.btn_moregame_menu.opening=!0;var a=e.btn_moregame_menu.node.getChildByName("spr_red");a&&(a.active=!1)}})}},onBtnNewgifts:function(){this.onBtnSound(),a.hideWxLayer(),o.showPopUpLayer(this.newGiftsPrefab)},onBtnDailytask:function(){this.onBtnSound();var e=this;a.hideWxLayer();var t=o.showPopUpLayer(this.dailyTaskPrefab).getComponent("dailyTask");t&&t.setCallback(function(t){switch(t){case"battle":if(2==e.currSHowHeroKind||3==e.currSHowHeroKind){var i=D.commonState.heroList[0];i.status=2,D.currHero=i,e.toGame()}else e.gotoStartGame();break;case"invite":e.onBtnInvite();break;case"upgrade":e.gotoUpgrade()}},function(){r.isRed()||(e.spr_task_red.node.active=!1)})},onBtnFriendHelp:function(){this.onBtnSound(),a.hideWxLayer(),o.showPopUpLayer(this.friendHelpPrefab,null,null,null,function(){a.showWxLayer()})},onBtnBattle:function(e){this.onBtnSound();var t=a.getUserId();e&&e.fromUserId&&(t=e.fromUserId),a.hideWxLayer();var i=o.showPopUpLayer(this.battlePrefab,null,null,null,function(){a.showWxLayer()}).getComponent("battleLayer");i&&i.requestData(t,!1)},initRedpacket:function(){this.node_redpacket.active=!1;var e=this;a.requestShareCfg("redpacket_test",function(t){"s"==t&&e.openRedpacket()})},openRedpacket:function(){this.node_redpacket.active=!0,this.node_notice_item.active=!1,this.noticeIdx=0;var e=this;a.requestNotice(function(t){(function t(){if(D.commonState.notice&&0!=D.commonState.notice.length){e.node_notice_item.active=!0,e.noticeIdx=e.noticeIdx>D.commonState.notice.length-1?0:e.noticeIdx;var i=D.commonState.notice[e.noticeIdx],o=20+Math.floor(2*Math.random()*100)/100;e.richtext_award.string="<color=#ffffff>\u606d\u559c:</c><color=#ffef4b>"+i+"</c><color=#ffffff>\u6210\u529f\u63d0\u53d6</c><color=#ffef4b><size=28>"+o+"\u5143</size></color>",e.node_notice_item.stopAllActions();var n=e.richtext_award.node.width+100;e.node_notice_item.x=e.node_redpacket.x+n;var a=cc.moveBy(8,cc.v2(2*-n-200,0)),c=cc.callFunc(function(){e.noticeIdx++,t()},e);e.node_notice_item.runAction(cc.sequence(a,c))}})()})},onBtnRedpacket:function(){this.onBtnSound(),a.hideWxLayer();o.showPopUpLayer(this.redpacketCrashPrefab,null,null,null,function(){a.showWxLayer()})}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",common:"common",pool:"pool",sceneManager:"sceneManager",taskUtils:"taskUtils"}],sysMessage:[function(e,t,i){"use strict";cc._RF.push(t,"8f13dKL0pRFSqgJxi9+4hCQ","sysMessage"),cc.Class({extends:cc.Component,properties:{txtTips:cc.RichText},onTips:function(e,t,i,o){null==i&&(i="#ffffff");this.txtTips.string="<color="+i+"><b>"+t+"</b></color>",cc.director.getScene().addChild(e),e.zIndex=8888;var n=cc.v2(360,.6*cc.winSize.height);o&&(n.x+=o.x,n.y+=o.y),e.position=n;var a=cc.v2(0,60),c=cc.fadeIn(.2),s=cc.delayTime(1),r=cc.moveBy(.8,a),l=cc.fadeOut(1);e.runAction(cc.sequence(c,s,r,l));this.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){e.parent&&e.parent.removeChild(e)})))}}),cc._RF.pop()},{}],taskUtils:[function(e,t,i){"use strict";cc._RF.push(t,"d3504gVahJEp4JlBwLNavvc","taskUtils");var o=e("common"),n=e("PlatformUtils"),a=e("HttpUtils"),c={TaskType:{COIN:1,FLY_KM:3,INVITE_SUC:5,UPGRADE_COST:6,BATTLE_NUM:7},data:[],requestTaskList:function(e){var t=this;a.post(D.UrlDomain+"/task/list",{Authorization:n.getUserSkey(),Version:D.Versioin},{},function(i){if(-1!==i&&0==i.code){console.log(i.data);var o=t.setTaskList(i.data);console.log("list:",o),e&&e(o)}})},requestTaskReceive:function(e,t){a.post(D.UrlDomain+"/task/recv?taskId="+e,{Authorization:n.getUserSkey(),Version:D.Versioin},{},function(e){-1!==e&&0==e.code&&(console.log(e.data),t&&t(e.data))})},requestTaskDo:function(e,t){var i=this;a.get(D.UrlDomain+"/task/do-it?taskId="+e+"&num="+t,{Authorization:n.getUserSkey(),Version:D.Versioin},function(e){-1!==e&&0==e.code&&(console.log(e.data),i.updateTaskList(e.data.taskId,e.data))})},setTaskList:function(e){return this.data=e||[],this.data},updateTaskList:function(e,t){for(var i=0;i<this.data.length;i++){var o=this.data[i];if(o.taskId=e){o=null!=t?t:o,this.data[i]=o,Notification.emit("task_update_state",{info:o,oldId:e});break}}},taskReport:function(e,t){var i=this;if(e==this.TaskType.FLY_KM){var n=function(){if(!i.data||0==i.data.length)return null;for(var t=0;t<i.data.length;t++){var n=i.data[t],a=o.getJsonCfgByID("task",n.taskId);if(a&&a.kind==e)return a}return null}();n&&t>=n.need&&this.requestTaskDo(n.id,t)}},isRed:function(){if(!this.data||0==this.data.length)return!1;for(var e=0;e<this.data.length;e++)if(1==this.data[e].isComplete&&1!=this.data[e].isReceive)return!0;return!1}};t.exports=c,cc._RF.pop()},{HttpUtils:"HttpUtils",PlatformUtils:"PlatformUtils",common:"common"}],temp:[function(e,t,i){"use strict";cc._RF.push(t,"5bb707G8ChE3pV5u7Qx78kb","temp");var o=e("common"),n=e("sceneManager");cc.Class({extends:cc.Component,properties:{spr_bg:cc.Sprite,nod_mask:cc.Node,nod_loading:cc.Node,lab_process:cc.Label,lab_desc:cc.Label},onLoad:function(){},start:function(){o.hideLoading(),o.clearPopLayer(),this.nod_mask.active=!1,this.nod_loading.active=!1,"Game"==n.preSceneName||n.isLoadedGame?n.loadScene("Game"):this.loading()},loading:function(){this.nod_mask.active=!0,this.nod_loading.active=!0;var e=this.nod_mask.addComponent(cc.Graphics);e.fillColor=new cc.Color(0,0,0,200);var t=Math.max(cc.winSize.width,this.node.width),i=Math.max(cc.winSize.height,this.node.height);e.fillRect(-t/2,-i/2,t,i),this.preLoad("Game")},preLoad:function(e){var t=this;cc.director.preloadScene(e,function(e,i,o){var n=100*e/i;n=Math.floor(n),t.lab_process.string=n+"%"},function(){n.loadScene("Game"),n.isLoadedGame=!0})}}),cc._RF.pop()},{common:"common",sceneManager:"sceneManager"}],topItem:[function(e,t,i){"use strict";cc._RF.push(t,"2c520SiKv1BTKl5L/Yxb8DB","topItem"),cc.Class({extends:cc.Component,properties:{labTop:cc.Label,sprHeadimg:cc.Sprite,labName:cc.Label,labScore:cc.Label},loadData:function(e){var t=e.top,i=e.name,o=e.score;this.labTop.string=t,this.labName.string=i,this.labScore.string=o;var n=this;cc.loader.loadRes("subpack/bonus/headstart",cc.SpriteFrame,function(e,t){n.sprHeadimg.spriteFrame=t})}}),cc._RF.pop()},{}],top:[function(e,t,i){"use strict";cc._RF.push(t,"22badrlLCxCoJOrKUQ0i/75","top");var o=e("common"),n=(e("sceneManager"),e("PlatformUtils"));e("HttpUtils");cc.Class({extends:cc.Component,properties:{btnFriendsTop:cc.Button,btnWorldTop:cc.Button,btnGroupTop:cc.Button,sprRanking:cc.Sprite,sprGroupRanking:cc.Sprite,btnFriendRankingSprite:{default:[],type:cc.SpriteFrame,tooltip:"ButtonsGroupOfFriendRanking"},btnWorldRankingSprite:{default:[],type:cc.SpriteFrame,tooltip:"ButtonsGroupOfWorldRanking"},btnSound:{default:null,type:cc.AudioClip}},onLoad:function(){this.sprRanking.node.active=!1,this.sprGroupRanking.node.active=!1,this.btnGroupTop.node.active=!1,D.commonState.shareTicket?(this.showGroupTop(D.commonState.shareTicket),D.commonState.shareTicket=null):this.onFriendsTop()},onFriendsTop:function(){this.onBtnSound(),this.sprRanking.node.active=!0,this.btnGroupTop.node.active=!0,this.btnFriendsTop.getComponent(cc.Sprite).spriteFrame=this.btnFriendRankingSprite[0],this.btnWorldTop.getComponent(cc.Sprite).spriteFrame=this.btnWorldRankingSprite[1];var e={};e.id=D.currHero.id,e.kind=D.currHero.kind,e.subSeq=D.currHero.subSeq,e.level=D.currHero.level,e.tag=D.currHero?D.currHero.kind+"_"+D.currHero.subSeq:"1_1",n.getHigthScore(function(e){0})},onWorldTop:function(){this.onBtnSound(),this.sprRanking.node.active=!0,this.btnGroupTop.node.active=!0,this.btnFriendsTop.getComponent(cc.Sprite).spriteFrame=this.btnFriendRankingSprite[1],this.btnWorldTop.getComponent(cc.Sprite).spriteFrame=this.btnWorldRankingSprite[0];n.getUserSkey();var e={};e.id=D.currHero.id,e.kind=D.currHero.kind,e.subSeq=D.currHero.subSeq,e.level=D.currHero.level,e.tag=D.currHero?D.currHero.kind+"_"+D.currHero.subSeq:"1_1",n.getHigthScore(function(e){0})},onGroupTop:function(){this.onBtnSound();var e=o.getShareCfgByType(D.ShareTypeGroup),t=e.title,i=e.imageUrl;n.shareAppMessage(t,i,"",function(e){e?(o.sysMessage("\u5206\u4eab\u6210\u529f\uff01"),n.requestBill(100007,8,200,1)):n.requestBill(100007,8,200,0)},!0)},showGroupTop:function(e){this.sprGroupRanking.node.active=!0,this.btnGroupTop.node.active=!1;var t={};t.id=D.currHero?D.currHero.id:1,t.kind=D.currHero?D.currHero.kind:1,t.subSeq=D.currHero?D.currHero.subSeq:1,t.level=D.currHero?D.currHero.level:1,t.tag=D.currHero?D.currHero.kind+"_"+D.currHero.subSeq:"1_1",n.getHigthScore(function(e){0})},onBackMain:function(){this.onBtnSound(),o.removePopUpLayer(this)},update:function(e){},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{HttpUtils:"HttpUtils",PlatformUtils:"PlatformUtils",common:"common",sceneManager:"sceneManager"}],ufoGroup:[function(e,t,i){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}cc._RF.push(t,"9ed9f/6UllKjIZCU2qyzWUA","ufoGroup");var n=e("pool"),a=e("common"),c=cc.Class({name:"ufoG",properties:{name:"",prefab:cc.Prefab,size:0}});cc.Class({extends:cc.Component,properties:{ufoG:{default:[],type:c},mainScript:{default:null,type:e("main")},perDis:80,ufoTimesNum:0,giftDropLevel:1,giftDropCount:0,giftDropRate:10},onLoad:function(){n.initPoolBatch(this,this.ufoG)},startAction:function(){Notification.on("make_star_globle_event",this.makeNewUfoByEnemy,this),Notification.on("level_reward_event",this.passLevelHandler,this),Notification.on("updateUfoTimes_event",this.updteUfoTimesHandler,this)},getPositionOfNewUfo:function(e){var t=Math.random()*(this.node.parent.width/2-e.width/2),i=this.node.parent.height/2+e.height/2;return cc.v2(t,i)},makeNewUfoByEnemy:function(e){e.dropID>=1e4?this.makeNewUfoByEnemyHandler2(e):(this.makeNewUfoByEnemyHandler1(e),D.gamePause&&this.node.pauseAllActions())},makeNewUfoByEnemyHandler1:function(e){var t=this,i=function(){var i=t.makeNewUfo(e);i&&i.throwHandler()}.bind(this);if(18==e.dropID&&this.ufoTimesNum>1){if(this.node){var o=cc.repeat(cc.sequence(cc.delayTime(.15),cc.callFunc(i)),this.ufoTimesNum);this.node.runAction(o)}}else if(this.node){o=cc.sequence(cc.delayTime(.15),cc.callFunc(i));this.node.runAction(o)}},makeNewUfoByEnemyHandler2:function(e){var t=[],i=function(i,n){if(i>0&&n>0)for(var a=0;a<n;a++){var c={};c.dropID=o.type_1,c.speed=e.speed,c.x=e.x,c.y=e.y,t.push(c)}},o=a.getJsonCfgByID("DropMore",e.dropID);if(i(o.type_1,o.Num_1),i(o.type_2,o.Num_2),i(o.type_3,o.Num_3),i(o.type_4,o.Num_4),i(o.type_5,o.Num_5),i(o.type_6,o.Num_6),!(t.length<=0)){t.sort();for(var n=0;n<t.length;n++){var c=t[n];c.x=c.x-50+100*Math.random();var s=this.makeNewUfo(c);s&&s.throwHandler()}}},makeNewUfo:function(e){var t=this.ufoG[e.dropID];if(t){var i=t.name+"Pool",o=n.borrowNewNode(this[i],t.prefab,this.node);o.setPosition(cc.v2(e.x,e.y));var a=o.getComponent("ufo");return a.initData(),a.ufoGroup=this,a.speed=e.speed,a.hero=this.mainScript.hero,a}},levelRewardFinish:function(){Notification.emit("level_Reward_Finish_event")},passLevelHandler:function(e){var t=e.lvl,i=1,o=a.getJsonCfgs("levels_All");if(o&&o.length>=t){var n=o[t-1];if(n){var c=n.rewardLevel.split(","),s=Math.random()*c.length;i=(i=c[Math.floor(s)])>0?i:1,console.log("======= passLevelHandler lvlNum="+i+" ,idx="+s)}}var r=a.getJsonCfgs("level_pass_reward_"+i);if(r&&!(r.length<=0)){var l=.5*-cc.winSize.width+50,d=cc.winSize.height,u=r.length,h=(this.perDis*u+cc.winSize.height/2)/1e3,m=cc.delayTime(1+h),p=cc.callFunc(this.levelRewardFinish,this);this.node.runAction(cc.sequence(m,p));for(var f=u-1;f>=0;f--){var g=r[f];g.reward1>0&&this.makeLvlUfoByXY(g.reward1,l,d,1,u-f),g.reward2>0&&this.makeLvlUfoByXY(g.reward2,l,d,2,u-f),g.reward3>0&&this.makeLvlUfoByXY(g.reward3,l,d,3,u-f),g.reward4>0&&this.makeLvlUfoByXY(g.reward4,l,d,4,u-f),g.reward5>0&&this.makeLvlUfoByXY(g.reward5,l,d,5,u-f),g.reward6>0&&this.makeLvlUfoByXY(g.reward6,l,d,6,u-f)}}},updteUfoTimesHandler:function(e){this.node.stopAllActions(),this.ufoTimesNum=e.timesNum;var t=e.time;t>0&&this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(this.resetUpdteUfoTimesHandler,this)))},resetUpdteUfoTimesHandler:function(){this.ufoTimesNum=0,Notification.emit("change_bullet_buff",{item:"item_2"})},makeLvlUfoByXY:function(e,t,i,o,n){var a={};a.dropID=e,a.x=t+this.perDis*o,a.y=i+this.perDis*n,a.speed=1e3;var c=this.makeNewUfo(a);c&&c.moveHandler()},gameOver:function(){this.node.stopAllActions(),Notification.off("make_star_globle_event",this.makeNewUfoByEnemy),Notification.off("level_reward_event",this.passLevelHandler),Notification.off("updateUfoTimes_event",this.updteUfoTimesHandler),this.resetGfitDrop()},gamePause:function(){this.node.pauseAllActions();for(var e=new(Function.prototype.bind.apply(Array,[null].concat(o(this.node.children)))),t=0;t<e.length;t++){var i=e[t].getComponent("ufo");i&&i.gamePause()}},gameResume:function(){this.node.resumeAllActions();for(var e=new(Function.prototype.bind.apply(Array,[null].concat(o(this.node.children)))),t=0;t<e.length;t++){var i=e[t].getComponent("ufo");i&&i.gameResume()}},destroyUfo:function(e){n.returnNode(this,e)},giftDrop:function(e,t){return!(this.mainScript.enemyGroup.mainLevel<this.giftDropLevel)&&(!(this.giftDropCount>=2)&&(!(this.mainScript.hero.hp/this.mainScript.hero.maxHP>.8)&&(100*Math.random()>this.giftDropRate?(this.giftDropRate<50&&(this.giftDropRate+=10),!1):(this.giftDropCount+=1,this.giftDropRate=10,this.giftDropLevel+=Math.floor(2+3*Math.random()),this.makeNewUfoByEnemy({speed:45,x:e,y:t,dropID:16}),!0))))},resetGfitDrop:function(){this.giftDropLevel=1,this.giftDropCount=0,this.giftDropRate=10},dropRedPacket:function(e,t){this.makeNewUfoByEnemy({speed:20,x:e,y:t,dropID:19})}}),cc._RF.pop()},{common:"common",main:"main",pool:"pool"}],ufo:[function(e,t,i){"use strict";cc._RF.push(t,"1e1f8IcusZDA5to30UQq95v","ufo"),cc.Class({extends:cc.Component,properties:{getUfoSound:{default:null,type:cc.AudioClip},isNomalMove:!1,sprintDisNum:0,sprintTime:0,magnetSpeed:30,canMagnetSpeed:!1},initData:function(){this.isNomalMove=!1,this.magnetSpeed=30,this.canMagnetSpeed=!1},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(e,t){D.isVoideClose||cc.audioEngine.play(this.getUfoSound),this.removeUfo()},moveHandler:function(){this.canManger();var e=this.node.x,t=(this.node.y,(this.node.y+cc.winSize.height/2)/this.speed),i=cc.moveTo(t,cc.v2(e,-cc.winSize.height/2));this.node.setScale(1);var o=cc.callFunc(this.removeUfo,this);this.node.runAction(cc.sequence(i,o))},throwHandler:function(){var e=this.node.x,t=this.node.y,i=e+50;i>cc.winSize.width/2&&(i=e-50);var o=(this.node.y+cc.winSize.height/2)/250,n=[cc.v2(e,t),cc.v2(e,t+100),cc.v2(e,t+10)],a=cc.bezierTo(.3,n),c=cc.moveTo(o,cc.v2(e,-cc.winSize.height/2));this.node.setScale(1);var s=cc.callFunc(this.removeUfo,this);this.node.runAction(cc.sequence(a,c,s));var r=this;this.node.runAction(cc.sequence(cc.scaleTo(.2,-1,1),cc.callFunc(function(){r.canManger()})))},canManger:function(e){this.canMagnetSpeed=!0},removeUfo:function(){this.node.stopAllActions(),this.ufoGroup.destroyUfo(this.node)},gamePause:function(){this.node.pauseAllActions()},gameResume:function(){this.node.resumeAllActions()},update:function(e){if(!D.gameStatuePause){if(D.magnetStatus&&this.canMagnetSpeed){this.node.stopAllActions(),this.isNomalMove=!0;var t=this.node.getPosition(),i=this.hero.node.getPosition().subSelf(t),o=i.mag();return this.node.x=t.x+this.magnetSpeed*i.x/o,this.node.y=t.y+this.magnetSpeed*i.y/o,this.magnetSpeed=this.magnetSpeed+.3,void(this.magnetSpeed>35&&(this.magnetSpeed=35))}this.isNomalMove&&!D.gameStatuePause&&(this.node.stopAllActions(),this.node.y-=e*this.speed,this.node.y<-this.node.parent.height/2&&this.removeUfo())}}}),cc._RF.pop()},{}],upgradeFail:[function(e,t,i){"use strict";cc._RF.push(t,"5452ecdlHBCzrQV4yX/U7BN","upgradeFail");var o=e("common"),n=e("PlatformUtils"),a=e("StorageUtils");cc.Class({extends:cc.Component,properties:{btnVideo:cc.Button,btnShare:cc.Button,labVideoAward:cc.Label,labShareAward:cc.Label,btnSound:{default:null,type:cc.AudioClip},spr_label:cc.Sprite,lab_desc:cc.Label},onLoad:function(){var e=this;this.btnVideo.node.active=!1,this.btnShare.node.active=!1,this.labVideoAward.string=String(D.AwardCoinVideo),this.labShareAward.string=String(D.AwardCoinShare),n.requestShareCfg("upgradeVideo",function(t){t&&t&&(e.btnVideo.node.active=!0,e.initVideoState())}),this.spr_label.node.active=!0,this.lab_desc.node.active=!1},initVideoState:function(){var e=a.upgradeVideoCount();if(!n.isTodayWxVideoBeyond()||e<=0){var t=this;n.requestShareCfg("upgradeShare",function(e){if(e){t.btnVideo.node.active=!1;var i=a.upgradeShareCount();!n.isTodayWxAwardShareBeyond()||i<=0?(t.btnShare.node.active=!0,t.btnShare.interactable=!1):t.btnShare.node.active=!0}else t.btnVideo.interactable=!1})}},useLabDesc:function(){this.spr_label.node.active=!1,this.lab_desc.node.active=!0},onClose:function(){this.onBtnSound(),o.removePopUpLayer(this)},onVideo:function(e){if(this.onBtnSound(),n.isTodayWxVideoBeyond()){var t=this;n.requestBill(100008,1,200,0),n.createRewardedVideoAd("shengji",function(){n.requestAddCoin(D.AwardCoinVideo,D.ReasonAddCoinVideo,function(e){Notification.emit("upgradeCoin",e.currCoin)}),o.sysMessage("\u606d\u559c\u83b7\u5f97 "+D.AwardCoinVideo+" \u661f\u661f\uff01"),n.requestBill(100008,1,200,1),n.setTodayWxVideo(),n.setItemByLocalStorage("UpgradeVideoCount",n.getItemByLocalStorage("UpgradeVideoCount",0)+1),n.setItemByLocalStorage("TodayUpgradeVideoDate",new Date),t.initVideoState()})}else o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01")},onShare:function(){var e=o.getShareCfgByType(D.ShareTypeFriend),t=e.title,i=e.imageUrl,a=this;n.shareAppMessageCallback(t,i,"",function(e){n.isTodayWxAwardShareBeyond()?1==e?(n.requestAddCoin(D.AwardCoinShare,D.ReasonAddCoinShare,function(e){Notification.emit("upgradeCoin",e.currCoin)}),o.sysMessage("\u5206\u4eab\u83b7\u5f97 "+D.AwardCoinShare+" \u661f\u661f\uff01"),n.requestBill(100007,10,200,1),n.setTodayWxAwardShare(),n.setItemByLocalStorage("UpgradeShareCount",n.getItemByLocalStorage("UpgradeShareCount",0)+1),n.setItemByLocalStorage("TodayUpgradeShareDate",new Date),a.initVideoState()):n.requestBill(100007,10,200,0):o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01")})},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",common:"common"}],upgradePage:[function(e,t,i){"use strict";cc._RF.push(t,"fef83NBVwRG+pKV7LFVy6Zt","upgradePage");var o=e("common"),n=e("sceneManager"),a=e("PlatformUtils"),c=e("StorageUtils");cc.Class({extends:cc.Component,properties:{labName:cc.Label,layAirplaneUpgrade1:cc.Layout,sprAirplane1:cc.Sprite,sprAirplane2:cc.Sprite,labUpgradeInfoLevel:cc.Label,layAirplaneUpgradeUltimate:cc.Layout,sprAirplaneUltimate:cc.Sprite,sprGotoLeft:cc.Sprite,sprGotoRigth:cc.Sprite,labPowerLv:cc.Label,labPowerval:cc.Label,labBtnPower:cc.Label,labPowerNeed:cc.Label,btnPower:cc.Button,progPower:cc.ProgressBar,labAttackSpeedLv:cc.Label,labAttackSpeedVal:cc.Label,labAttackSpeedNeed:cc.Label,labBtnAttackSpeed:cc.Label,btnAttackSpeed:cc.Button,progAttackSpeed:cc.ProgressBar,labBloodLv:cc.Label,labBloodVal:cc.Label,labBloodNeed:cc.Label,labBtnBlood:cc.Label,btnBlood:cc.Button,progBlood:cc.ProgressBar,labBtnDeal:cc.Label,sprBtnCzDeal:cc.Sprite,sprBtnFxDeal:cc.Sprite,sprBtnGzDeal:cc.Sprite,sprBtnDailySign:cc.Sprite,btnDeal:cc.Button,btnVideo:cc.Button,btnShare:cc.Button,labVideoAward:cc.Label,labShareAward:cc.Label,currHeroKind:cc.Integer,currHeroId:cc.Integer,currHeroLv:cc.Integer,currHeroIsGot:cc.Boolean,currPageIdx:cc.Integer,currHeroCfg:null,nextHeroLv:cc.Integer,upgradeFail:{default:null,type:cc.Prefab},prefabFollowAward:cc.Prefab,sprPlaneBullet:cc.Sprite,sprPlaneBullet1:cc.Sprite,sprPlaneBullet2:cc.Sprite,planeBulletPrefab1:cc.Prefab,planeBulletPrefab2:cc.Prefab,btnSound:{default:null,type:cc.AudioClip},awardPlaneSound:{default:null,type:cc.AudioClip},prefabDailySing:cc.Prefab,lab_signplane_descs:cc.Label},onLoad:function(){var e=this;this.btnVideo.node.active=!1,this.btnShare.node.active=!1,this.labVideoAward.string=String(D.AwardCoinVideo),this.labShareAward.string=String(D.AwardCoinShare),a.requestShareCfg("upgradeVideo",function(t){t&&t&&(e.btnVideo.node.active=!0,e.initVideoState())}),this.lab_signplane_descs.node.active=!1},initVideoState:function(){var e=c.upgradeVideoCount();if(!a.isTodayWxVideoBeyond()||e<=0){var t=this;a.requestShareCfg("upgradeShare",function(e){if(e){t.btnVideo.node.active=!1;var i=c.upgradeShareCount();!a.isTodayWxAwardShareBeyond()||i<=0?(t.btnShare.node.active=!0,t.btnShare.interactable=!1):t.btnShare.node.active=!0}else t.btnVideo.interactable=!1})}},load:function(e,t,i){console.log("heroInfo",JSON.stringify(i)),this.labName.string=t.name,this.currPageIdx=e;var o=0;a.requestGameInfo(function(e){o=e.coin}),this.currHeroKind=i&&i.kind?i.kind:t.kind,this.currHeroId=i&&i.id?i.id:t.id,this.currHeroLv=i&&i.level?i.level:1,this.currHeroIsGot=!(!i||1!=i.status&&2!=i.status),this.currHeroCfg=t,this.currHeroIdx=t.subSeq,this.setHeroImgInfo(t,i);var n=i?i.powerLevel:1;this.labPowerLv.string="Lv"+n;var c=t.powerNeed+t.powerNeedIncr*(n-1);this.labPowerNeed.string=c+"",this.labPowerval.string="["+parseInt(t.initPower+t.powerRadix*(n-1))+"]",(!this.currHeroIsGot||o<c)&&(this.btnPower.interactable=!1,this.btnPower.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(104,94,94,255));var s=i?i.bloodLevel:1;this.labBloodLv.string="Lv"+s;var r=t.bloodNeed+t.bloodNeedIncr*(s-1);this.labBloodNeed.string=r+"",this.labBloodVal.string="["+parseInt(t.initBlood+t.bloodRadix*(s-1))+"]",(!this.currHeroIsGot||o<r)&&(this.btnBlood.interactable=!1,this.btnBlood.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(104,94,94,255));var l=i?i.attackSpeedLevel:1;l=l>0?l:1,this.labAttackSpeedLv.string="Lv"+l;var d=t.attackSpeedNeed+t.attackSpeedNeedIncr*(l-1);if(this.labAttackSpeedNeed.string=d+"",this.labAttackSpeedVal.string="["+(t.initAttackSpeed+t.initAttackSpeed*t.attackSpeedRadix/100*l).toFixed(2)+"]",(!this.currHeroIsGot||o<d)&&(this.btnAttackSpeed.interactable=!1,this.btnAttackSpeed.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(104,94,94,255)),this.currHeroIsGot)this.sprBtnCzDeal.node.opacity=255,this.sprBtnFxDeal.node.opacity=0,this.sprBtnGzDeal.node.opacity=0,this.sprBtnDailySign.node.opacity=0;else{var u="";switch(t.access){case 1:u=t.accessParam+"\u8d2d\u4e70";var h=this;a.requestGameInfo(function(e){e.coin<t.accessParam&&(h.btnDeal.interactable=!1)}),this.sprBtnCzDeal.node.opacity=0,this.sprBtnFxDeal.node.opacity=0,this.sprBtnGzDeal.node.opacity=0,this.sprBtnDailySign.node.opacity=0;break;case 2:this.sprBtnCzDeal.node.opacity=0,this.sprBtnFxDeal.node.opacity=255,this.sprBtnGzDeal.node.opacity=0,this.sprBtnDailySign.node.opacity=0;break;case 3:this.sprBtnCzDeal.node.opacity=0,this.sprBtnFxDeal.node.opacity=0,this.sprBtnGzDeal.node.opacity=255,this.sprBtnDailySign.node.opacity=0;break;case 4:this.sprBtnCzDeal.node.opacity=0,this.sprBtnFxDeal.node.opacity=0,this.sprBtnGzDeal.node.opacity=0,this.sprBtnDailySign.node.opacity=255}this.labBtnDeal.string=u}console.log("add page item===="+t.name)},onDeal:function(){if(this.onBtnSound(),this.currHeroIsGot){var e=this,t=function(){a.requestUpdateFightStatus(e.currHeroKind,function(e){}),cc.audioEngine.stop(D.commonState.hallAudioID),D.commonState.hallAudioID=0,Notification.off("upgradeCoin",e.pageMain.onListenCoinChange),a.hideWxLayer();var t=n.isLoadedGame?"Game":"Tmp";n.loadScene(t)};cc.loader.loadRes("prefabs/beginFight",function(i,n){var a=o.showPopUpLayer(n).getComponent("beginFight");a&&a.setCallBack(t,e.currHeroKind,e.currHeroKind)})}else switch(this.currHeroCfg.access){case 1:var i=this;a.requestNewHeroUseCoin(this.currHeroKind,function(e){if(e.hero){var t=e.hero;i.currHeroId=t.id,i.currHeroIdx=t.subSeq,i.currHeroIsGot=!0,i.currHeroKind=t.kind,i.currHeroLv=t.level,o.getJsonCfgs("hero").forEach(function(e){t.kind==e.kind&&t.id==e.id&&(i.currHeroCfg=e)}),i.labBtnDeal.string="",i.sprBtnCzDeal.node.opacity=255,i.sprBtnFxDeal.node.opacity=0,i.btnDeal.interactable=!0,i.btnPower.interactable=!0,i.btnBlood.interactable=!0,i.btnAttackSpeed.interactable=!0,i.btnPower.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),i.btnBlood.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),i.btnAttackSpeed.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),i.onAwardPlaneSound()}});break;case 2:var c=o.getShareCfgByType(D.ShareTypeFriend),s=c.title,r=c.imageUrl,l=a.getUserId();a.shareAppMessage(s,r,"type=shareUnlock&fromUserId="+l),this.btnPower.interactable=!0,this.btnBlood.interactable=!0,this.btnAttackSpeed.interactable=!0,this.btnPower.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.btnBlood.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.btnAttackSpeed.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.onAwardPlaneSound();break;case 3:o.showPopUpLayer(this.prefabFollowAward),this.btnPower.interactable=!0,this.btnBlood.interactable=!0,this.btnAttackSpeed.interactable=!0,this.btnPower.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.btnBlood.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.btnAttackSpeed.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.onAwardPlaneSound();break;case 4:o.showPopUpLayer(this.prefabDailySing),this.btnPower.interactable=!0,this.btnBlood.interactable=!0,this.btnAttackSpeed.interactable=!0,this.btnPower.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.btnBlood.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.btnAttackSpeed.node.children[1].getComponent(cc.LabelOutline).color=new cc.color(189,106,21,255),this.onAwardPlaneSound()}},setHeroImgInfo:function(e,t){var i=this;2==e.status&&(D.currHero=e);var n=this.currHeroId,a=this.currHeroLv,c=null,s=null,r=1e8,l=0;o.getJsonCfgs("hero").forEach(function(e){i.currHeroId==e.id&&(s=e),e.kind==i.currHeroKind&&e.id>n&&n<=i.currHeroId&&(n=e.id,a=e.level,c=e),e.kind<r&&(r=e.kind),e.kind>l&&(l=e.kind)}),this.currHeroIdx=s.subSeq;var d=this.currHeroId==n||4==s.kind;this.layAirplaneUpgradeUltimate.node.active=d,this.layAirplaneUpgrade1.node.active=!d;var u=e.initAttackSpeed+e.attackSpeedRadix/100*((t?t.attackSpeedLevel:1)-1),h=this.sprAirplane1.node.y,m=this.sprAirplane2.node.y,p=this.sprAirplaneUltimate.node.y,f=cc.moveTo(2,cc.v2(this.sprAirplane1.node.x,h+10)),g=cc.moveTo(2,cc.v2(this.sprAirplane1.node.x,h-10)),v=cc.moveTo(2,cc.v2(this.sprAirplane2.node.x,m+10)),y=cc.moveTo(2,cc.v2(this.sprAirplane2.node.x,m-10)),b=cc.moveTo(2,cc.v2(this.sprAirplaneUltimate.node.x,p+10)),S=cc.moveTo(2,cc.v2(this.sprAirplaneUltimate.node.x,p-10)),_=cc.repeatForever(cc.sequence(f,g)),B=cc.repeatForever(cc.sequence(v,y)),C=cc.repeatForever(cc.sequence(b,S));if(this.sprAirplaneUltimate.node.stopAllActions(),this.sprAirplane1.node.stopAllActions(),this.sprAirplane2.node.stopAllActions(),d){this.layAirplaneUpgradeUltimate.node.opacity=255;var w=this,A="plane/plane_"+this.currHeroKind+"_"+this.currHeroIdx;console.log(d+","+A),4==s.kind?(this.labName.node.getComponent(cc.Widget).left=290,this.labUpgradeInfoLevel.string="",this.layAirplaneUpgradeUltimate.node.getChildByName("lab_desc2").active=!1,this.layAirplaneUpgradeUltimate.node.getChildByName("spr_high_level").active=!1,this.sprAirplaneUltimate.node.x=0,this.sprPlaneBullet.node.x=0,this.labName.node.getComponent(cc.Widget).left=290,this.labUpgradeInfoLevel.string="",b=cc.moveTo(2,cc.v2(this.sprAirplaneUltimate.node.x,p+10)),S=cc.moveTo(2,cc.v2(this.sprAirplaneUltimate.node.x,p-10)),C=cc.repeatForever(cc.sequence(b,S)),this.onPlaneBullet(this.currHeroKind,this.currHeroIdx,u,0,-10,this.sprPlaneBullet,this.planeBulletPrefab1)):this.onPlaneBullet(this.currHeroKind,this.currHeroIdx,u,125,-10,this.sprPlaneBullet,this.planeBulletPrefab1),cc.loader.loadRes(A,cc.SpriteFrame,function(e,t){w.sprAirplaneUltimate.spriteFrame=t,w.sprAirplaneUltimate.node.runAction(C)})}else{this.onPlaneBullet(this.currHeroKind,this.currHeroIdx,u,132,30,this.sprPlaneBullet1,this.planeBulletPrefab1),this.onPlaneBullet(c.kind,c.subSeq,u,-90,0,this.sprPlaneBullet2,this.planeBulletPrefab2);w=this;var k="plane/plane_"+this.currHeroKind+"_"+this.currHeroIdx;console.log(k),cc.loader.loadRes(k,cc.SpriteFrame,function(e,t){w.sprAirplane1.spriteFrame=t,w.sprAirplane1.node.runAction(_)}),k="plane/plane_"+this.currHeroKind+"_"+(this.currHeroIdx+1),cc.loader.loadRes(k,cc.SpriteFrame,function(e,t){w.sprAirplane2.spriteFrame=t,w.sprAirplane2.node.runAction(B)}),this.nextHeroLv=a,this.labUpgradeInfoLevel.string="( \u8fdb\u9636\u9700\u5168\u5c5e\u6027\u7b49\u7ea7\u8fbe\u5230: Lv"+a+" )"}this.sprGotoLeft.node.active=!0,this.sprGotoRigth.node.active=!0,r==this.currHeroKind?(this.sprGotoLeft.node.active=!1,this.sprGotoRigth.node.active=!0):l==this.currHeroKind&&(this.sprGotoLeft.node.active=!0,this.sprGotoRigth.node.active=!1)},onUpgradePower:function(){this.onBtnSound();var e=this;a.requestHeroUpgrade(this.currHeroKind,1,function(t){if(2010!=t){var i=t.hero,n=i.powerLevel,a=i.id,c=i.level,s=t.myCoin,r=e.currHeroCfg;if(e.currHeroId!=a)o.getJsonCfgs("hero").forEach(function(e){i.kind==e.kind&&i.id==e.id&&(r=e)}),e.currHeroId=a,e.currHeroLv=c,e.setHeroImgInfo(r,e.pageMain.herosData[r.kind]);e.labPowerLv.string="Lv"+n,e.labPowerNeed.string=r.powerNeed+r.powerNeed*(n-1)+"",e.labPowerval.string="["+parseInt(r.initPower+r.powerRadix*(n-1))+"]",Notification.emit("upgradeCoin",s),o.sysMessage("\u5347\u7ea7\u6210\u529f",null,cc.v2(0,100))}else o.showPopUpLayer(e.upgradeFail)})},onUpgradeBlood:function(){this.onBtnSound();var e=this;a.requestHeroUpgrade(this.currHeroKind,2,function(t){if(2010!=t){var i=t.hero,n=i.bloodLevel,a=i.id,c=i.level,s=t.myCoin,r=e.currHeroCfg;if(e.currHeroId!=a)o.getJsonCfgs("hero").forEach(function(e){i.kind==e.kind&&i.id==e.id&&(r=e)}),e.currHeroId=a,e.currHeroLv=c,e.setHeroImgInfo(r,e.pageMain.herosData[r.kind]);e.labBloodLv.string="Lv"+n,e.labBloodNeed.string=r.bloodNeed+r.bloodNeed*(n-1)+"",e.labBloodVal.string="["+parseInt(r.initBlood+r.bloodRadix*(n-1))+"]",Notification.emit("upgradeCoin",s),o.sysMessage("\u5347\u7ea7\u6210\u529f",null,cc.v2(0,100))}else o.showPopUpLayer(e.upgradeFail)})},onUpgradeAttackSpeed:function(){this.onBtnSound();var e=this;a.requestHeroUpgrade(this.currHeroKind,3,function(t){if(2010!=t){var i=t.hero,n=i.attackSpeedLevel,a=i.id,c=i.level,s=t.myCoin,r=e.currHeroCfg;if(e.currHeroId!=a)o.getJsonCfgs("hero").forEach(function(e){i.kind==e.kind&&i.id==e.id&&(r=e)}),e.currHeroId=a,e.currHeroLv=c,e.setHeroImgInfo(r,e.pageMain.herosData[r.kind]);e.labAttackSpeedLv.string="Lv"+n,e.labAttackSpeedNeed.string=r.attackSpeedNeed+r.attackSpeedNeed*(n-1)+"",e.labAttackSpeedVal.string="["+(r.initAttackSpeed+r.initAttackSpeed*r.attackSpeedRadix/100*n).toFixed(2)+"]",Notification.emit("upgradeCoin",s),o.sysMessage("\u5347\u7ea7\u6210\u529f",null,cc.v2(0,100))}else o.showPopUpLayer(e.upgradeFail)})},gotoLeft:function(){this.onBtnSound(),this.pageMain.gotoPageByIndex(this.currPageIdx-1)},gotoRight:function(){this.onBtnSound(),this.pageMain.gotoPageByIndex(this.currPageIdx+1)},onRewardedVideoAd:function(){this.onBtnSound();var e=c.upgradeVideoCount();if(!a.isTodayWxVideoBeyond()||e<=0)o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01");else{var t=this;a.createRewardedVideoAd("shengji",function(e){console.log("createRewardedVideoAd",e),a.requestAddCoin(D.AwardCoinVideo,D.ReasonAddCoinVideo,function(e){Notification.emit("upgradeCoin",e.currCoin)}),o.sysMessage("\u606d\u559c\u83b7\u5f97 "+D.AwardCoinVideo+" \u661f\u661f\uff01"),a.setTodayWxVideo(),a.setItemByLocalStorage("UpgradeVideoCount",a.getItemByLocalStorage("UpgradeVideoCount",0)+1),a.setItemByLocalStorage("TodayUpgradeVideoDate",new Date),t.initVideoState()})}},onBackMain:function(){this.onBtnSound(),this.pageMain.onBackMain()},gotoShareAward:function(){this.onBtnSound(),this.pageMain.gotoShareAward()},onPlaneBullet:function(e,t,i,o,n,a,c){if(e>=2){2==e?i=8:3==e?i=1.3:4==e&&(i=5),this.startShoot=function(){this.onPlaneBullet2(e,t,i,o,n,a,c)};var s=cc.delayTime(1/i),r=cc.callFunc(this.startShoot,this),l=cc.repeatForever(cc.sequence(s,r));a.node.stopAllActions(),a.node.runAction(l)}else this.onPlaneBullet1(e,t,i,o,n,a,c)},onPlaneBullet1:function(e,t,i,o,n,a,c){var s=cc.instantiate(c.data),r="bullet/bullet_"+e+"_"+t;this.startShoot=function(){var e=cc.v2(a.node.x+o,a.node.y+n),t=cc.instantiate(s);a.node.addChild(t),t.setPosition(e),t.setScale(.8,.8),t.moveRotation=0},i>20&&(i=20),i=2;var l=cc.delayTime(1/i),d=cc.callFunc(this.startShoot,this),u=cc.repeatForever(cc.sequence(l,d));cc.loader.loadRes(r,cc.SpriteFrame,function(e,t){s.getComponent(cc.Sprite).spriteFrame=t,a.node.runAction(u)})},onPlaneBullet2:function(e,t,i,o,n,a,c){3==e?this.startShoot_3(e,t,i,o,n,a,c):4==e?this.startShoot_4(e,t,i,o,n,a,c):this.startShoot_2(e,t,i,o,n,a,c)},startShoot_2:function(e,t,i,o,n,a,c){a.shootCount||(a.shootCount=0),5==t?(a.shootCount%2==0?(this.makeNewBullet(1,-15,-30,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,-15,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,15,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,15,30,-50,"bullet/bullet_new_2_1",o,n,a,c)):(this.makeNewBullet(1,0,-15,-50,"bullet/bullet_new_2_2",o,n,a,c),this.makeNewBullet(1,0,15,-50,"bullet/bullet_new_2_2",o,n,a,c)),this.makeNewBullet(2,0,0,-50,"bullet/bullet_new_2_4",o,n,a,c)):1==t?(this.makeNewBullet(1,-5,0,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,5,0,-50,"bullet/bullet_new_2_1",o,n,a,c)):2==t?a.shootCount%2==0?(this.makeNewBullet(1,-10,-30,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,0,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,10,30,-50,"bullet/bullet_new_2_1",o,n,a,c)):this.makeNewBullet(1,0,0,-50,"bullet/bullet_new_2_2",o,n,a,c):3==t?a.shootCount%2==0?(this.makeNewBullet(1,-15,-30,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,-15,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,15,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,15,30,-50,"bullet/bullet_new_2_1",o,n,a,c)):(this.makeNewBullet(1,0,-15,-50,"bullet/bullet_new_2_2",o,n,a,c),this.makeNewBullet(1,0,15,-50,"bullet/bullet_new_2_2",o,n,a,c)):4==t&&(a.shootCount%2==0?(this.makeNewBullet(1,-15,-30,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,-15,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,0,15,-50,"bullet/bullet_new_2_1",o,n,a,c),this.makeNewBullet(1,15,30,-50,"bullet/bullet_new_2_1",o,n,a,c)):(this.makeNewBullet(1,0,-15,-50,"bullet/bullet_new_2_2",o,n,a,c),this.makeNewBullet(1,0,15,-50,"bullet/bullet_new_2_2",o,n,a,c)),this.makeNewBullet(1,0,0,-50,"bullet/bullet_new_2_3",o,n,a,c)),a.shootCount++},startShoot_3:function(e,t,i,o,n,a,c){a.shootCount||(a.shootCount=0);var s=this,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e/=2,t=(t-50)/2;for(var r=0;r<10;r++){var l=Math.PI/180*36*r,d=30*Math.cos(l),u=30*Math.sin(l);l%Math.PI==0&&(u=0),s.makeNewBullet(1,i,d+e,u+t,"bullet/bullet_new_3_1",o,n,a,c,800)}},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e/=2,t=(t-50)/2;var l=s.makeNewBullet(1,i,0,-30,"bullet/bullet_new_3_2",o,n,a,c,800);l.stopMove=!0;var d=cc.moveBy(r,cc.v2(e,t)),u=cc.callFunc(function(){l.stopMove=!1});l.runAction(cc.sequence(d,u))};5==t?(r(0,0,-10),r(0,0,10),l(-120,-80,2),l(120,-80,2),l(-80,-30,1),l(80,-30,1)):1==t?r(0,0,0):2==t?(r(0,0,0),l(-100,-80),l(100,-80)):3==t?(r(0,0,-10),r(0,0,10)):4==t&&(r(0,0,-10),r(0,0,10),l(-120,-80,2),l(120,-80,2)),a.shootCount++},startShoot_4:function(e,t,i,o,n,a,c){a.shootCount||(a.shootCount=0),a.ddddd||(a.ddddd=1,a.shootCount=0),a.shootCount+=a.ddddd,a.shootCount>=10?(a.ddddd=-1,a.shootCount=10):a.shootCount<0&&(a.ddddd=1,a.shootCount=0);var s=3*a.shootCount;this.makeNewBullet(1,0,-25-1*s,-50,"bullet/bullet_new_4_1",o,n,a,c,800),this.makeNewBullet(1,0,-1*s,-50,"bullet/bullet_new_4_2",o,n,a,c,800),this.makeNewBullet(1,0,25+s,-50,"bullet/bullet_new_4_1",o,n,a,c,800),this.makeNewBullet(1,0,s,-50,"bullet/bullet_new_4_2",o,n,a,c,800)},makeNewBullet:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments[7],s=arguments[8],r=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1500,l=cc.v2(c.node.x+n,c.node.y+a);l.y=l.y+50;var d=this.creatreBullet(l,o,c,s);return d.x+=t,d.y+=i,d.moveSpeed=r,d.moveRotation=e,d},creatreBullet:function(e,t,i,o){var n=cc.instantiate(o.data),a=cc.instantiate(n);if(i.node.addChild(a),a.setPosition(e),a.setScale(.5),a.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.RAW,this.bulletObj||(this.bulletObj={}),this.bulletObj[t])a.getComponent(cc.Sprite).spriteFrame=this.bulletObj[t];else{var c=this;cc.loader.loadRes(t,cc.SpriteFrame,function(e,i){c.bulletObj[t]=i,a.getComponent(cc.Sprite).spriteFrame=c.bulletObj[t]})}return a},update:function(e){var t=this,i=new Array;this.sprPlaneBullet1.node.children.forEach(function(o){if("planeBullet"==o.name){var n=t.sprAirplane1.node.y+150;if(o.y>n)i.push(o);else{var a=120*e,c=a*Math.cos(Math.PI/180*o.moveRotation),s=a*Math.sin(Math.PI/180*o.moveRotation);o.rotation=o.moveRotation,o.x+=s,o.y+=c}}}),this.sprPlaneBullet2.node.children.forEach(function(o){if("planeBullet"==o.name){var n=t.sprAirplane2.node.y+150;if(o.y>n)i.push(o);else{var a=120*e,c=a*Math.cos(Math.PI/180*o.moveRotation),s=a*Math.sin(Math.PI/180*o.moveRotation);o.rotation=o.moveRotation,o.x+=s,o.y+=c}}}),this.sprPlaneBullet.node.children.forEach(function(o){if("planeBullet"==o.name){var n=t.sprAirplane2.node.y+200;if(o.y>n)i.push(o);else{var a=120*e,c=a*Math.cos(Math.PI/180*o.moveRotation),s=a*Math.sin(Math.PI/180*o.moveRotation);o.rotation=o.moveRotation,o.x+=s,o.y+=c}}});for(var o=0;o<i.length;o++){i[o].removeFromParent()}},onBtnSound:function(){D.isVoideClose||cc.audioEngine.play(this.btnSound)},onAwardPlaneSound:function(){D.isVoideClose||cc.audioEngine.play(this.awardPlaneSound)},onShare:function(){var e=o.getShareCfgByType(D.ShareTypeFriend),t=e.title,i=e.imageUrl,n=this;a.shareAppMessageCallback(t,i,"",function(e){a.isTodayWxAwardShareBeyond()?1==e?(a.requestAddCoin(D.AwardCoinShare,D.ReasonAddCoinShare,function(e){Notification.emit("upgradeCoin",e.currCoin)}),o.sysMessage("\u5206\u4eab\u83b7\u5f97 "+D.AwardCoinShare+" \u661f\u661f\uff01"),a.requestBill(100007,10,200,1),a.setTodayWxAwardShare(),a.setItemByLocalStorage("UpgradeShareCount",a.getItemByLocalStorage("UpgradeShareCount",0)+1),a.setItemByLocalStorage("TodayUpgradeShareDate",new Date),n.initVideoState()):a.requestBill(100007,10,200,0):o.sysMessage("\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\uff01")})}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",StorageUtils:"StorageUtils",common:"common",sceneManager:"sceneManager"}],upgrade:[function(e,t,i){"use strict";cc._RF.push(t,"36853bT7kBOnbk+IY1xDead","upgrade");var o=e("common"),n=e("PlatformUtils");cc.Class({extends:cc.Component,properties:{curNum:1,curTotal:1,pageItem:cc.Prefab,target:cc.PageView,labMyCoin:cc.Label,herosData:[],shareAwardPrefab:cc.Prefab,sprStar:cc.Node,hallSound:{default:null,type:cc.AudioClip}},_createPage:function(e,t,i){var o=cc.instantiate(this.pageItem),n=o.getComponent("upgradePage");return n.load(e,t,i),n.pageMain=this,o.position=new cc.v2(0,0),o},onLoad:function(){if(Device.needOffsetPixel()){var e=this.node.getChildByName("spr_node").getComponent(cc.Widget);e&&(e.top=e.top+70)}D.isVoideClose||"Start"!=D.curSceneName||0==D.commonState.hallAudioID&&(D.commonState.hallAudioID=cc.audioEngine.play(this.hallSound,!0,.3)),Notification.on("upgradeCoin",this.onListenCoinChange,this),this.prepareData()},prepareData:function(){var e=this;n.requestHeroList(function(t){t.forEach(function(t){2==t.status&&console.log(t),e.herosData[t.kind]=t}),e.node.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){e.onShowHeros()},e)))}),n.requestGameInfo(function(t){e.labMyCoin.string=t.coin+""})},onShowHeros:function(){var e=this,t=[],i=0,n=this,a=0;o.getJsonCfgs("hero").forEach(function(o,c){if(1!==t[o.kind]){var s=n.herosData[o.kind];(!s||s&&s.kind==o.kind&&s.id==o.id)&&(t[o.kind]=1,e.target.addPage(e._createPage(i++,o,s)),1==o.kind&&(e.node.getChildByName("btn_goto_left").active=!1)),s&&s.level>0&&(a=s.kind)}}),console.log("maxLvKind",a-1),this.curPageIndex&&this.target.setCurrentPageIndex(this.curPageIndex)},setCurPageIndex:function(e){this.curPageIndex=e},onPageEvent:function(e,t){0==e._curPageIdx?this.node.getChildByName("btn_goto_left").active=!1:e._curPageIdx==e._pages.length-1?this.node.getChildByName("btn_goto_right").active=!1:(this.node.getChildByName("btn_goto_left").active=!0,this.node.getChildByName("btn_goto_right").active=!0),cc.PageView.EventType.PAGE_TURNING},onListenCoinChange:function(e){this.labMyCoin.string=String(e)},onBackMain:function(){Notification.off("upgradeCoin",this.onListenCoinChange),o.removePopUpLayer(this)},gotoPageByIndex:function(e){e<0||this.target.setCurrentPageIndex(e)},gotoShareAward:function(){o.showPopUpLayer(this.shareAwardPrefab)},gotoShare:function(){var e=o.getShareCfgByType(D.ShareTypeFriend),t=e.title,i=e.imageUrl;n.shareAppMessage(t,i,"",function(e){e?(o.sysMessage("\u5206\u4eab\u6210\u529f\uff01"),n.requestBill(100007,9,200,1)):n.requestBill(100007,9,200,0)})},onCloseVoide:function(){D.isVoideClose?(cc.audioEngine.resumeAll(),cc.audioEngine.resumeMusic(),D.isVoideClose=!1):(cc.audioEngine.pauseAll(),cc.audioEngine.pauseMusic(),D.isVoideClose=!0)},gotoLeft:function(){this.gotoPageByIndex(this.target._curPageIdx-1)},gotoRight:function(){this.gotoPageByIndex(this.target._curPageIdx+1)}}),cc._RF.pop()},{PlatformUtils:"PlatformUtils",common:"common"}]},{},["HttpUtils","PlatformUtils","StorageUtils","TimeUtils","myeval","sceneManager","stack","gameAward","gamePause","gameSettle","gameover","Shake","baseView","beHurtAni","beattackAni","bullet","bulletGroup","common","effGroup","enemy","enemyGroup","enemybullet ","gameUtils","global","guideItem","hero","heroBuff","main","newExplain","pool","temp","ufo","ufoGroup","battleItem","battleLayer","beginFight","beginFightItem","dailySignIn","dailyTask","dailyTaskItem","followAward","friendHelp","friendHelpItem","guideLayer","loading","login","lotteryDraw","moreGame","newGifts","newGuide","redpacketCrash","redpacketDrop","shareAward","shareAwardItem","shareItemPkg","start","sysMessage","taskUtils","top","topItem","upgrade","upgradeFail","upgradePage"]);